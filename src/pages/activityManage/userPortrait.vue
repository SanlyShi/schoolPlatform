<template>
  <div class="userPortrait_wrap" style="padding-bottom:50px;">
    <div class="big_title box_flex align_center flex_between">
      <div class="box_flex align_center">
        <div style="margin-right:10px;">活动日期范围</div>
        <div class="form-group">
          <v-datepicker
            v-model="startTime"
            class="btn-block time-picker"
            :format="yyyy-MM-dd"
            :placeholder="translate.startTime"
            :clearButton="false"
            :showTime="false"
            @daySelected="timeSelected"
          ></v-datepicker>
        </div>
        <div style="margin:0 10px;">~</div>
        <div class="form-group">
          <v-datepicker
            v-model="endTime"
            class="btn-block time-picker"
            :format="yyyy-MM-dd"
            :placeholder="translate.endTime"
            :clearButton="false"
            :showTime="false"
            @daySelected="timeSelected"
          ></v-datepicker>
        </div>
      </div>
    </div>
    <div class="box_flex">
      <div class="row content">
        <div class="table-item">
          <div v-if="maleToFemaleRatio" style="height:100%;width:49%;display:inline-block">
            <v-SpiritChart :optionData="maleToFemaleRatio"></v-SpiritChart>
          </div>
          <div v-if="gradeRatio" style="height:100%;width:49%;display:inline-block">
            <v-PieChart :optionData="gradeRatio"></v-PieChart>
          </div>
        </div>
        <div class="table-item" >
          <div style="height:100%;width:49%;display:inline-block">
            <v-PieChart :optionData="activityTypeRatio"></v-PieChart>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import Vue from "vue";
import { request, translation } from "../../assets/utils/utils.js";
export default {
  props: {},
  created: function() {
    var la = localStorage.getItem("lang");
    this.getUserPortrait();
  },
  data: function() {
    return {
      startTime: "",
      endTime: "",
      gradeRatio: "",
      maleToFemaleRatio: ""
    };
  },
  computed: {
    translate: function() {
      return translation(this.lang).userPortrait;
    }
  },
  methods: {
    getUserPortrait() {
      let url = `api/count/getAll?startTime=${this.startTime}&endTime=${
        this.endTime
      }`;
      request(url).then(o => {
        console.log("o", o);
        if (o.state) {
          let activityTypeData = []
          let gradeData = [];
          for (let index in o.data.joinGrade) {
            gradeData.push({
              value: index,
              name: o.data.joinGrade[index]
            });
          }
          for (let index in o.data.joinPeople) {
            activityTypeData.push({
              value: index,
              name: o.data.joinPeople[index]
            });
          }
          this.gradeRatio = {
            title: "年级分布",
            legendData: ["position1", "position2"],
            seriesData: [
              {
                name: "年级分布",
                type: "pie",
                radius: "55%",
                center: ["50%", "50%"],
                data: gradeData,
                itemStyle: {
                  emphasis: {
                    shadowBlur: 10,
                    shadowOffsetX: 0,
                    shadowColor: "rgba(0, 0, 0, 0.5)"
                  }
                },
                label: {
                  normal: {
                    position: "inner"
                  },
                  textStyle: {
                    fontSize: 10
                  }
                },
                labelLine: {
                  normal: {
                    show: false
                  }
                }
              }
            ],
            color: ["#4091ff","#64c23a", "#e6a23c","f56c6c"]
          };
          this.activityTypeRatio = {
            title: "活动类型参与人数",
            legendData: ["position1", "position2"],
            seriesData: [
              {
                name: "年级分布",
                type: "pie",
                radius: "55%",
                center: ["50%", "50%"],
                data: activityTypeData,
                itemStyle: {
                  emphasis: {
                    shadowBlur: 10,
                    shadowOffsetX: 0,
                    shadowColor: "rgba(0, 0, 0, 0.5)"
                  }
                },
                label: {
                  normal: {
                    position: "inner"
                  },
                  textStyle: {
                    fontSize: 10
                  }
                },
                labelLine: {
                  normal: {
                    show: false
                  }
                }
              }
            ],
            color: ["#64c23a", "#e6a23c","f56c6c","#4091ff"]
          };
          this.maleToFemaleRatio = {
            title: "性别分布",
            yAxisData: ["男", "女"],
            symbol:
              "image://data:image/png;base64,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",
            maxData: 1,
            seriesData: [
              {
                name: "男",
                value: o.data.joinMan / (o.data.joinMan + o.data.joinWomen)
              },
              {
                name: "女",
                value: o.data.joinWomen / (o.data.joinMan + o.data.joinWomen)
              }
            ]
          };
        }
      });
    },
    timeSelected() {
      this.getUserPortrait();
    },
  }
};
</script>
<style lang="less" scoped >
.userPortrait_wrap {
  background: #ffffff;
  padding: 20px;
  .content {
    width: 100%;
  }
  .align_center {
    .form-group {
      margin-bottom: 0;
    }
  }
  .table-item {
    height: 400px;
    // margin-bottom: 8px;
    width: 100%;
    padding: 20px;
    // background-color: rgb(240,240,240)
  }
}
</style>
