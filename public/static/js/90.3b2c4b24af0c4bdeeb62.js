webpackJsonp([90],{"+Jp4":function(e,t,a){"use strict";var i=a("IHPB"),s=a.n(i),l=a("3cXf"),n=a.n(l),d=a("5rGT"),o=a("C331"),r=(d.a,{data:function(){return{address:{province:"",city:"",area:""},showReasonModal:!1,reason:"",middleSchool:"",addOptions:[{name:"年份",type:"select",value:"year",require:!1,noEdit:!1},{name:"学年",type:"input",value:"studyYear",require:!1,noEdit:!0},{name:"省份",type:"address",value:"addressCode",require:!1,noEdit:!1},{name:"时间",type:"date",value:"submitTime",require:!1,noEdit:!1},{name:"活动类别",type:"select",value:"activityType",require:!1,noEdit:!1},{name:"活动性质",type:"select",value:"activityNature",require:!1,noEdit:!1},{name:"中学/咨询会",type:"select",value:"middleConsult",require:!1,noEdit:!1},{name:"中学性质",type:"input",value:"middleNature",placeholder:"仅中学填写",require:!1,noEdit:!1},{name:"中学/咨询会联系人",type:"input",value:"middleConsultPeople",require:!1,noEdit:!1},{name:"中学/咨询会地址  ",type:"select_input",value:"middleConsultPlace",value2:"middleConsultPlace",require:!1,noEdit:!1},{name:"有无讲座",type:"select",value:"theLecture",require:!1,noEdit:!1},{name:"讲座题目",type:"input",value:"lectureName",require:!1,noEdit:!1},{name:"专家名字",type:"input",value:"expertsName",require:!1,noEdit:!1},{name:"其他人员",type:"input",value:"otherJoinPeople",require:!1,noEdit:!1},{name:"工作内容说明",type:"textarea",placeholder:"请输入工作内容说明",value:"workDescribe",require:!1,noEdit:!1}],addParams:{id:"",userId:"",userName:"",year:"",studyYear:"",addressCode:"",provinceSecond:"",submitTime:null,activityType:"",activityNature:"",middleConsult:"",middleNature:"",middleConsultPeople:"",middleConsultPlace:"",theLecture:"",lectureName:"",expertsName:"",schoolJoinPeopleSurnames:"",schoolJoinPeopleName:"",schoolJoinPeoplePhone:"",schoolJoinPeopleVO:[],otherJoinPeople:"",workDescribe:"",note:"",status:"",reason:"",createTime:"",updateTime:""},yearList:[],middleList:[],selectOptions:{activityType:[],activityNature:[],middleConsult:[],middleConsultPlace:[],theLecture:[]},dialogList:[],hasEdit:0,myAddress:"",schedulingType:"edit",showDialogStatus:!1}},components:{newAddress:d.a},created:function(){var e=this;if(this.addParams=this.value,this.myAddress=this.addParams.province,this.addParams.provinceSecond&&(this.myAddress+=","+this.addParams.provinceSecond),this.addParams.provinceCode){var t=this.addParams.provinceCode;this.addParams.provinceSecondCode&&(t+=","+this.addParams.provinceSecondCode),this.getMiddleList(t)}this.getYearList();[{name:"活动类别",value:"activityType"},{name:"活动性质",value:"activityNature"},{name:"中学/咨询会",value:"middleConsult"},{name:"中学/咨询会地址",value:"middleConsultPlace"},{name:"有无讲座",value:"theLecture"}].forEach(function(t){e.getDirectoryList(t)}),this.schedulingType=this.type},props:{value:{default:{}},width:{default:220},noArea:{default:!1},type:{default:"edit"},index:{default:""}},watch:{value:function(e){this.addParams=JSON.parse(n()(e)),this.myAddress=this.addParams.province,this.addParams.provinceSecond&&(this.myAddress+=","+this.addParams.provinceSecond)},type:function(e){this.schedulingType=e},addParams:{handler:function(e,t){this.hasEdit++},deep:!0}},methods:{changeStatus:function(e){var t=this,a="?id="+this.addParams.id;if("1"===e)this.$parent.submitAction(a,e),this.schedulingType="ok",this.addParams.status="OK";else if("2"===e){if(!this.showReasonModal)return void(this.showReasonModal=!0);if(!this.reason)return void this.$toast("驳回理由不能为空!");this.showReasonModal=!1;var i="api/archives/trip/updateArrangeStatus"+a+"&status=NO&reason="+this.reason;Object(o.d)(i,{},"post").then(function(e){e.state&&(t.$toast("操作成功!"),t.schedulingType="read",t.addParams.status="NO",t.$parent.curTab="NO",t.addParams.reason=t.reason)})}},_showDialog:function(){var e=this;if(this.showDialogStatus)this.showDialogStatus=!1;else{var t="api/archives/trip/"+this.addParams.id+"/getOneArrangeRecord";Object(o.d)(t).then(function(t){if(t.state){e.showDialogStatus=!0;[].concat([{name:"档案接收人",value:"archivesReceiveMemberName"},{name:"辅导员",value:"instructorName"}],s()(e.addOptions));e.dialogList=t.data.content.map(function(e){return e})}})}},back:function(){this.hasEdit>1?confirm("行程未保存,是否继续返回?")&&(this.hasEdit=0,this.$emit("back")):(this.hasEdit=0,this.$emit("back"))},addJoinPeople:function(){this.addParams.schoolJoinPeopleVO||(this.addParams.schoolJoinPeopleVO=[]),this.addParams.schoolJoinPeopleVO.push({surnames:"",name:"",phone:""})},getYearList:function(){for(var e=[],t=(new Date).getFullYear(),a=0;a<5;a++)e.push({id:t-a,text:""+(t-a)});this.yearList=e},save:function(e){this.hasEdit=0,"SAVE"===e&&this.addParams.status||(this.addParams.status=e),this.middleSchool&&"其他"!=this.middleSchool&&(this.addParams.middleConsultPlace=this.middleSchool),this.addParams.submitTime=this.addParams.submitTime?this.addParams.submitTime.split(" ")[0]:"",this.$emit("input",this.addParams),this.$emit("onchange")},getDirectoryList:function(e){var t=this,a="api/archives/demo/getSysDict?name="+e.name;Object(o.d)(a).then(function(a){a.state&&(t.selectOptions[e.value]=a.data.map(function(a){return t.addParams[e.value]===a.name&&(t.addParams[e.value]=a.value),a.text=a.name,a.id=a.value,a}),t.hasEdit=0)})},getSelectOptions:function(e){switch(e){case"year":return this.yearList;case"middleConsultPlace":return this.middleList;default:return this.selectOptions[e]}},getMiddleList:function(e){var t=this,a="api/archives/trip/getMiddleData?province="+e.split(",")[0]+"&provinceSecond="+(e.split(",")[1]?e.split(",")[1]:"");this.middleSchool="",Object(o.d)(a).then(function(e){e.state&&(t.middleList=e.data.map(function(e){return e.name===t.addParams.middleConsultPlace&&(t.middleSchool=e.name),{id:e.name,text:e.name}}),t.middleList.push({id:"其他",text:"其他"}))})},changeAddress:function(e,t){this.addParams[t.value]=e,this.getMiddleList(e)}}}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"editScheduling"},[a("label",{staticClass:"back pull-left box_flex flex_between",staticStyle:{padding:"0",width:"100%","padding-right":"200px"}},[a("span",[a("i",{staticClass:"maticon pull-left",domProps:{innerHTML:e._s(e.icons("arrow_back"))},on:{click:function(t){return e.back()}}},[e._v("arrow_back")]),e._v(" "),a("span",{on:{click:function(t){return e.back()}}},[e._v("返回")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"add"!==e.schedulingType,expression:"schedulingType!=='add'"}],staticClass:"opt-btn btn",staticStyle:{color:"#298df7"},on:{click:e._showDialog}},[e._v("日志")])]),e._v(" "),a("div",{staticClass:"form-wrap box_flex align_center"},[e._l(e.addOptions.filter(function(e,t){return t<=13}),function(t,i){return a("div",{key:i,staticClass:"form-group align_center"},[a("div",{staticClass:"label",class:{require:t.require}},[a("span",[e._v(e._s(t.name)+":")])]),e._v(" "),"input"==t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.addParams[t.value],expression:"addParams[item.value]"}],staticClass:"form-control search-input organization-input",attrs:{type:"text",placeholder:t.placeholder,disabled:"read"==e.schedulingType||t.noEdit},domProps:{value:e.addParams[t.value]},on:{input:function(a){a.target.composing||e.$set(e.addParams,t.value,a.target.value)}}}):e._e(),e._v(" "),"select_input"==t.type?a("div",{staticClass:"select_input_wrap box_flex flex_between",staticStyle:{width:"450px"}},[e.getSelectOptions(t.value).length&&"13001"===e.addParams.middleConsult?a("v-select",{attrs:{disabled:"read"==e.schedulingType,options:e.getSelectOptions(t.value),"options-value":"id","options-label":"text","close-on-select":"",justify:""},model:{value:e.middleSchool,callback:function(t){e.middleSchool=t},expression:"middleSchool"}}):e._e(),e._v(" "),"其他"!=e.middleSchool&&"13001"===e.addParams.middleConsult&&e.getSelectOptions(t.value).length?e._e():a("input",{directives:[{name:"model",rawName:"v-model",value:e.addParams[t.value2],expression:"addParams[item.value2]"}],staticClass:"form-control search-input organization-input",attrs:{type:"text",disabled:"read"==e.schedulingType||t.noEdit},domProps:{value:e.addParams[t.value2]},on:{input:function(a){a.target.composing||e.$set(e.addParams,t.value2,a.target.value)}}})],1):e._e(),e._v(" "),"address"==t.type?a("newAddress",{ref:"address",refInFor:!0,attrs:{disabled:"read"==e.schedulingType||t.noEdit,value:e.myAddress,width:200,noArea:"true"},on:{onChange:function(a){e.changeAddress(a,t)}}}):e._e(),e._v(" "),"detect"==t.type?a("detect",{attrs:{url:t.url,searchVal:e.addParams[t.label],placeholder:t.placeholder},on:{afterSelected:function(a){e.afterDetect(a,t)}}}):e._e(),e._v(" "),"select"==t.type?a("v-select",{attrs:{disabled:"read"==e.schedulingType||t.noEdit,options:e.getSelectOptions(t.value),"options-value":"id","options-label":"text","close-on-select":"",justify:""},model:{value:e.addParams[t.value],callback:function(a){e.$set(e.addParams,t.value,a)},expression:"addParams[item.value]"}}):e._e(),e._v(" "),"date"==t.type?a("v-datepicker",{ref:"datepicker",refInFor:!0,attrs:{disabled:"read"==e.schedulingType||t.noEdit,format:"yyyy-MM-dd",clearButton:!1,showTime:!1},model:{value:e.addParams[t.value],callback:function(a){e.$set(e.addParams,t.value,a)},expression:"addParams[item.value]"}}):e._e()],1)}),e._v(" "),e._l(e.addParams.schoolJoinPeopleVO,function(t,i){return a("div",{key:"input"+i,staticClass:"box_flex"},[a("div",{staticClass:"form-group align_center"},[a("div",{staticClass:"label"},[a("span",[e._v("我校主要参加人"+e._s(i+1)+":")])]),e._v(" "),a("div",{staticClass:"tow_input_wrap box_flex flex_between"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.surnames,expression:"inputItem['surnames']"}],staticClass:"form-control search-input organization-input",staticStyle:{width:"40px","padding-right":"0"},attrs:{type:"text",placeholder:"姓氏",disabled:"read"==e.schedulingType},domProps:{value:t.surnames},on:{input:function(a){a.target.composing||e.$set(t,"surnames",a.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"inputItem['name']"}],staticClass:"form-control search-input organization-input",staticStyle:{width:"140px"},attrs:{type:"text",placeholder:"名字",disabled:"read"==e.schedulingType},domProps:{value:t.name},on:{input:function(a){a.target.composing||e.$set(t,"name",a.target.value)}}})])]),e._v(" "),a("div",{staticClass:"form-group align_center"},[a("div",{staticClass:"label"},[a("span",[e._v("我校主要参加人联系方式"+e._s(i+1)+":")])]),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.phone,expression:"inputItem['phone']"}],staticClass:"form-control search-input organization-input",attrs:{type:"text",disabled:"read"==e.schedulingType},domProps:{value:t.phone},on:{input:function(a){a.target.composing||e.$set(t,"phone",a.target.value)}}})])])}),e._v(" "),"add"==e.schedulingType?a("div",{staticStyle:{width:"100%"}},[a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.addJoinPeople()}}},[e._v("新增")])]):e._e(),e._v(" "),e._l(e.addOptions.filter(function(e,t){return t>13}),function(t,i){return a("div",{key:"add"+i,staticClass:"textarea_wrap form-group align_center"},[a("div",{staticClass:"label",class:{require:t.require}},[a("span",[e._v(e._s(t.name)+":")])]),e._v(" "),"input"==t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:e.addParams[t.value],expression:"addParams[item.value]"}],staticClass:"form-control search-input organization-input",attrs:{type:"text",disabled:"read"==e.schedulingType||t.noEdit},domProps:{value:e.addParams[t.value]},on:{input:function(a){a.target.composing||e.$set(e.addParams,t.value,a.target.value)}}}):e._e(),e._v(" "),"textarea"==t.type?a("v-textarea",{attrs:{readonly:"read"==e.schedulingType||t.noEdit,lineHeight:22,placeholder:t.placeholder,rows:6,maxLength:255},model:{value:e.addParams[t.value],callback:function(a){e.$set(e.addParams,t.value,a)},expression:"addParams[item.value]"}}):e._e()],1)}),e._v(" "),"edit"==e.schedulingType||e.$parent.curTab&&"NO"===e.$parent.curTab?a("div",{staticClass:"textarea_wrap form-group align_center"},[e._m(0),e._v(" "),a("v-textarea",{attrs:{readonly:"true",lineHeight:22,placeholder:"请输入驳回理由",rows:6,maxLength:255},model:{value:e.addParams.reason,callback:function(t){e.$set(e.addParams,"reason",t)},expression:"addParams['reason']"}})],1):e._e(),e._v(" "),e.$parent.curTab?a("div",{staticClass:"textarea_wrap form-group align_center"},[e._m(1),e._v(" "),a("v-textarea",{attrs:{readonly:"read"==e.schedulingType,placeholder:"请输入备注",lineHeight:22,rows:6,maxLength:255},model:{value:e.addParams.note,callback:function(t){e.$set(e.addParams,"note",t)},expression:"addParams['note']"}})],1):e._e()],2),e._v(" "),"check"===e.schedulingType?a("div",{staticClass:"box_flex flex_center"},[a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.changeStatus("1")}}},[e._v("通过")]),e._v(" "),a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.changeStatus("2")}}},[e._v("驳回")]),e._v(" "),a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.save("SAVE")}}},[e._v("保存")])]):"recall"===e.schedulingType?a("div",{staticClass:"box_flex flex_center"},[a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.save("RECALL")}}},[e._v("保存")])]):"ok"===e.schedulingType?a("div",{staticClass:"box_flex flex_center"},["1"==e.index?a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.save("RECALL")}}},[e._v("保存")]):e._e(),e._v(" "),"2"==e.index?a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.save("OK")}}},[e._v("保存")]):e._e()]):"read"!==e.schedulingType?a("div",{staticClass:"box_flex flex_center"},[a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.save("SAVE")}}},[e._v("保存")]),e._v(" "),a("button",{staticClass:"btn submit-btn",on:{click:function(t){return e.save("WAIT")}}},[e._v("提交")])]):e._e(),e._v(" "),e.showDialogStatus?a("div",{staticClass:"dialog_wrap"},[e._l(e.dialogList,function(t,i){return a("div",{key:i,staticClass:"dialog"},[a("p",{staticClass:"gray"},[e._v(e._s(new Date(t.updateTime).format("yyyy-MM-dd HH:mm")))]),e._v(" "),a("p",[a("b",[e._v(e._s(t.name))]),e._v("修改了内容:")]),e._v(" "),a("p",[e._v("修改了"+e._s(t.field)+"为")]),e._v(" "),a("b",[e._v(e._s(t.value))])])}),e._v(" "),0===e.dialogList.length?a("div",[e._v("\n      暂无数据哟~\n    ")]):e._e()],2):e._e(),e._v(" "),a("v-modal",{attrs:{show:e.showReasonModal,width:"374"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v("驳回理由")])]),e._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-wrap box_flex align_center"},[a("div",{staticClass:"form-group box_flex column",staticStyle:{width:"100%","margin-right":"0","margin-bottom":"0"}},[a("div",{staticClass:"label require",staticStyle:{"text-align":"left","padding-left":"0"}},[a("span",[e._v("驳回理由:")])]),e._v(" "),a("v-textarea",{attrs:{lineHeight:22,placeholder:"请输入驳回理由",rows:6,maxLength:255},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}})],1)])]),e._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){e.showReasonModal=!1}}},[e._v("取消")]),e._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.changeStatus("2")}}},[e._v("确定")])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"label"},[t("span",[this._v("驳回理由:")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"label"},[t("span",[this._v("备注:")])])}]};var u=a("C7Lr")(r,c,!1,function(e){a("e3oV")},"data-v-0ac087bc",null);t.a=u.exports},W8wR:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),s=a.n(i),l=a("C331"),n=a("y0ro"),d=a("JUJb"),o=a("+Jp4"),r=(n.a,d.a,o.a,{mixins:[n.a,d.a],components:{editScheduling:o.a},data:function(){return{schedulingUrl:"/table-data/archives/trip/getAllArrange",schedulingColumns:[],imgList:[],timestamp:"?timestamp=",lang:"zh-cn",showReasonModal:!1,showPublishModal:!1,examineStatus:!1,checkRows:[],selectTabEnd:!1,schedulingType:"edit",index:0,tabs:[{id:"WAIT",name:"未审核"},{id:"NO",name:"审核未通过"},{id:"OK",name:"审核通过"},{id:"PUBLISH",name:"已发布"},{id:"RECALL",name:"已撤回"}],curTab:"WAIT",isEdit:!0,reason:"",publishList:[{value:"year",checked:!1,name:"年份"},{value:"studyYear",checked:!1,name:"学年"},{value:"province",checked:!1,name:"省份"},{value:"provinceSecond",checked:!1,name:"地区"},{value:"submitTime",checked:!1,name:"时间"},{value:"activityType",checked:!1,name:"活动类别"},{value:"activityNature",checked:!1,name:"活动性质"},{value:"middleConsult",checked:!1,name:"中学/咨询会"},{value:"middleConsultPlace",checked:!1,name:"中学/咨询会地址"},{value:"middleNature",checked:!1,name:"中学性质"},{value:"middleConsultPeople",checked:!1,name:"中学/咨询会联系人"},{value:"theLecture",checked:!1,name:"有无讲座"},{value:"expertsName",checked:!1,name:"专家名字"},{value:"lectureName",checked:!1,name:"讲座题目"},{value:"schoolJoinPeopleOne",checked:!1,name:"我校主要参加人1"},{value:"schoolJoinPeopleOnePhone",checked:!1,name:"我校主要参加人1联系方式"},{value:"schoolJoinPeopleTwo",checked:!1,name:"我校参加人2"},{value:"schoolJoinPeopleTwoPhone",checked:!1,name:"我校参加人2联系方式"}],addParams:{id:37,userId:0x3f332dcec800000,userName:"",year:"",studyYear:"",province:"",provinceSecond:"",submitTime:"",activityType:"",activityNature:"",middleConsult:"",middleNature:"",middleConsultPeople:"",middleConsultPlace:"",theLecture:"",lectureName:"",expertsName:"",schoolJoinPeopleSurnames:"",schoolJoinPeopleName:"",schoolJoinPeoplePhone:"",schoolJoinPeopleVO:"",otherJoinPeople:"",workDescribe:"",note:"",status:"",reason:"",createTime:"",updateTime:""}}},created:function(){var e=localStorage.getItem("lang");Object(l.g)(e)&&(this.lang=e),this.initTable()},methods:{getPublishHistory:function(){var e=this;Object(l.d)("api/archives/trip/getPublishField").then(function(t){if(t.state)for(var a in t.data)t.data[a]&&e.publishList.forEach(function(e){e.value===a&&(e.check=!0)})})},getYearList:function(){for(var e=(new Date).getFullYear(),t=[],a=0;a<5;a++)t.push({label:e-a+"",value:e-a+""});return t},initTable:function(){var e=this,t=this;"NO"===this.curTab?this.schedulingColumns=[{title:"年份",id:"year",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"label",optionsValue:"value",options:t.getYearList()}}},{title:"活动类别",id:"activityType",className:"text-left",width:140,hidden:!0,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=活动类别"}}},{title:"活动性质",id:"activityNature",className:"text-left",width:140,hidden:!0,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=活动性质"}}},{title:"时间",id:"submitTime",className:"text-left",width:140,hidden:!1},{title:"省份",id:"province",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"label",optionsValue:"value",url:"/api/archives/permissions/getProvinceList"}}},{title:"中学/咨询会",id:"middleConsult",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=中学/咨询会"}}},{title:"中学名称/咨询会地址",id:"middleConsultPlace",className:"text-left",width:140,hidden:!1,search:{type:"input",data:{placeholder:""}}},{title:"审核人",id:"checkName",className:"text-left",width:140,hidden:!1},{title:"审核时间",id:"checkTime",className:"text-left",width:140,hidden:!1},{title:"提交人",id:"userName",className:"text-left",width:140,hidden:!1},{title:"提交时间",id:"updateTime",className:"text-left",width:140,hidden:!1},{title:"驳回理由",id:"reason",className:"text-left",width:140,hidden:!1},{id:"opt",title:"操作",className:"text-center",width:"230px",formatter:function(e){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.schedulingType="read",t.examine(e)}}]}}]:"PUBLISH"===this.curTab||"RECALL"===this.curTab?this.schedulingColumns=[{title:"年份",id:"year",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"label",optionsValue:"value",options:t.getYearList()}}},{title:"活动类别",id:"activityType",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=活动类别"}}},{title:"活动性质",id:"activityNature",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=活动性质"}}},{title:"时间",id:"submitTime",className:"text-left",width:140,hidden:!1},{title:"省份",id:"province",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"label",optionsValue:"value",url:"/api/archives/permissions/getProvinceList"}}},{title:"中学/咨询会",id:"middleConsult",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=中学/咨询会"}}},{title:"中学名称/咨询会地址",id:"middleConsultPlace",className:"text-left",width:140,hidden:!1,search:{type:"input",data:{placeholder:""}}},{title:"审核人",id:"checkName",className:"text-left",width:140,hidden:!1},{title:"审核时间",id:"checkTime",className:"text-left",width:140,hidden:!1},{title:"发布人",id:"publishName",className:"text-left",width:140,hidden:!1},{title:"发布时间",id:"publishTime",className:"text-left",width:140,hidden:!1},{title:"提交人",id:"userName",className:"text-left",width:140,hidden:!1},{title:"提交时间",id:"updateTime",className:"text-left",width:140,hidden:!1},{id:"opt",title:"操作",className:"text-center",formatter:function(e){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.schedulingType="ok",t.index=1,t.examine(e)}}]}}]:"OK"===this.curTab?this.schedulingColumns=[{title:"年份",id:"year",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"label",optionsValue:"value",options:t.getYearList()}}},{title:"活动类别",id:"activityType",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=活动类别"}}},{title:"活动性质",id:"activityNature",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=活动性质"}}},{title:"时间",id:"submitTime",className:"text-left",width:140,hidden:!1},{title:"省份",id:"province",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"label",optionsValue:"value",url:"/api/archives/permissions/getProvinceList"}}},{title:"中学/咨询会",id:"middleConsult",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=中学/咨询会"}}},{title:"中学名称/咨询会地址",id:"middleConsultPlace",className:"text-left",width:140,hidden:!1,search:{type:"input",data:{placeholder:""}}},{title:"审核人",id:"checkName",className:"text-left",width:140,hidden:!1},{title:"审核时间",id:"checkTime",className:"text-left",width:140,hidden:!1},{title:"提交人",id:"userName",className:"text-left",width:140,hidden:!1},{title:"提交时间",id:"updateTime",className:"text-left",width:140,hidden:!1},{id:"opt",title:"操作",className:"text-center",formatter:function(e){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.schedulingType="ok",t.index=2,t.examine(e)}}]}}]:this.schedulingColumns=[{title:"年份",id:"year",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"label",optionsValue:"value",options:t.getYearList()}}},{title:"活动类别",id:"activityType",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=活动类别"}}},{title:"活动性质",id:"activityNature",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=活动性质"}}},{title:"时间",id:"submitTime",className:"text-left",width:140,hidden:!1},{title:"省份",id:"province",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"label",optionsValue:"value",url:"/api/archives/permissions/getProvinceList"}}},{title:"中学/咨询会",id:"middleConsult",className:"text-left",width:140,hidden:!1,search:{type:"select",data:{optionsLabel:"name",optionsValue:"value",url:"/api/archives/demo/getSysDict?name=中学/咨询会"}}},{title:"中学名称/咨询会地址",id:"middleConsultPlace",className:"text-left",width:140,hidden:!1,search:{type:"input",data:{placeholder:""}}},{title:"提交人",id:"userName",className:"text-left",width:140,hidden:!1},{title:"提交时间",id:"updateTime",className:"text-left",width:140,hidden:!1},{id:"opt",title:"操作",className:"text-center",formatter:function(e){return"WAIT"===t.curTab?[{tag:"a",text:"审核",className:"opt-btn",callback:function(e,a){t.schedulingType="check",t.examine(e)}}]:"RECALL"===t.curTab?[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.schedulingType="recall",t.examine(e)}}]:[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.schedulingType="read",t.examine(e)}}]}}],this.$nextTick(function(t){e.selectTabEnd=!0})},selectTab:function(e){this.selectTabEnd=!1,this.curTab=this.tabs[e].id,this.initTable()},batchAction:function(e){if(this.checkRows.length){var t="?id=";this.checkRows.map(function(e){t+=e.id+","}),t=t.substring(0,t.length-1),this.submitAction(t,e)}else this.$toast("请选择行程!")},submitAction:function(e,t){var a=this,i="";if("1"===t)i="api/archives/trip/updateArrangeStatus"+e+"&status=OK";else if("2"===t){if(!this.showReasonModal)return void(this.showReasonModal=!0);if(!this.reason)return void this.$toast("驳回理由不能为空!");this.showReasonModal=!1,i="api/archives/trip/updateArrangeStatus"+e+"&status=NO&reason="+this.reason}else{if("3"===t)return i="/downloads/archives/trip/getArrangeExcel"+e+"&status="+this.curTab,void(window.location.href=i);if("4"===t){if(!confirm("是否确定撤回?"))return;i="api/archives/trip/updateArrangeStatus"+e+"&status=RECALL"}else if("5"===t){if(i="api/archives/trip/updateArrangeStatus"+e+"&status=PUBLISH",!this.showPublishModal)return this.getPublishHistory(),void(this.showPublishModal=!0);var s={year:null,studyYear:null,province:null,provinceSecond:null,submitTime:null,activityType:null,activityNature:null,middleConsult:null,middleConsultPlace:null,middleNature:null,middleConsultPeople:null,theLecture:null,expertsName:null,lectureName:null,schoolJoinPeopleOne:null,schoolJoinPeopleOnePhone:null,schoolJoinPeopleTwo:null,schoolJoinPeopleTwoPhone:null};this.publishList.forEach(function(e){e.checked&&(s[e.value]="OK")}),Object(l.d)("api/archives/trip/savePublishField",s).then(function(e){e.state&&(a.$toast("操作成功!"),a.timestamp="?timestamp="+(new Date).getTime())}),this.showPublishModal=!1}}Object(l.d)(i,null,"post").then(function(e){e.state&&(a.$toast("操作成功!"),a.timestamp="?timestamp="+(new Date).getTime())})},afterChecked:function(e){this.checkRows=e},examine:function(e){var t=this;if(this.examineStatus){var a=JSON.parse(s()(this.addParams));this.addParams.addressCode?(a.province=this.addParams.addressCode.split(",")[0],a.provinceSecond=this.addParams.addressCode.split(",")[1]?this.addParams.addressCode.split(",")[1]:""):(a.province=this.addParams.provinceCode,a.provinceSecond=this.addParams.provinceSecondCode);var i="api/archives/trip/"+a.id+"/updateArrangeContent";"edit"===this.schedulingType&&(i="api/archives/trip/"+a.id+"/updateOneArrange"),Object(l.d)(i,a,"post").then(function(e){e.state?(t.$toast("操作成功!"),t.examineStatus=!1,t.timestamp="?timestamp="+(new Date).getTime()):t.$toast(e.message)})}else this.examineStatus=!0,e.submitTime=new Date(e.submitTime).format("yyyy-MM-dd HH:mm"),this.addParams=e}},computed:{translate:function(){return Object(l.g)(this.lang).enrollManage}}}),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.examineStatus?a("div",[a("editScheduling",{attrs:{index:e.index,type:e.schedulingType},on:{back:function(t){e.examineStatus=!1},onchange:e.examine},model:{value:e.addParams,callback:function(t){e.addParams=t},expression:"addParams"}})],1):a("div",{staticClass:"scheduling"},[a("div",{staticClass:"tab-div"},e._l(e.tabs,function(t,i){return a("div",{key:i,staticClass:"tab",class:t.id===e.curTab?"active":"",on:{click:function(t){return e.selectTab(i)}}},[e._v(e._s(t.name))])}),0),e._v(" "),a("div",{staticClass:"content text-center"},[e.selectTabEnd?a("v-table",{ref:"schedulingTable",attrs:{title:"行程列表",url:e.schedulingUrl+e.timestamp+"&status="+e.curTab,pagesize:"10",idField:"id",columns:e.schedulingColumns,multiple:"true",columnsControl:!0,order:!0,search:!1},on:{afterChecked:e.afterChecked}},[a("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},["WAIT"===e.curTab?a("button",{staticClass:"btn batch-add-btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.batchAction("1")}}},[e._v("通过")]):e._e(),e._v(" "),"WAIT"===e.curTab?a("button",{staticClass:"btn batch-add-btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.batchAction("2")}}},[e._v("驳回")]):e._e(),e._v(" "),"WAIT"===e.curTab||"PUBLISH"===e.curTab?a("button",{staticClass:"btn batch-add-btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.batchAction("3")}}},[e._v("导出")]):e._e(),e._v(" "),"PUBLISH"===e.curTab?a("button",{staticClass:"btn batch-add-btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.batchAction("4")}}},[e._v("撤回")]):e._e(),e._v(" "),"OK"===e.curTab||"RECALL"===e.curTab?a("button",{staticClass:"btn batch-add-btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.batchAction("5")}}},[e._v("发布")]):e._e()])]):e._e()],1),e._v(" "),a("v-modal",{attrs:{show:e.showReasonModal,width:"374"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v("驳回理由")])]),e._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-wrap box_flex align_center"},[a("div",{staticClass:"form-group box_flex column",staticStyle:{width:"100%","margin-right":"0","margin-bottom":"0"}},[a("div",{staticClass:"label require",staticStyle:{"text-align":"left","padding-left":"0"}},[a("span",[e._v("驳回理由:")])]),e._v(" "),a("v-textarea",{attrs:{lineHeight:22,placeholder:"请输入驳回理由",rows:6,maxLength:255},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}})],1)])]),e._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){e.showReasonModal=!1}}},[e._v("取消")]),e._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.batchAction("2")}}},[e._v("确定")])])]),e._v(" "),a("v-modal",{attrs:{show:e.showPublishModal,width:"374"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[e._v("请选择发布字段")])]),e._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-wrap box_flex align_center"},e._l(e.publishList,function(t,i){return a("v-checkbox",{key:i,staticStyle:{"margin-right":"10px"},attrs:{name:t.name},model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item.checked"}})}),1)]),e._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){e.showPublishModal=!1}}},[e._v("取消")]),e._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.batchAction("5")}}},[e._v("确定")])])])],1)},staticRenderFns:[]};var u=a("C7Lr")(r,c,!1,function(e){a("xiN2")},"data-v-b17a9d20",null);t.default=u.exports},e3oV:function(e,t){},xiN2:function(e,t){}});