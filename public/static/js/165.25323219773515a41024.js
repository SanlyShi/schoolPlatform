webpackJsonp([165],{"3vi8":function(t,e){},k6Yl:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("kV13");var n=a("C331"),s={created:function(){var t=this,e=localStorage.getItem("lang");Object(n.g)(e)&&(this.lang=e),Object(n.e)({url:"/api/apartment/inandout/getSelectOption",dataType:"json",type:"get",success:function(e){if(e.state){var a=e.data.option;t.options.college=a.college||[],t.options.grade=a.grade||[],t.options.educationLevel=a.educationLevel||[],t.options.checkInStatus=a.checkInStatus||[],t.options.paymentStatus=a.paymentStatus||[],t._initColumns()}else t.toast(e.message)}})},data:function(){return{tableCheckedList:[],activeName:"IN_CHECK_IN",columns:[],url:"/table-data/apartment/inandout/allManageRecord?status=IN_CHECK_IN",importPage:!1,importParams:{parentPageTitle:"",downloadTemplateUrl:"",downloadErrorTemplateUrl:"",checkTemplateUrl:"",templateName:"",importBtnType:null},options:{college:[],grade:[],educationLevel:[],checkInStatus:[],paymentStatus:[]},timeStamp:null,lang:"zh-cn"}},computed:{translate:function(){return Object(n.g)(this.lang).entryAndEexit}},methods:{submit:function(){for(var t=this,e=void 0,a=[],s=0;s<this.tableCheckedList.length;s++)a.push(this.tableCheckedList[s].studentId);e="IN_CHECK_IN"==this.activeName?"/api/apartment/inandout/manageSingleIn":"/api/apartment/inandout/manageSingleOut",Object(n.e)({url:e,type:"post",data:{studentIds:a},success:function(e){e.state&&(t.$toast("操作成功"),t.tableCheckedList=[],t.url="/table-data/apartment/inandout/allManageRecord?status="+t.activeName+"&ts="+(new Date).getTime())}})},afterChecked:function(t){this.tableCheckedList=t},handleClick:function(){this.tableCheckedList=[],this.url="/table-data/apartment/inandout/allManageRecord?status="+this.activeName},_initColumns:function(){var t=this;this.columns=[{id:"name",title:this.translate.name,className:"text-left",width:70,hidden:!1,search:{type:"input",data:{autoFocus:!0,placeholder:this.translate.namePlaceholder}}},{id:"studentId",title:this.translate.studentId,className:"text-left",width:120,hidden:!1,search:{type:"input",data:{autoFocus:!0,placeholder:this.translate.studentIdPlaceholder}}},{id:"account",title:this.translate.account,className:"text-left",width:120,hidden:!1,search:{type:"input",data:{autoFocus:!0,placeholder:this.translate.accountIdPlaceholder}}},{id:"college",title:this.translate.college,className:"text-left",width:100,hidden:!1,search:{type:"multiSelect",data:{options:this.options.college,optionsLabel:"name",optionsValue:"code"}}},{id:"educationLevel",title:this.translate.educationLevel,className:"text-left",width:80,hidden:!1,search:{type:"multiSelect",data:{options:this.options.educationLevel,optionsLabel:"name",optionsValue:"code"}}},{id:"grade",title:this.translate.grade,className:"text-left",width:60,hidden:!1,search:{type:"multiSelect",data:{options:this.options.grade,optionsLabel:"name",optionsValue:"code"}}},{id:"dormitory",title:this.translate.dormitory,className:"text-left",width:300,hidden:!1,formatter:function(t){return(t.dormitory.campus?t.dormitory.campus:"")+t.dormitory.zone+(t.dormitory.buildName?t.dormitory.buildName:"")+" "+t.dormitory.room+"室"+t.dormitory.bed+"号床"}},{id:"checkInStatus",title:this.translate.checkInStatus,className:"text-left",width:80,hidden:!1,search:{type:"select",data:{options:[{checkInStatus:"IN_CHECK_IN",name:"入住确认中"},{checkInStatus:"IN_RETIREMENT",name:"退宿确认中"}],optionsLabel:"name",optionsValue:"checkInStatus"}}},{id:"opt",title:this.translate.opt,className:"text-left",width:60,hidden:!1,formatter:function(e){return"入住确认中"!=e.checkInStatus?[{tag:"a",text:"确认退宿",className:"opt-btn",callback:function(e,a){confirm(t.translate.leaveDormitoryConfirmTip)&&Object(n.e)({url:"/api/apartment/inandout/manageSingleOut/"+e.studentId,dataType:"json",type:"post",success:function(e){e.state?(t.checkInStatus="已退宿",t.timeStamp=Object(n.a)(),t.$toast("退宿成功!")):t.$toast(e.message)}})}}]:[{tag:"a",text:"确认入住",className:"opt-btn",callback:function(e,a){confirm(t.translate.entryDormitoryConfirmTip)&&Object(n.e)({url:"/api/apartment/inandout/manageSingleIn/"+e.studentId,dataType:"json",type:"post",success:function(e){e.state?(t.checkInStatus="已入住",t.timeStamp=Object(n.a)(),t.$toast("入住成功!")):t.$toast(e.message)}})}}]}}]},entry:function(){var t=this;this.importPage=!0,this.importParams.parentPageTitle=this.translate.tableName,this.importParams.templateName=this.translate.batchEntry,this.importParams.downloadTemplateUrl="/apartment/inandout/batchIn/template",this.importParams.checkTemplateUrl="/apartment/inandout/manageBatchIn/excel",this.importParams.downloadErrorTemplateUrl="/apartment/inandout/batchIn/error",this.importParams.importBtnType=[{url:"/apartment/inandout/manageBatchIn/excel",method:"post",isShowBtn:!0,name:this.translate.overlayImport,success:function(e){e.state&&t._refreshTable()}}]},exit:function(){var t=this;this.importPage=!0,this.importParams.parentPageTitle=this.translate.tableName,this.importParams.templateName=this.translate.batchExit,this.importParams.downloadTemplateUrl="/apartment/inandout/batchOut/template",this.importParams.checkTemplateUrl="/apartment/inandout/manageBatchOut/excel",this.importParams.downloadErrorTemplateUrl="/apartment/inandout/batchOut/error",this.importParams.importBtnType=[{url:"/apartment/inandout/manageBatchOut",method:"post",isShowBtn:!0,name:this.translate.overlayImport,success:function(e){e.state&&t._refreshTable()}}]},_refreshTable:function(){this.timeStamp=Object(n.a)()}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid",attrs:{id:"entryAndExit-page"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.importPage,expression:"!importPage"}],staticClass:"tab"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"入住管理",name:"IN_CHECK_IN"}}),t._v(" "),a("el-tab-pane",{attrs:{label:"退宿管理",name:"IN_RETIREMENT"}})],1)],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.importPage,expression:"!importPage"}],staticClass:"row text-center"},[a("v-table",{attrs:{url:""+t.url,multiple:"true",pagesize:"10",idField:"id",columns:t.columns,order:!0,search:!0},on:{afterChecked:t.afterChecked}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left"},[t.tableCheckedList.length>0?a("div",{staticClass:"batch-options"},[a("span",{staticClass:"pull-left"},[t._v("已选择"+t._s(t.tableCheckedList.length)+"项，其中可操作的有"+t._s(t.tableCheckedList.length)+"项")]),t._v(" "),a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:t.submit}},[t._v(t._s("IN_CHECK_IN"==t.activeName?"确认入住":"确认退宿"))])]):t._e()]),t._v(" "),a("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"})])])],1),t._v(" "),a("v-import",t._b({directives:[{name:"show",rawName:"v-show",value:t.importPage,expression:"importPage"}],on:{backParentPage:function(e){t.importPage=!1}}},"v-import",t.importParams,!1))],1)},staticRenderFns:[]};var o=a("C7Lr")(s,i,!1,function(t){a("3vi8")},null,null);e.default=o.exports}});