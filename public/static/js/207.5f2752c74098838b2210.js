webpackJsonp([207],{"8K/W":function(n,t){},XC80:function(n,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("kV13");var i=a("C331"),e={props:{data:{default:""}},data:function(){return{mapInfoMark:!1,signInfo:{},signInRange:[],curSignInRange:{},isSignIn:!1}},created:function(){var n=this;this.signInfo=this.data.data.signInfo,this.signInfo.signInRange.forEach(function(t){n.$set(n.signInRange,"center",{});var a={center:{lat:t.latitude,lng:t.longitude},radius:t.distance,mapInfo:{},isShow:!0};n.signInRange.push(a)})},computed:{disabled:function(){return this.isSignIn?!0:(!this.mapInfoMark,new Date(this._getNowFormatDate()).getTime()-new Date(this.signInfo.timeStart).getTime()<0,new Date(this._getNowFormatDate()).getTime()-new Date(this.signInfo.timeEnd).getTime()>0)},mapData:function(){var n=this;if(this.signInRange[this.signInRange.length-1].mapInfo.distance||0===this.signInRange[this.signInRange.length-1].mapInfo.distance){var t=Math.min.apply(Math,this.signInRange.map(function(n){return n.mapInfo.distance}));this.signInRange.forEach(function(a){a.mapInfo.distance===t?n.curSignInRange=a:a.isShow=!1})}return this.signInRange}},methods:{_back:function(){this.$emit("removeBread",this.data)},_getLocation:function(n,t){t.mapInfo=n,n.inRange&&(this.mapInfoMark=!0)},_getNowFormatDate:function(){var n=new Date,t=n.getMonth()+1,a=n.getDate();return t>=1&&t<=9&&(t="0"+t),a>=0&&a<=9&&(a="0"+a),n.getFullYear()+"-"+t+"-"+a+" "+n.getHours()+":"+n.getMinutes()+":"+n.getSeconds()},_locationSignIn:function(){var n=this;Object(i.e)({url:"/api/signIns/"+this.signInfo.signInId+"/location",type:"post",data:{address:this.curSignInRange.mapInfo.nation+this.curSignInRange.mapInfo.province+this.curSignInRange.mapInfo.city+this.curSignInRange.mapInfo.addr,longitude:this.curSignInRange.mapInfo.lng,latitude:this.curSignInRange.mapInfo.lat},success:function(t){var a="";t.state?(a="签到成功",n.isSignIn=!0):a=t.message,n.$vux.toast.show({text:a,position:"bottom",type:"text"})}})}}},s={render:function(){var n=this,t=n.$createElement,a=n._self._c||t;return a("div",{staticStyle:{height:"100%"},attrs:{id:"locationSign"}},[a("view-box",[a("x-header",{staticClass:"location-sign-header"},[a("i",{staticClass:"maticon back-icon",attrs:{slot:"overwrite-left"},domProps:{innerHTML:n._s(n.icons("navigate_before"))},on:{click:n._back},slot:"overwrite-left"},[n._v("navigate_before")])]),n._v(" "),a("div",{staticClass:"location-content"},[a("div",[a("label",{staticClass:"label-name"},[n._v("签到名称：")]),a("label",[n._v(n._s(n.signInfo.signInName))])]),n._v(" "),a("div",[a("label",{staticClass:"label-name"},[n._v("签到开始时间：")]),a("label",[n._v(n._s(n.signInfo.timeStart))])]),n._v(" "),a("div",[a("label",{staticClass:"label-name"},[n._v("签到结束时间：")]),a("label",[n._v(n._s(n.signInfo.timeEnd))])]),n._v(" "),a("div",[a("label",{staticClass:"label-name"},[n._v("位置：")]),a("label",[n._v(n._s(n.mapInfoMark?"正处在":"未处在")+"定位范围内")])]),n._v(" "),n._l(n.mapData,function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"item.isShow"}],key:i,staticClass:"map-div"},[a("v-map",{attrs:{search:!1,location:"true",value:t.mapInfo,radius:t.radius,center:t.center},on:{getLocation:function(a){return n._getLocation(a,t)}}})],1)}),n._v(" "),a("div",{staticClass:"btn-div"},[a("x-button",{class:!n.mapInfoMark||n.disabled?"not-click-btn":"sign-btn",attrs:{mini:"",plain:"",disabled:!n.mapInfoMark||n.disabled},nativeOn:{click:function(t){return n._locationSignIn(t)}}},[n._v("签到")])],1)],2)],1)],1)},staticRenderFns:[]};var o=a("C7Lr")(e,s,!1,function(n){a("8K/W")},null,null);t.default=o.exports}});