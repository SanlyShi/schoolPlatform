webpackJsonp([230],{k5xA:function(t,a){},vwya:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("a3Yh"),o=e.n(s),n=(e("kV13"),e("C331")),i={data:function(){return{showDefaultImg:!1,picGirl:e("kjtu"),picBoy:e("6lQ7"),url:"/table-data/mentality/teachers/pages",timeStamp:"",columns:[],importPage:!1,showTypeModal:!1,showAddFullTimeModal:!1,showAddModal:!1,fullTimeConsultantId:"",importParams:{parentPageTitle:"咨询师管理",downloadTemplateUrl:"",downloadErrorTemplateUrl:"",checkTemplateUrl:"",templateName:"批量新增咨询师",importBtnType:null},sexData:[],modalType:"",consultantData:{teacherBaseInfo:{userId:"",name:"",sex:"",teacherContactPO:{mobilePhone:""}},synopsis:"",portrait:"",type:"",userCertificationVO:{userNo:"",password:""}},dutyTime:"",addType:"",consultantType:"",consultantTypeData:[{value:"FULL_TIME",label:"专职"},{value:"EXTERNAL",label:"外聘"}],isCheck:!1,isEditExternal:!1,isShowSearch:!0,userIdAndUserName:"",showErrorColor:!1,lang:"zh-cn"}},computed:{translate:function(){return Object(n.g)(this.lang).employmentUnitManage}},created:function(){var t=this,a=localStorage.getItem("lang");Object(n.g)(a)&&(this.lang=a),Object(n.e)({url:"/api/system/dicts",dataType:"json",type:"get",data:{dictType:"性别"},success:function(a){a.state?t.sexData=a.data:t.$toast(a.message)}}),this.importParams.importBtnType=[{url:"/mentality/teachers/batch/",method:"post",isShowBtn:!0,name:"覆盖导入",success:function(a){a.state&&(t._refreshTable(),t.importPage=!1)}}],this.columns=[{id:"name",title:"姓名",className:"text-left",width:100,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.teacherBaseInfo?t.teacherBaseInfo.name:""}},{id:"phone",title:"联系方式",width:120,className:"text-left",hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.teacherBaseInfo&&t.teacherBaseInfo.teacherContactPO?t.teacherBaseInfo.teacherContactPO.mobilePhone:""}},o()({id:"synopsis",title:"简介",width:100,className:"text-left",hidden:!1},"width",150),{id:"portrait",title:"照片",width:100,className:"text-left",hidden:!1,formatter:function(a){return a.portrait?[{tag:"img",text:"",src:t.imageUrlPrefix+a.portrait,className:"img-style"}]:[{tag:"img",text:"",src:"2"==a.teacherBaseInfo.sex?t.picGirl:t.picBoy,className:"img-style"}]}},{id:"userNo",title:"账号",className:"text-left",width:120,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}},formatter:function(t){return t.userCertificationVO?t.userCertificationVO.userNo:""}},{id:"opt",title:"操作",className:"text-left",width:130,hidden:!1,formatter:function(a){return[{tag:"a",text:"查看",callback:function(a,e){t.isCheck=!0,t.showAddModal=!0,t.modalType="查看",t.isEditExternal="FULL_TIME"!==a.type,t.consultantType=a.type;var s={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},o=[];a.timeTeacherSettings&&a.timeTeacherSettings.forEach(function(t,a){o.push(s[t.dayOfWeek]+" "+t.timeSetting.timeQuantumStart+"~"+t.timeSetting.timeQuantumEnd)}),t.consultantData={teacherBaseInfo:{userId:a.teacherBaseInfo?a.teacherBaseInfo.userId:"",name:a.teacherBaseInfo?a.teacherBaseInfo.name:"",sex:a.teacherBaseInfo?a.teacherBaseInfo.sex:"",teacherContactPO:{mobilePhone:a.teacherBaseInfo&&a.teacherBaseInfo.teacherContactPO?a.teacherBaseInfo.teacherContactPO.mobilePhone:""}},synopsis:a.synopsis,portrait:a.portrait,type:a.type,userCertificationVO:{userNo:a.userCertificationVO?a.userCertificationVO.userNo:"",password:a.userCertificationVO?a.userCertificationVO.password:""}},t.dutyTime=o}},{tag:"a",text:"编辑",className:"opt-btn",callback:function(a,e){t.modalType="编辑",t.isEditExternal="FULL_TIME"!==a.type,t.consultantType=a.type,t.isCheck=!1,t.showAddModal=!0,t.fullTimeConsultantId=a.teacherBaseInfo.userId,t.consultantData={userCertificationVO:a.userCertificationVO,teacherBaseInfo:{userId:a.teacherBaseInfo?a.teacherBaseInfo.userId:"",name:a.teacherBaseInfo?a.teacherBaseInfo.name:"",sex:a.teacherBaseInfo?a.teacherBaseInfo.sex:"",teacherContactPO:{mobilePhone:a.teacherBaseInfo&&a.teacherBaseInfo.teacherContactPO?a.teacherBaseInfo.teacherContactPO.mobilePhone:""}},synopsis:a.synopsis,portrait:a.portrait,type:a.type},t.consultantData.portrait||(t.showDefaultImg=!0)}},{tag:"a",text:a.disable?"启用":"禁用",className:"opt-btn",callback:function(e,s){a.disable?Object(n.e)({url:"/api/mentality/teachers/using/"+e.teacherBaseInfo.userId,type:"post",success:function(a){a.state?(t._refreshTable(),t.$toast("启动成功！")):t.$toast(a.message)}}):window.confirm("确定禁用吗？")&&Object(n.e)({url:"/api/mentality/teachers/disable/"+e.teacherBaseInfo.userId,type:"post",success:function(a){a.state?(t._refreshTable(),t.$toast("禁用成功！")):t.$toast(a.message)}})}}]}}]},methods:{_selectConsultantType:function(t){this.consultantType=t.value},_selectSex:function(t){this.isCheck||(this.consultantData.teacherBaseInfo.sex=t.value)},changeUserSearch:function(){this.isShowSearch=!0,this.userIdAndUserName="",this.fullTimeConsultantId=""},showConsultantTypeModal:function(t){this.addType=t,this.showTypeModal=!0,this.consultantType="",this.consultantData.userCertificationVO={userNo:"",password:""}},sumbitTypeModal:function(){if(!this.consultantType)return this.$toast("请先选择咨询师类型");this.showTypeModal=!1,"batch"===this.addType?(this.showTypeModal=!1,this.importPage=!0,this.importParams.downloadTemplateUrl="/mentality/teachers/batchCreate/templates/"+this.consultantType,this.importParams.downloadErrorTemplateUrl="/mentality/teachers/excel/error",this.importParams.checkTemplateUrl="/mentality/teachers/excel/"+this.consultantType):"FULL_TIME"===this.consultantType?(this.showAddFullTimeModal=!0,this.userIdAndUserName="",this.isShowSearch=!0,this.fullTimeConsultantId=""):(this.showAddModal=!0,this.isCheck=!1,this.modalType="新增",this.consultantData={teacherBaseInfo:{userId:"",name:"",sex:"",teacherContactPO:{mobilePhone:""}},synopsis:"",portrait:"",type:"",userCertificationVO:{userNo:"",password:""}})},submitConsultantInfo:function(){"新增"===this.modalType?this._addConsultant():"编辑"===this.modalType&&this._editConsultant()},_checkDataIsExist:function(){var t=!0;if("EXTERNAL"===this.consultantType){if(!this.consultantData.userCertificationVO.userNo)return this.$toast("请填写账号"),!1;if(!this.consultantData.userCertificationVO.password)return this.$toast("请填写密码"),!1}return this.consultantData.teacherBaseInfo.name?this.consultantData.teacherBaseInfo.sex?this.consultantData.teacherBaseInfo.teacherContactPO.mobilePhone?this.consultantData.synopsis?t:(this.$toast("请填写简介"),!1):(this.$toast("请填写联系方式"),!1):(this.$toast("请选择性别"),!1):(this.$toast("请填写姓名"),!1)},_addConsultant:function(){var t=this;this._checkDataIsExist()&&(this.consultantData.type="EXTERNAL",Object(n.e)({url:"/api/mentality/teachers",type:"post",data:[this.consultantData],success:function(a){a.state?(t.showAddModal=!1,t._refreshTable(),t.$toast("添加成功！")):t.$toast(a.message)}}))},_editConsultant:function(){var t=this;this._checkDataIsExist()&&Object(n.e)({url:"/api/mentality/teachers/update",type:"post",data:this.consultantData,success:function(a){a.state?(t.showAddModal=!1,t._refreshTable(),t.$toast("保存成功！")):t.$toast(a.message)}})},isPhoneNo:function(){if(!/^1[3456789]\d{9}$/.test(this.consultantData.teacherBaseInfo.teacherContactPO.mobilePhone))return this.$toast("联系方式格式不正确"),void(this.showErrorColor=!0);this.showErrorColor=!1},sumbitFullTimeModal:function(){var t=this;if(!this.fullTimeConsultantId)return this.$toast("请先检索咨询师");var a=[];a.push({teacherBaseInfo:{userId:this.fullTimeConsultantId},type:"FULL_TIME"}),Object(n.e)({url:"/api/mentality/teachers",type:"post",data:a,success:function(a){a.state?(t.showAddFullTimeModal=!1,t._refreshTable(),t.$toast("新增成功！")):t.$toast(a.message)}})},consultantSelected:function(t){this.fullTimeConsultantId=t.userId,this.userIdAndUserName=t.name+" ("+t.userNo+")",this.isShowSearch=!1},_refreshTable:function(){this.url="/table-data/mentality/teachers/pages?timeStamp="+Object(n.a)()},_fileUpload:function(t){var a=this;this.$waiting.show({text:"照片上传中..."});var e=new FormData;e.append("file",t.target.files[0]),e.append("fieldName",t.target.files[0].name),Object(n.e)({url:this.uploadFile,type:"post",data:e,contentType:!1,processData:!1,success:function(t){"88888"===t.code?(a.consultantData.portrait=t.data.hash,a.$toast("照片上传成功")):a.$toast(t.message)}}).always(function(){a.$waiting.close()})},removeImg:function(){confirm("确定删除该照片吗？")&&(this.consultantData.portrait="",this.showDefaultImg=!1)},_showAttachmentPreview:function(){var t=void 0,a=this.consultantData.teacherBaseInfo.sex;t=this.consultantData.portrait?this.fileUrlPrefix+this.consultantData.portrait:"2"==a?this.picGirl:this.picBoy,this.$preview({name:"照片",url:t,type:"png"})}}},r={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.importPage?e("v-import",t._b({on:{backParentPage:function(a){t.importPage=!1}}},"v-import",t.importParams,!1)):e("div",{staticClass:"container-fluid",attrs:{id:"consultant-manage"}},[e("div",{staticClass:"row text-center"},[e("v-table",{attrs:{title:"咨询师管理",url:t.url,pagesize:"10",idField:"id",columns:t.columns,multiple:!1,order:!0,search:!1}},[e("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[e("button",{staticClass:"btn add clearBtnBorder",attrs:{type:"button"},on:{click:function(a){return t.showConsultantTypeModal("batch")}}},[t._v("批量新增咨询师")]),t._v(" "),e("button",{staticClass:"btn add clearBtnBorder",attrs:{type:"button"},on:{click:function(a){return t.showConsultantTypeModal("single")}}},[t._v("单个新增咨询师")])])])],1),t._v(" "),e("v-modal",{attrs:{show:t.showTypeModal,effect:"fade",width:"400"}},[e("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("\n          选择咨询师类型\n      ")])]),t._v(" "),e("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-options"},t._l(t.consultantTypeData,function(a,s){return e("span",{key:s,on:{click:function(e){return t._selectConsultantType(a)}}},[e("i",{staticClass:"maticon",class:{active:t.consultantType===a.value},domProps:{innerHTML:t._s(t.icons(t.consultantType===a.value?"radio_button_checked":"radio_button_unchecked"))}}),t._v(t._s(a.label)+"\n          ")])}),0)])]),t._v(" "),e("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(a){t.showTypeModal=!1}}},[t._v("取消")]),t._v(" "),e("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.sumbitTypeModal}},[t._v("确定")])])]),t._v(" "),e("v-modal",{attrs:{show:t.showAddFullTimeModal,effect:"fade",width:"400"}},[e("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("\n          新增咨询师\n      ")])]),t._v(" "),e("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[e("div",{staticClass:"modal-search-user"},[t.isShowSearch?e("detect",{attrs:{url:"/api/document/teachers/searchResults",placeholder:"咨询师姓名或学工号"},on:{afterSelected:t.consultantSelected}}):e("div",[e("div",{staticClass:"user-info pull-left"},[t._v(t._s(t.userIdAndUserName))]),t._v(" "),e("i",{staticClass:"maticon pull-left",domProps:{innerHTML:t._s(t.icons("edit"))},on:{click:t.changeUserSearch}},[t._v("edit")])])],1)]),t._v(" "),e("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(a){t.showAddFullTimeModal=!1}}},[t._v("取消")]),t._v(" "),e("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.sumbitFullTimeModal}},[t._v("确定")])])]),t._v(" "),e("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"670"}},[e("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("\n          "+t._s(t.modalType)+"咨询师\n      ")])]),t._v(" "),e("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[e("div",{staticClass:"row",staticStyle:{"margin-bottom":"25px"}},[e("div",{staticClass:"col-md-6"},["EXTERNAL"===t.consultantType?e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label two-words-difference-margin"},[t._v("账号")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.userCertificationVO.userNo,expression:"consultantData.userCertificationVO.userNo"}],staticClass:"form-control form-input",attrs:{type:"text",disabled:t.isCheck||t.isEditExternal,placeholder:"请输入账号"},domProps:{value:t.consultantData.userCertificationVO.userNo},on:{input:function(a){a.target.composing||t.$set(t.consultantData.userCertificationVO,"userNo",a.target.value)}}})]):t._e(),t._v(" "),"EXTERNAL"===t.consultantType?e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label two-words-difference-margin"},[t._v("密码")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.userCertificationVO.password,expression:"consultantData.userCertificationVO.password"}],staticClass:"form-control form-input",attrs:{type:"text",disabled:t.isCheck,placeholder:"请输入密码"},domProps:{value:t.consultantData.userCertificationVO.password},on:{input:function(a){a.target.composing||t.$set(t.consultantData.userCertificationVO,"password",a.target.value)}}})]):t._e(),t._v(" "),e("div",{staticClass:"form-group "},[e("label",{staticClass:"form-label two-words-difference-margin"},[t._v("姓名")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.teacherBaseInfo.name,expression:"consultantData.teacherBaseInfo.name"}],staticClass:"form-control form-input",attrs:{type:"text",disabled:t.isCheck||"编辑"==t.modalType&&"full_time"==t.consultantData.type,placeholder:"请输入姓名"},domProps:{value:t.consultantData.teacherBaseInfo.name},on:{input:function(a){a.target.composing||t.$set(t.consultantData.teacherBaseInfo,"name",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"info-item"},[e("span",{staticClass:"item-title"},[t._v("性别")]),t._v(" "),e("div",{staticClass:"info-options",class:t.isCheck?"disabled-click":""},t._l(t.sexData,function(a,s){return e("span",{key:s,on:{click:function(e){return t._selectSex(a)}}},[e("i",{staticClass:"maticon",class:t.consultantData.teacherBaseInfo.sex===a.value?"active":"",domProps:{innerHTML:t._s(t.icons(t.consultantData.teacherBaseInfo.sex===a.value?"radio_button_checked":"radio_button_unchecked"))}}),t._v(t._s(a.label)+"\n              ")])}),0)]),t._v(" "),e("div",{staticClass:"form-group "},[e("label",{staticClass:"form-label",staticStyle:{"min-width":"20px"}},[t._v("联系方式")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.teacherBaseInfo.teacherContactPO.mobilePhone,expression:"consultantData.teacherBaseInfo.teacherContactPO.mobilePhone"}],staticClass:"form-control form-input",class:t.showErrorColor?"error":"",attrs:{type:"text",placeholder:"请输入联系方式",disabled:t.isCheck},domProps:{value:t.consultantData.teacherBaseInfo.teacherContactPO.mobilePhone},on:{change:t.isPhoneNo,input:function(a){a.target.composing||t.$set(t.consultantData.teacherBaseInfo.teacherContactPO,"mobilePhone",a.target.value)}}})]),t._v(" "),t.isCheck?e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("值班时间")]),t._v(" "),e("div",{staticClass:"duty-time"},t._l(t.dutyTime,function(a,s){return e("div",{key:s},[t._v(t._s(a)+" ")])}),0)]):t._e()]),t._v(" "),e("div",{staticClass:"col-md-6"},[t.isCheck?e("div",{staticClass:"form-group aa"},[e("label",{staticClass:"textarea-label two-words-difference-margin"},[t._v("照片")]),t._v(" "),t.consultantData.portrait?e("div",{staticClass:"photo-show",style:{backgroundImage:"url("+(t.imageUrlPrefix+t.consultantData.portrait)+"?thumb=true)",backgroundSize:"100% 100%"},on:{click:t._showAttachmentPreview}}):e("div",{staticClass:"photo-show cc",style:{backgroundImage:"2"==t.consultantData.teacherBaseInfo.sex?"url("+t.picGirl+")":"url("+t.picBoy+")",backgroundSize:"100% 100%"},on:{click:t._showAttachmentPreview}})]):e("div",{staticClass:"form-group"},[e("label",{staticClass:"textarea-label two-words-difference-margin"},[t._v("照片")]),t._v(" "),t.consultantData.portrait||t.showDefaultImg?e("div",[t.consultantData.portrait?e("div",{staticClass:"photo-show",style:{backgroundImage:"url("+(t.imageUrlPrefix+t.consultantData.portrait)+"?thumb=true)",backgroundSize:"100% 100%"},on:{click:t._showAttachmentPreview}},[t.isCheck?t._e():e("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("cancel"))},on:{click:function(a){return a.stopPropagation(),t.removeImg(a)}}},[t._v("cancel")])]):e("div",{staticClass:"file-select"},[e("div",{staticClass:"photo-show",style:{backgroundImage:"2"==t.consultantData.teacherBaseInfo.sex?"url("+t.picGirl+")":"url("+t.picBoy+")",backgroundSize:"100% 100%"},on:{click:t._showAttachmentPreview}},[t.isCheck?t._e():e("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("cancel"))},on:{click:function(a){return a.stopPropagation(),t.removeImg(a)}}},[t._v("cancel")])])])]):e("div",{staticClass:"file-select"},[e("i",{staticClass:"maticon uploadIcon",domProps:{innerHTML:t._s(t.icons("file_upload"))}},[t._v("file_upload")]),t._v(" "),e("input",{attrs:{type:"file",accept:"image/*"},on:{change:function(a){return t._fileUpload(a)}}})])])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"input-label two-words-difference-margin textarea-label"},[t._v("简介")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.consultantData.synopsis,expression:"consultantData.synopsis"}],staticClass:"modal-textarea",attrs:{cols:"24",rows:"5",maxlength:"300",placeholder:"请输入300字以内的简介",disabled:t.isCheck},domProps:{value:t.consultantData.synopsis},on:{input:function(a){a.target.composing||t.$set(t.consultantData,"synopsis",a.target.value)}}})])]),t._v(" "),e("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(a){t.showAddModal=!1}}},[t._v("取消")]),t._v(" "),t.isCheck?t._e():e("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.submitConsultantInfo}},[t._v("确定")])])])],1)},staticRenderFns:[]};var l=e("C7Lr")(i,r,!1,function(t){e("k5xA")},null,null);a.default=l.exports}});