webpackJsonp([70],{EY4M:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("kV13");var s=a("C331"),i=a("3cXf"),r=a.n(i),n=a("WCPx"),o=a.n(n),l={data:function(){return{dateArea:["",""],dateArea2:["",""]}},created:function(){this.dateArea=this.dataRange,this.dateArea2=JSON.parse(r()(this.dataRange))},props:{dataRange:{default:function(){return["",""]}}},watch:{dataRange:function(t){this.dateArea=t},dateArea:function(t){t&&(this.searchOptions.dateStart=t[0],this.searchOptions.dateEnd=t[1])},dateArea2:function(t){t&&(this.searchOptions.dateStart2=t[0],this.searchOptions.dateEnd2=t[1])}},methods:{}},c={mixins:[l],props:{detail:{default:function(){return{}}},options:{default:function(){return{}}}},data:function(){return{myPanelChart:"",myPieChart:"",type:"pie",optionData:{},searchOptions:{dateStart:"",dateEnd:"",dateStart2:"",dateEnd2:""},recordDetail:{},curTab:"1",tabList:[{name:"总览",id:"1"},{name:"时间维度",id:"2"},{name:"课程维度",id:"4"},{name:"按时间对比",id:"3"}]}},computed:{},watch:{options:function(t){this.searchOptions=JSON.parse(r()(t))},searchOptions:{handler:function(t){this.selectTab(this.curTab)},deep:!0}},created:function(){var t=JSON.parse(r()(this.options));t.dateStart2=t.dateStart,t.dateEnd2=t.dateEnd,this.searchOptions=t,this.recordDetail=this.detail},mounted:function(){},methods:{afterSelectDateStart:function(){},afterSelectDateEnd:function(){},back:function(){this.$parent.curRoute="allStaff"},selectTab:function(t){this.curTab=t,"1"===t?this.getPieData():"2"===t?this.getLineData():"3"===t?this.getBarData():"4"===t&&this.getPanelData()},getBarData:function(){var t=this,e="api/ca/student/statistic/single/all?uId="+this.recordDetail.userId+"&dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0],a="api/ca/student/statistic/single/all?uId="+this.recordDetail.userId+"&dateStart="+this.searchOptions.dateStart2.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd2.split(" ")[0],i={rateOfAttendance:0,rateOfAskForLeave:0,rateOfaAbsent:0},r={rateOfAttendance:0,rateOfAskForLeave:0,rateOfaAbsent:0};Object(s.d)(e).then(function(e){e.state&&e.data&&(i=e.data,Object(s.d)(a).then(function(e){if(e.state&&e.data){r=e.data;var a=[["product","出勤率","请假率","缺勤率"],[t.searchOptions.dateStart.split(" ")[0]+"至"+t.searchOptions.dateEnd.split(" ")[0],i.rateOfAttendance,i.rateOfAskForLeave,i.rateOfaAbsent],[t.searchOptions.dateStart2.split(" ")[0]+"至"+t.searchOptions.dateEnd2.split(" ")[0],r.rateOfAttendance,r.rateOfAskForLeave,r.rateOfaAbsent]];t.initBarChart(a)}}))})},initBarChart:function(t){this.myBarChart=o.a.init(this.$refs.bar),this.barOptionData={legend:{y:"bottom"},dataset:{source:t},tooltip:{formatter:function(t){return t.value[t.seriesIndex+1]+"%"}},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],xAxis:{axisTick:{show:!1},type:"category"},yAxis:{axisTick:{show:!1}},series:[{type:"bar"},{type:"bar"},{type:"bar"}]},this.myBarChart.setOption(this.barOptionData)},getPieData:function(){var t=this,e="api/ca/student/statistic/single/all?uId="+this.recordDetail.userId+"&dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0];Object(s.d)(e).then(function(e){if(e.state){var a=[{value:0,name:"出勤"},{value:0,name:"请假"},{value:0,name:"缺勤"}],s=0;e.data&&(a[0].value=e.data.countOfAttendance,a[1].value=e.data.countOfAskForLeave,a[2].value=e.data.countOfaAbsent,s=e.data.rateOfAttendance),t.initPieChart(a,s)}else t.$toast(e.message)})},getLineData:function(){var t=this,e="api/ca/student/statistic/everyday/all?uId="+this.recordDetail.userId+"&dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0];Object(s.d)(e).then(function(e){if(e.state&&e.data){var a=[],s=[],i=[],r=e.data.map(function(e){return a.push(t.paserIntOneLittleNum(e.rateOfAttendance)),s.push(t.paserIntOneLittleNum(e.rateOfAskForLeave)),i.push(t.paserIntOneLittleNum(e.rateOfaAbsent)),e.date}),n=[{name:"出勤",type:"line",data:a},{name:"请假",type:"line",data:s},{name:"缺勤",type:"line",data:i}];t.initLineChart(r,n)}else t.$toast(e.message)})},getPanelData:function(){var t=this,e="api/ca/student/statistic/everyCourse/all?uId="+this.recordDetail.userId+"&dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0];Object(s.d)(e).then(function(e){if(e.state&&e.data){var a=[{name:"出勤",type:"bar",stack:"总量",barCategoryGap:15,label:{normal:{show:!0,position:"insideRight",formatter:function(t){return 0==t.value?"":t.value}}},data:[]},{name:"请假",type:"bar",stack:"总量",label:{normal:{show:!1,position:"insideRight"}},data:[]},{name:"缺勤",type:"bar",stack:"总量",label:{normal:{show:!1,position:"insideRight"}},data:[]}];t.panelChartHeight=82+33*e.data.length;var s=e.data.map(function(e){return a[0].data.push(t.paserIntOneLittleNum(e.rateOfAttendance)),a[1].data.push(t.paserIntOneLittleNum(e.rateOfAskForLeave)),a[2].data.push(t.paserIntOneLittleNum(e.rateOfaAbsent)),e.courseName});t.initPanelChart(s,a)}else t.$toast(e.message)})},paserIntOneLittleNum:function(t){return parseInt((10*t).toString().split(".")[0])/10},initPieChart:function(t,e){this.myPieChart=o.a.init(this.$refs.pie),this.pieOptionData={title:{text:""},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},graphic:[{type:"text",left:"center",top:"45%",style:{text:parseInt(e)+"%",textAlign:"center",fill:"#303133",width:30,height:30,fontSize:"50",fontFamily:"Microsoft YaHei"}},{type:"text",left:"center",top:"58%",style:{text:"出勤率",textAlign:"center",fill:"gray",width:30,height:30,fontSize:18,fontFamily:"Microsoft YaHei"}}],legend:{orient:"vertical",x:"right",data:["出勤","请假","缺勤"]},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],series:[{name:"整体出勤情况",type:"pie",radius:["50%","70%"],center:["50%","50%"],avoidLabelOverlap:!1,label:{normal:{show:!1,position:"center"},emphasis:{show:!1,textStyle:{fontSize:"30",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},data:t}]},this.myPieChart.setOption(this.pieOptionData)},initLineChart:function(t,e){this.lineChart=o.a.init(this.$refs.line),this.lineOptionData={title:{text:""},tooltip:{trigger:"axis",formatter:function(t){var e="";return t.forEach(function(t){e+=t.marker+t.seriesName+":"+t.data+"%</br>"}),e}},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],legend:{data:["出勤","请假","缺勤"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:t},yAxis:{axisTick:{show:!1},type:"value"},series:e},this.lineChart.setOption(this.lineOptionData)},initPanelChart:function(t,e){this.myPanelChart=o.a.init(this.$refs.chartPanel),this.panelOptionData={title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){var e=t[0].name+"<br/>";return t.map(function(t){e+=t.seriesName+":"+t.data+"%<br/>"}),e}},legend:{y:"10",data:["出勤","请假","缺勤"]},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{position:"top",type:"value",axisTick:{show:!1},axisLabel:{formatter:"{value} %"}},yAxis:{type:"category",inverse:!0,axisTick:{show:!1},data:t},series:e},this.myPanelChart.setOption(this.panelOptionData),this.myPanelChart.resize({height:this.panelChartHeight})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a",{staticClass:"box_flex align_center back_wrap",attrs:{type:"button"},on:{click:function(e){return t.back()}}},[a("i",{staticClass:"maticon back-icon-btn",domProps:{innerHTML:t._s(t.icons("arrow_back"))}},[t._v("arrow_back")]),a("span",{staticClass:"nav-title"},[t._v("返回")])]),t._v(" "),a("div",{staticClass:"chart_page",attrs:{id:"recordChart-page"}},[a("div",{staticClass:"box_flex",staticStyle:{padding:"10px 0"}},[a("div",{staticClass:"name"},[t._v(t._s(t.detail.name))]),t._v(" "),a("div",{staticClass:"userNum"},[t._v(t._s(t.detail.userNo))])]),t._v(" "),a("div",{staticClass:"main_wrap"},[a("div",{staticClass:"box_flex box_between"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"box_flex flex_center date_picker_wrap"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateArea,callback:function(e){t.dateArea=e},expression:"dateArea"}})],1),t._v(" "),"3"===t.curTab?a("div",{staticClass:"box_flex flex_center date_picker_wrap"},[a("div",{staticStyle:{width:"100px","text-align":"center"}},[t._v("对比")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateArea2,callback:function(e){t.dateArea2=e},expression:"dateArea2"}})],1):t._e()]),t._v(" "),a("div",{staticClass:"btn-tab"},t._l(t.tabList,function(e,s){return a("div",{key:s,staticClass:"btn clearBtnBorder submit-btn",class:t.curTab===e.id?"btn-bgColor-style":"",attrs:{title:e.name},on:{click:function(a){return t.selectTab(e.id)}}},[t._v(t._s(e.name))])}),0)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"1"===t.curTab,expression:"curTab==='1'"}],staticClass:"box_flex flex_center chart_wrap"},[a("div",{ref:"pie",staticClass:"chart",staticStyle:{width:"100%"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"2"===t.curTab,expression:"curTab==='2'"}],staticClass:"box_flex flex_center chart_wrap"},[a("div",{ref:"line",staticClass:"chart",staticStyle:{width:"100%"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"3"===t.curTab,expression:"curTab==='3'"}],staticClass:"box_flex flex_center chart_wrap"},[a("div",{ref:"bar",staticClass:"chart",staticStyle:{width:"100%"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"4"===t.curTab,expression:"curTab==='4'"}],staticClass:"box_flex flex_center chart_wrap"},[a("div",{ref:"chartPanel",staticClass:"chart"})])])])])},staticRenderFns:[]};var h=a("C7Lr")(c,d,!1,function(t){a("f8iV")},"data-v-8df72494",null).exports,u=a("wixZ"),p=(u.a,{mixins:[l],props:{detail:{default:function(){return{}}},options:{default:function(){return{}}}},data:function(){return{myPanelChart:"",myBarChart:"",type:"bar",showMore:!1,optionData:{},searchOptions:{dateStart:"",dateEnd:"",dateStart2:"",dateEnd2:""},panelChartHeight:450,curSource:"",recordDetail:{},curTab:"1",powerTabList:[],tabList:[{name:"总览",id:"1"},{name:"按时间对比",id:"2"},{name:"按班级对比",id:"3"}]}},computed:{},watch:{options:function(t){this.searchOptions=JSON.parse(r()(t))},curSource:function(t){this.getPanelData()},searchOptions:{handler:function(t){this.selectTab(this.curTab)},deep:!0}},created:function(){var t=JSON.parse(r()(this.options));t.dateStart2=t.dateStart,t.dateEnd2=t.dateEnd,this.searchOptions=t,this.recordDetail=this.detail},mounted:function(){},methods:{afterSelectDateStart:function(){},afterSelectDateEnd:function(){},showMoreRecord:function(){this.showMore=!this.showMore,this.getPanelData()},back:function(){this.$parent.curRoute="allStaff"},selectTab:function(t){this.curTab=t,"1"===t?this.getLineData():"2"===t?this.getBarData():"3"===t&&this.getPowerTabList()},getPowerTabList:function(){var t=this,e="api/ca/class/statistic/permission/"+this.recordDetail.classId;Object(s.d)(e).then(function(e){e.state&&e.data?(t.powerTabList=[],e.data.isSchool&&t.powerTabList.push({checked:!1,name:"同全校班级对比",id:"school"}),e.data.relClass&&t.powerTabList.push({checked:!1,name:"同带班班级对比",id:"relClass"}),e.data.isCollege&&t.powerTabList.push({checked:!1,name:"同学院班级对比",id:"college"})):t.$toast(e.message),t.powerTabList.length&&(t.curSource=t.powerTabList[0].id),t.getPanelData()})},getLineData:function(){var t=this,e="api/ca/class/statistic/everyday/all?classId="+this.recordDetail.classId+"&dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0];Object(s.d)(e).then(function(e){if(e.state&&e.data){var a=[],s=[],i=[],r=e.data.map(function(t){return a.push(t.rateOfAttendance),s.push(t.rateOfAskForLeave),i.push(t.rateOfaAbsent),t.date}),n=[{name:"出勤",type:"line",data:a},{name:"请假",type:"line",data:s},{name:"缺勤",type:"line",data:i}];t.initLineChart(r,n)}else t.$toast(e.message)})},getPanelData:function(){var t=this,e="api/ca/class/statistic/compare/"+this.curSource+"/"+this.recordDetail.classId+"?dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0];Object(s.d)(e).then(function(e){if(e.state&&e.data){var a=[{name:"出勤",type:"bar",stack:"总量",barCategoryGap:15,label:{normal:{show:!0,position:"insideRight",formatter:function(t){return 0==t.value?"":t.value}}},data:[]},{name:"请假",type:"bar",stack:"总量",label:{normal:{show:!1,position:"insideRight"}},data:[]},{name:"缺勤",type:"bar",stack:"总量",label:{normal:{show:!1,position:"insideRight"}},data:[]}];t.showMore||(e.data=e.data.filter(function(t,e){return e<10})),t.panelChartHeight=82+33*e.data.length;var s=e.data.map(function(e){return a[0].data.push(t.paserIntOneLittleNum(e.rateOfAttendance)),a[1].data.push(t.paserIntOneLittleNum(e.rateOfAskForLeave)),a[2].data.push(t.paserIntOneLittleNum(e.rateOfaAbsent)),e.className});t.$nextTick(t.initPanelChart(s,a))}else t.$toast(e.message)})},getBarData:function(){var t=this,e="api/ca/class/statistic/single/all?classId="+this.recordDetail.classId+"&dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0],a="api/ca/class/statistic/single/all?classId="+this.recordDetail.classId+"&dateStart="+this.searchOptions.dateStart2.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd2.split(" ")[0],i={rateOfAttendance:0,rateOfAskForLeave:0,rateOfaAbsent:0},r={rateOfAttendance:0,rateOfAskForLeave:0,rateOfaAbsent:0};Object(s.d)(e).then(function(e){e.state&&e.data?(i=e.data,Object(s.d)(a).then(function(e){if(e.state&&e.data){r=e.data;var a=[["product","出勤率","请假率","缺勤率"],[t.searchOptions.dateStart.split(" ")[0]+"至"+t.searchOptions.dateEnd.split(" ")[0],i.rateOfAttendance,i.rateOfAskForLeave,i.rateOfaAbsent],[t.searchOptions.dateStart2.split(" ")[0]+"至"+t.searchOptions.dateEnd2.split(" ")[0],r.rateOfAttendance,r.rateOfAskForLeave,r.rateOfaAbsent]];t.initBarChart(a)}else t.$toast(e.message)})):t.$toast(e.message)})},paserIntOneLittleNum:function(t){return parseInt((10*t).toString().split(".")[0])/10},initBarChart:function(t){this.myBarChart=o.a.init(this.$refs.bar),this.barOptionData={legend:{y:"bottom"},tooltip:{formatter:function(t){return t.value[t.seriesIndex+1]+"%"}},dataset:{source:t},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],xAxis:{axisTick:{show:!1},type:"category"},yAxis:{axisTick:{show:!1}},series:[{type:"bar"},{type:"bar"},{type:"bar"}]},this.myBarChart.setOption(this.barOptionData)},initLineChart:function(t,e){this.lineChart=o.a.init(this.$refs.line),this.lineOptionData={title:{text:""},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],tooltip:{trigger:"axis",formatter:function(t){var e="";return t.forEach(function(t){e+=t.marker+t.seriesName+":"+t.data+"%</br>"}),e}},legend:{data:["出勤","请假","缺勤"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:t},yAxis:{axisTick:{show:!1},type:"value"},series:e},this.lineChart.setOption(this.lineOptionData)},initPanelChart:function(t,e){this.myPanelChart=o.a.init(this.$refs.chartPanel),this.panelOptionData={title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){var e=t[0].name+"<br/>";return t.map(function(t){e+=t.seriesName+":"+t.data+"%<br/>"}),e}},legend:{y:"10",data:["出勤","请假","缺勤"]},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{position:"top",type:"value",axisTick:{show:!1},axisLabel:{formatter:"{value} %"}},yAxis:{type:"category",inverse:!0,axisTick:{show:!1},data:t},series:e},this.myPanelChart.resize({height:this.panelChartHeight}),this.myPanelChart.setOption(this.panelOptionData)}},components:{radiobox:u.a}}),f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a",{staticClass:"box_flex align_center back_wrap",attrs:{type:"button"},on:{click:function(e){return t.back()}}},[a("i",{staticClass:"maticon back-icon-btn",domProps:{innerHTML:t._s(t.icons("arrow_back"))}},[t._v("arrow_back")]),a("span",{staticClass:"nav-title"},[t._v("返回")])]),t._v(" "),a("div",{staticClass:"chart_page",attrs:{id:"classChart-page"}},[a("div",{staticClass:"box_flex",staticStyle:{padding:"10px 0"}},[a("div",{staticClass:"userNum"},[t._v(t._s(t.detail.className))])]),t._v(" "),a("div",{staticClass:"main_wrap"},[a("div",{staticClass:"box_flex box_between"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"box_flex flex_center date_picker_wrap"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateArea,callback:function(e){t.dateArea=e},expression:"dateArea"}})],1),t._v(" "),"2"===t.curTab?a("div",{staticClass:"box_flex flex_center date_picker_wrap"},[a("div",{staticStyle:{width:"100px","text-align":"center"}},[t._v("对比")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateArea2,callback:function(e){t.dateArea2=e},expression:"dateArea2"}})],1):t._e()]),t._v(" "),a("div",{staticClass:"btn-tab"},t._l(t.tabList,function(e,s){return a("div",{key:s,staticClass:"btn clearBtnBorder submit-btn",class:t.curTab===e.id?"btn-bgColor-style":"",attrs:{title:e.name},on:{click:function(a){return t.selectTab(e.id)}}},[t._v(t._s(e.name))])}),0)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"1"===t.curTab,expression:"curTab==='1'"}],staticClass:"box_flex flex_center chart_wrap"},[a("div",{ref:"line",staticClass:"chart",staticStyle:{width:"100%"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"2"===t.curTab,expression:"curTab==='2'"}],staticClass:"box_flex flex_center chart_wrap"},[a("div",{ref:"bar",staticClass:"chart",staticStyle:{width:"100%"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"3"===t.curTab,expression:"curTab==='3'"}],staticClass:"box_flex flex_center radiobox_wrap chart_wrap"},[a("radiobox",{staticClass:"radio_box",attrs:{radioList:t.powerTabList,column:!0},model:{value:t.curSource,callback:function(e){t.curSource=e},expression:"curSource"}}),t._v(" "),t.showMore?a("button",{staticClass:"btn submit-btn",on:{click:function(e){return t.showMoreRecord()}}},[t._v("收起")]):a("button",{staticClass:"btn submit-btn",on:{click:function(e){return t.showMoreRecord()}}},[t._v("更多")]),t._v(" "),a("div",{ref:"chartPanel",staticClass:"chart",staticStyle:{"overflow-y":"auto",width:"800px"}})],1)])])])},staticRenderFns:[]};var b=a("C7Lr")(p,f,!1,function(t){a("lt9+")},"data-v-75ee8bee",null).exports,m=(u.a,{mixins:[l],props:{detail:{default:function(){return{}}},options:{default:function(){return{}}}},data:function(){return{myPanelChart:"",myBarChart:"",curRoute:"chart",type:"bar",optionData:{},studentColumns:[],searchOptions:{dateStart:"",dateEnd:"",dateStart2:"",dateEnd2:""},panelChartHeight:450,recordDetail:{},curTab:"1",powerTabList:[],tabList:[{name:"总览",id:"1"},{name:"按时间对比",id:"2"},{name:"按班级对比",id:"3"},{name:"切换到学生维度",id:"4"}],sutdentTabList:[{name:"切换到课程维度",id:"5"},{name:"导出",id:"6"}],classTabList:[],courseClassId:""}},computed:{studentTableUrl:function(){return"/table-data/ca/course/statistic/students/page/"+this.courseClassId}},watch:{options:function(t){this.searchOptions=JSON.parse(r()(t))},searchOptions:{handler:function(t){this.courseClassId&&this.selectTab(this.curTab)},deep:!0},courseClassId:function(t){this.selectTab(this.curTab)}},created:function(){var t=JSON.parse(r()(this.options));t.dateStart2=t.dateStart,t.dateEnd2=t.dateEnd,this.searchOptions=t,this.recordDetail=this.detail,this.getClassTabList(),this.initStudentTable()},mounted:function(){},methods:{exportData:function(){var t="/downloads/ca/course/statistic/students/excel/"+this.courseClassId+"?";this.$refs.myTable.currentPageIndex,this.$refs.myTable.pagesize,this.$refs.myTable.tableSearchFields;for(var e in t+="filename=学生签到统计"+(new Date).format("yyyy-MM-dd")+"&",this.searchOptions)t+=e+"="+this.searchOptions[e]+"&";for(var a in this.params)t+=a+"="+this.searchOptions[a]+"&";for(var s in this.pageParams)t+=s+"="+this.searchOptions[s]+"&";t=t.substring(0,t.length-1),window.location.href=t},initStudentTable:function(){this.studentColumns=[{id:"name",title:"姓名",className:"text-left",hidden:!1},{id:"userNo",title:"学号",className:"text-left",hidden:!1},{id:"college",title:"学院",className:"text-left",hidden:!0,search:{type:"select",data:{options:this.$parent.selectOptions.college,optionsLabel:"name",optionsValue:"code"}},formatter:function(t){return t.collegeName}},{id:"educationLevel",title:"培养层次",className:"text-left",hidden:!0,search:{type:"select",data:{options:this.$parent.selectOptions.educationLevel,optionsLabel:"label",optionsValue:"value"}}},{id:"grade",title:"年级",className:"text-left",hidden:!0,search:{type:"select",data:{options:this.$parent.selectOptions.grade,optionsLabel:"label",optionsValue:"value"}}},{id:"department",title:"系别",className:"text-left",hidden:!0,search:{type:"select",data:{url:"/api/ca/unit/department/options",optionsLabel:"name",optionsValue:"code"}}},{id:"classId",title:"行政班级",className:"text-left",hidden:!1,search:{type:"select",data:{options:this.$parent.selectOptions.classId,optionsLabel:"text",optionsValue:"id"}},formatter:function(t){return t.className}},{id:"rateOfAttendance",title:"出勤率",className:"text-center",hidden:!1,sorting:!0,sortType:"",search:{type:"numberArea"}},{id:"rateOfAskForLeave",title:"请假率",className:"text-center",hidden:!1,sorting:!0,sortType:"",search:{type:"numberArea"}},{id:"rateOfaAbsent",title:"缺勤率",className:"text-center",hidden:!1,sorting:!0,sortType:"",search:{type:"numberArea"}}]},getClassTabList:function(){var t=this,e="api/ca/person/classes/"+this.recordDetail.courseId;Object(s.d)(e).then(function(e){e.state?(t.classTabList=e.data,t.classTabList.length?t.courseClassId=t.classTabList[0].id:$toast("没有课程班级你想看什么?")):t.$toast(e.message)})},afterSelectDateStart:function(){},afterSelectDateEnd:function(){},back:function(){this.$parent.curRoute="allStaff"},selectTab:function(t){if("1"===t)this.getLineData();else if("2"===t)this.getBarData();else if("3"===t)this.getPanelData();else if("4"===t)return void(this.curRoute="student");this.curTab=t},selectStudentTab:function(t){"5"===t?(this.curRoute="chart",this.selectTab(this.curTab)):"6"===t&&this.exportData()},getLineData:function(){var t=this,e="api/ca/course/statistic/courseClass/"+this.courseClassId+"/everySignIn?dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0];Object(s.d)(e).then(function(e){if(e.state&&e.data){var a=[],s=[],i=[],r=e.data.map(function(t){return a.push(t.rateOfAttendance),s.push(t.rateOfAskForLeave),i.push(t.rateOfaAbsent),t.name}),n=[{name:"出勤",type:"line",data:a},{name:"请假",type:"line",data:s},{name:"缺勤",type:"line",data:i}];t.initLineChart(r,n)}else t.$toast(e.message)})},getPanelData:function(){var t=this,e="api/ca/course/statistic/everyCourseClass/"+this.recordDetail.courseId+"?dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0];Object(s.d)(e).then(function(e){if(e.state&&e.data){var a=[{name:"出勤",type:"bar",stack:"总量",barCategoryGap:15,label:{normal:{show:!0,position:"insideRight",formatter:function(t){return 0==t.value?"":t.value}}},data:[]},{name:"请假",type:"bar",stack:"总量",label:{normal:{show:!1,position:"insideRight"}},data:[]},{name:"缺勤",type:"bar",stack:"总量",label:{normal:{show:!1,position:"insideRight"}},data:[]}];t.panelChartHeight=82+33*e.data.length;var s=e.data.map(function(e){return a[0].data.push(t.paserIntOneLittleNum(e.rateOfAttendance)),a[1].data.push(t.paserIntOneLittleNum(e.rateOfAskForLeave)),a[2].data.push(t.paserIntOneLittleNum(e.rateOfaAbsent)),e.name});t.initPanelChart(s,a)}else t.$toast(e.message)})},getBarData:function(){var t=this,e="api/ca/course/statistic/courseClass/single/doubleDate/"+this.courseClassId+"?dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0],a="api/ca/course/statistic/courseClass/single/doubleDate/"+this.courseClassId+"?dateStart="+this.searchOptions.dateStart2.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd2.split(" ")[0],i={rateOfAttendance:0,rateOfAskForLeave:0,rateOfaAbsent:0},r={rateOfAttendance:0,rateOfAskForLeave:0,rateOfaAbsent:0};Object(s.d)(e).then(function(e){e.state&&e.data&&(i=e.data,Object(s.d)(a).then(function(e){if(e.state&&e.data){r=e.data;var a=[["product","出勤率","请假率","缺勤率"],[t.searchOptions.dateStart.split(" ")[0]+"至"+t.searchOptions.dateEnd.split(" ")[0],i.rateOfAttendance,i.rateOfAskForLeave,i.rateOfaAbsent],[t.searchOptions.dateStart2.split(" ")[0]+"至"+t.searchOptions.dateEnd2.split(" ")[0],r.rateOfAttendance,r.rateOfAskForLeave,r.rateOfaAbsent]];t.initBarChart(a)}}))})},paserIntOneLittleNum:function(t){return parseInt((10*t).toString().split(".")[0])/10},initBarChart:function(t){this.myBarChart=o.a.init(this.$refs.bar),this.barOptionData={legend:{y:"bottom"},tooltip:{formatter:function(t){return t.value[t.seriesIndex+1]+"%"}},dataset:{source:t},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],xAxis:{axisTick:{show:!1},type:"category"},yAxis:{axisTick:{show:!1}},series:[{type:"bar"},{type:"bar"},{type:"bar"}]},this.myBarChart.setOption(this.barOptionData)},initLineChart:function(t,e){this.lineChart=o.a.init(this.$refs.line),this.lineOptionData={title:{text:""},legend:{data:["出勤","请假","缺勤"]},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],tooltip:{trigger:"axis",formatter:function(t){var e="";return t.forEach(function(t){e+=t.marker+t.seriesName+":"+t.data+"%</br>"}),e}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisTick:{show:!1},data:t},yAxis:{axisTick:{show:!1},type:"value"},series:e},this.lineChart.setOption(this.lineOptionData)},initPanelChart:function(t,e){this.myPanelChart=o.a.init(this.$refs.chartPanel),this.panelOptionData={title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){var e=t[0].name+"<br/>";return t.map(function(t){e+=t.seriesName+":"+t.data+"%<br/>"}),e}},legend:{y:"10",data:["出勤","请假","缺勤"]},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{position:"top",type:"value",axisTick:{show:!1},axisLabel:{formatter:"{value} %"}},yAxis:{type:"category",inverse:!0,axisTick:{show:!1},data:t},series:e},this.myPanelChart.setOption(this.panelOptionData),this.myPanelChart.resize({height:this.panelChartHeight})}},components:{radiobox:u.a}}),v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a",{staticClass:"box_flex align_center back_wrap",attrs:{type:"button"},on:{click:function(e){return t.back()}}},[a("i",{staticClass:"maticon back-icon-btn",domProps:{innerHTML:t._s(t.icons("arrow_back"))}},[t._v("arrow_back")]),a("span",{staticClass:"nav-title"},[t._v("返回")])]),t._v(" "),a("div",{staticClass:"chart_page",attrs:{id:"courseChart-page"}},[a("div",{staticClass:"box_flex",staticStyle:{padding:"10px 0 0"}},[a("div",{staticClass:"name"},[t._v(t._s(t.detail.courseName))]),t._v(" "),a("div",{staticClass:"userNum"},[t._v(t._s(t.detail.teacherName))])]),t._v(" "),a("div",{staticClass:"tab-div"},t._l(t.classTabList,function(e,s){return a("div",{key:s,staticClass:"tab",class:t.courseClassId===e.id?"active":"",attrs:{title:e.className},on:{click:function(a){t.courseClassId=e.id}}},[t._v(t._s(e.className))])}),0),t._v(" "),"chart"===t.curRoute?a("div",{staticClass:"main_wrap"},[a("div",{staticClass:"box_flex box_between"},[a("div",{staticClass:"flex"},[a("div",{staticClass:"box_flex flex_center date_picker_wrap"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateArea,callback:function(e){t.dateArea=e},expression:"dateArea"}})],1),t._v(" "),"2"===t.curTab?a("div",{staticClass:"box_flex flex_center date_picker_wrap"},[a("div",{staticStyle:{width:"100px","text-align":"center"}},[t._v("对比")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateArea2,callback:function(e){t.dateArea2=e},expression:"dateArea2"}})],1):t._e()]),t._v(" "),a("div",{staticClass:"btn-tab"},t._l(t.tabList,function(e,s){return a("button",{key:s,staticClass:"btn clearBtnBorder submit-btn",class:t.curTab===e.id?"btn-bgColor-style":"",attrs:{title:e.name},on:{click:function(a){return t.selectTab(e.id)}}},[t._v(t._s(e.name))])}),0)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"1"===t.curTab,expression:"curTab==='1'"}],staticClass:"box_flex flex_center chart_wrap"},[a("div",{ref:"line",staticClass:"chart",staticStyle:{width:"100%"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"2"===t.curTab,expression:"curTab==='2'"}],staticClass:"box_flex flex_center chart_wrap"},[a("div",{ref:"bar",staticClass:"chart",staticStyle:{width:"100%"}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"3"===t.curTab,expression:"curTab==='3'"}],staticClass:"box_flex flex_center chart_wrap radiobox_wrap"},[a("div",{ref:"chartPanel",staticClass:"chart",staticStyle:{"overflow-y":"auto",width:"800px"}})])]):a("div",[a("v-table",{ref:"myTable",attrs:{url:t.studentTableUrl,pagesize:"10",idField:"id",search:!1,columnsControl:!0,order:!0,columns:t.studentColumns}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-right"},t._l(t.sutdentTabList,function(e,s){return a("button",{key:s,staticClass:"btn clearBtnBorder btn-bgColor-style",attrs:{title:e.name},on:{click:function(a){return t.selectStudentTab(e.id)}}},[t._v(t._s(e.name))])}),0)])])],1)])])},staticRenderFns:[]};var y=a("C7Lr")(m,v,!1,function(t){a("slTX")},"data-v-08b20487",null).exports,g={mixins:[l],created:function(){for(var t in this.queryData=this.$route.query,this.selectOptions)this.getSelectOptions(t)},data:function(){return{queryData:{},title:"学生考勤情况统计",url:"",columns:[],yearOptions:[],recordDetail:{},showMore:!1,yearValue:"",termsOptions:[],curbatchId:"",curRoute:"allStaff",selectOptions:{grade:[],educationLevel:[],college:[],classId:[]},searchOptions:{grade:"",educationLevel:"",college:"",classId:"",dateStart:"",dateEnd:""},showModal:!1}},watch:{yearValue:function(t){this.termsOptions=this.yearOptions.filter(function(e){return e.value===t})[0].terms,this.curbatchId=this.termsOptions[0].value,this.searchOptions.dateStart||(this.dateArea=[this.termsOptions[0].dateStart,this.termsOptions[0].dateEnd])},curbatchId:function(t){this.computedUrl()},searchOptions:{handler:function(t){var e=this;this.setTimeoutFun&&clearTimeout(this.setTimeoutFun),this.setTimeoutFun=setTimeout(function(){e.computedUrl(),e.showModal&&e.getPanelData()},200)},deep:!0}},methods:{exportData:function(){var t="/downloads/ca/student/statistic/excel/"+this.curbatchId+"?";this.$refs.myTable.currentPageIndex,this.$refs.myTable.pagesize,this.$refs.myTable.tableSearchFields;for(var e in this.queryData.isClass?(t="/downloads/ca/class/statistic/excel/"+this.curbatchId+"?",this.title="班级考勤情况统计"):this.queryData.isCourse?(t="/downloads/ca/course/statistic/excel/"+this.curbatchId+"?",this.title="课程考勤情况统计"):this.queryData.isCourse&&(t="/downloads/ca/college/statistic/excel/"+this.curbatchId+"?",this.title="学院考勤情况统计"),t+="filename="+this.title+(new Date).format("yyyy-MM-dd")+"&",this.searchOptions)t+=e+"="+this.searchOptions[e]+"&";for(var a in this.params)t+=a+"="+this.searchOptions[a]+"&";for(var s in this.pageParams)t+=s+"="+this.searchOptions[s]+"&";t=t.substring(0,t.length-1),window.location.href=t},afterSelectDateStart:function(){},showCollegeChart:function(){this.getPanelData(),this.showModal=!0},showMoreRecord:function(){this.showMore=!this.showMore,this.getPanelData()},getPanelData:function(){var t=this,e="api/ca/college/statistic/everyCollege/all?dateStart="+this.searchOptions.dateStart.split(" ")[0]+"&dateEnd="+this.searchOptions.dateEnd.split(" ")[0];Object(s.d)(e).then(function(e){if(e.state&&e.data){var a=[{name:"出勤",type:"bar",stack:"总量",barCategoryGap:15,label:{normal:{show:!0,position:"insideRight",formatter:function(t){return 0==t.value?"":t.value}}},data:[]},{name:"请假",type:"bar",stack:"总量",label:{normal:{show:!1,position:"insideRight"}},data:[]},{name:"缺勤",type:"bar",stack:"总量",label:{normal:{show:!1,position:"insideRight"}},data:[]}];t.showMore||(e.data=e.data.filter(function(t,e){return e<10})),t.panelChartHeight=82+33*e.data.length;var s=e.data.map(function(e){return a[0].data.push(t.paserIntOneLittleNum(e.rateOfAttendance)),a[1].data.push(t.paserIntOneLittleNum(e.rateOfAskForLeave)),a[2].data.push(t.paserIntOneLittleNum(e.rateOfaAbsent)),e.name});t.initPanelChart(s,a)}else t.$toast(e.message)})},paserRateToOneLittleNum:function(t){if(-1!==t.indexOf("%")){var e=parseFloat(t.replace("%","")),a=parseInt((10*e).toString().split(".")[0])/10;return-1===a.toString().indexOf(".")&&(a+=".0"),a+"%"}return t},paserIntOneLittleNum:function(t){if(t){var e=10*t;return parseInt(e.toString().split(".")[0])/10}return t},initPanelChart:function(t,e){this.myPanelChart=o.a.init(this.$refs.chartPanel),this.panelOptionData={title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){var e=t[0].name+"<br/>";return t.map(function(t){e+=t.seriesName+":"+t.data+"%<br/>"}),e}},legend:{data:["出勤","请假","缺勤"]},color:["#69CDF9","#FFDB5C","#FF7E9D","#A0E6B7"],grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{position:"top",type:"value",axisTick:{show:!1},axisLabel:{formatter:"{value} %"}},yAxis:{type:"category",axisTick:{show:!1},inverse:!0,data:t},series:e},this.myPanelChart.setOption(this.panelOptionData),this.myPanelChart.resize({height:this.panelChartHeight})},afterSelectDateEnd:function(){},showDetail:function(t){this.recordDetail=t,this.queryData.isPerson?this.curRoute="studentDetail":this.queryData.isClass?this.curRoute="classDetail":this.queryData.isCourse&&(this.curRoute="courseDetail")},computedUrl:function(){var t="/table-data/ca/student/statistic/page/"+this.curbatchId+"?";for(var e in this.queryData.isClass?t="/table-data/ca/class/statistic/page/"+this.curbatchId+"?":this.queryData.isCourse?t="/table-data/ca/course/statistic/page/"+this.curbatchId+"?":this.queryData.isCollege&&(t="/table-data/ca/college/statistic/page/"+this.curbatchId+"?"),this.searchOptions)t+="dateStart"===e?e+"="+this.searchOptions[e].split(" ")[0]+"&":"dateEnd"===e?e+"="+this.searchOptions[e].split(" ")[0]+"&":e+"="+this.searchOptions[e]+"&";this.url=t.substring(0,t.length-1)},getSelectOptions:function(t){var e=this,a="";if("college"===t)a="/api/colleges";else if("classId"===t)a="/api/relClass/classes/list";else{if("grade"===t){for(var i=(new Date).getFullYear(),r=[],n=0;n<10;n++)r.push({label:i-n+"",value:i-n+""});return void(this.selectOptions[t]=r)}"educationLevel"===t&&(a="api/ca/dict?typeName=培养层次")}Object(s.d)(a).then(function(a){e.selectOptions[t]=a.data,e.selectOptions.classId&&!e.hadInit&&(e.hadInit=!0,e.getYearList())})},initCollegeTable:function(){var t=this;this.columns=[{id:"college",title:"学院",className:"text-left",hidden:!1,search:{type:"select",data:{options:t.selectOptions.college,optionsLabel:"name",optionsValue:"code"}},formatter:function(t){return t.collegeName}},{id:"rateOfAttendance",title:"出勤率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfAttendance)}},{id:"rateOfAskForLeave",title:"请假率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfAskForLeave)}},{id:"rateOfaAbsent",title:"缺勤率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfaAbsent)}}]},initStudentTable:function(){var t=this;this.columns=[{id:"name",title:"姓名",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:""}}},{id:"userNo",title:"学号",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:""}}},{id:"classId",title:"行政班级",className:"text-left",hidden:!1,search:{type:"select",data:{options:t.selectOptions.classId,optionsLabel:"text",optionsValue:"id"}},formatter:function(t){return t.className}},{id:"educationLevel",title:"培养层次",className:"text-left",hidden:!0,search:{type:"select",data:{options:t.selectOptions.educationLevel,optionsLabel:"label",optionsValue:"value"}}},{id:"grade",title:"年级",className:"text-left",hidden:!0,search:{type:"select",data:{options:t.selectOptions.grade,optionsLabel:"label",optionsValue:"value"}}},{id:"department",title:"系别",className:"text-left",hidden:!0,search:{type:"select",data:{url:"/api/ca/unit/department/options",optionsLabel:"name",optionsValue:"code"}}},{id:"rateOfAttendance",title:"出勤率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfAttendance)}},{id:"rateOfAskForLeave",title:"请假率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfAskForLeave)}},{id:"rateOfaAbsent",title:"缺勤率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfaAbsent)}},{id:"opt",title:"操作",className:"text-center",width:"230px",formatter:function(e){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.showDetail(e)}}]}}]},initClassTable:function(){var t=this;this.columns=[{id:"college",title:"学院",className:"text-left",hidden:!1,search:{type:"select",data:{options:t.selectOptions.college,optionsLabel:"name",optionsValue:"code"}}},{id:"grade",title:"年级",className:"text-left",hidden:!1,search:{type:"select",data:{options:t.selectOptions.grade,optionsLabel:"label",optionsValue:"value"}}},{id:"classId",title:"行政班级",className:"text-left",hidden:!1,search:{type:"select",data:{options:t.selectOptions.classId,optionsLabel:"text",optionsValue:"id"}},formatter:function(t){return t.className}},{id:"instructorId",title:"辅导员",className:"text-left",hidden:!1,search:{type:"select",data:{url:"/api/ca/class/statistic/instructor/options",optionsLabel:"label",optionsValue:"value"}},formatter:function(t){return t.instructor}},{id:"rateOfAttendance",title:"出勤率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfAttendance)}},{id:"rateOfAskForLeave",title:"请假率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfAskForLeave)}},{id:"rateOfaAbsent",title:"缺勤率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfaAbsent)}},{id:"opt",title:"操作",className:"text-center",width:"230px",formatter:function(e){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.showDetail(e)}}]}}]},initCourseTable:function(){var t=this;this.columns=[{id:"courseName",title:"课程名称",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:""}}},{id:"teacherId",title:"任课教师学工号",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:""}}},{id:"teacherName",title:"任课教师",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:""}}},{id:"rateOfAttendance",title:"出勤率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfAttendance)}},{id:"rateOfAskForLeave",title:"请假率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfAskForLeave)}},{id:"rateOfaAbsent",title:"缺勤率",className:"text-left",hidden:!1,sorting:!0,sortType:"",width:130,search:{type:"numberArea"},formatter:function(e){return t.paserRateToOneLittleNum(e.rateOfaAbsent)}},{id:"signInCount",title:"已创建签到次数",className:"text-center",hidden:!1,sorting:!0,sortType:"",width:220,search:{type:"numberArea"}},{id:"opt",title:"操作",className:"text-center",width:"230px",formatter:function(e){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.showDetail(e)}}]}}]},getYearList:function(){var t=this;Object(s.d)("api/ca/courses/options/schoolYears").then(function(e){e.state&&(t.yearOptions=e.data,e.data.forEach(function(e){e.terms.forEach(function(a){new Date(a.dateEnd)>new Date&&new Date>new Date(a.dateStart)&&(t.yearValue=e.value)})}),t.queryData.isPerson?t.initStudentTable():t.queryData.isClass?t.initClassTable():t.queryData.isCourse?t.initCourseTable():t.queryData.isCollege&&t.initCollegeTable())})}},components:{recordChart:h,classChart:b,courseChart:y}},O={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return"allStaff"===t.curRoute?a("div",{staticClass:"container-fluid",attrs:{id:"statistics-page"}},[a("div",{staticClass:"row text-center"},[a("v-table",{ref:"myTable",attrs:{url:t.url,pagesize:"10",idField:"id",search:!1,order:!0,columnsControl:!t.queryData.isCollege,columns:t.columns}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left"},[a("v-select",{attrs:{options:t.yearOptions,required:"true",optionsLabel:"label",optionsValue:"value"},on:{afterSelected:t.changeYear},model:{value:t.yearValue,callback:function(e){t.yearValue=e},expression:"yearValue"}}),t._v(" "),a("v-select",{staticStyle:{"margin-left":"15px"},attrs:{options:t.termsOptions,required:"true",optionsLabel:"label",optionsValue:"value"},model:{value:t.curbatchId,callback:function(e){t.curbatchId=e},expression:"curbatchId"}}),t._v(" "),a("div",{staticClass:"box_flex flex_center date_picker_wrap"},[a("div",{staticClass:"text",staticStyle:{width:"207px"}},[t._v("考勤范围：")]),t._v(" "),a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",clearable:!1,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateArea,callback:function(e){t.dateArea=e},expression:"dateArea"}})],1)],1),t._v(" "),a("div",{staticClass:"btn-group pull-right"},[t.queryData.isCollege?a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(e){return t.showCollegeChart()}}},[t._v("查看图表")]):t._e(),t._v(" "),a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:t.exportData}},[t._v("导出")])])])])],1),t._v(" "),a("div",{staticClass:"row table_title"},[a("div",{staticClass:"gray"},[t._v(t._s(t.title)+",本页数据截止至前一天")])]),t._v(" "),a("v-modal",{attrs:{show:t.showModal,effect:"fade",width:"720"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        学院考勤情况\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body college_chart_wrap",staticStyle:{"min-height":"300px"},attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"box_flex flex_center date_picker_wrap"},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",clearable:!1,type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.dateArea,callback:function(e){t.dateArea=e},expression:"dateArea"}})],1),t._v(" "),t.showMore?a("button",{staticClass:"btn submit-btn",on:{click:function(e){return t.showMoreRecord()}}},[t._v("收起")]):a("button",{staticClass:"btn submit-btn",on:{click:function(e){return t.showMoreRecord()}}},[t._v("更多")]),t._v(" "),a("div",{staticClass:"box_flex flex_center "},[a("div",{ref:"chartPanel",staticClass:"chart",staticStyle:{"overflow-y":"auto",width:"700px"}})])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showModal=!1}}},[t._v("取消")])])])],1):"studentDetail"===t.curRoute?a("div",{staticClass:"chart_wrap"},[a("recordChart",{attrs:{options:t.searchOptions,dataRange:t.dateArea,detail:t.recordDetail}})],1):"classDetail"===t.curRoute?a("div",{staticClass:"chart_wrap"},[a("classChart",{attrs:{options:t.searchOptions,dataRange:t.dateArea,detail:t.recordDetail}})],1):"courseDetail"===t.curRoute?a("div",{staticClass:"chart_wrap"},[a("courseChart",{attrs:{options:t.searchOptions,dataRange:t.dateArea,detail:t.recordDetail}})],1):t._e()},staticRenderFns:[]};var x=a("C7Lr")(g,O,!1,function(t){a("oEok")},null,null);e.default=x.exports},f8iV:function(t,e){},"lt9+":function(t,e){},oEok:function(t,e){},slTX:function(t,e){}});