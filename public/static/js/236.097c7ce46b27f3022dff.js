webpackJsonp([236],{"1MSK":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("HzJ8"),s=a.n(i),o=a("C331"),l={data:function(){return{viewText:"岗位视图",isSalaryGrantManage:!1,salaryGrantManageUrl:"/table-data/pwps/salaries/page/byUser",jobViewUrl:"/table-data/pwps/salaries/page/byPosition",peopleViewUrl:"/table-data/pwps/salaries/page/byUser",downloadUrl:"/pwps/users/template/grantResult",checkTemplateUrl:"/pwps/users/salary/grantResults/excel",salaryGrantManageColumns:[],isNeedModal:"",importParams:{parentPageTitle:"",downloadErrorTemplateUrl:"",templateName:"",importBtnType:null},salaryPeopleExport:{show:!1,fields:[{id:"schoolYear",text:"学年",selected:!0},{id:"month",text:"月份",selected:!0},{id:"unitId",text:"单位名称",selected:!0},{id:"positionName",text:"岗位名称",selected:!0},{id:"positionType",text:"岗位类型",selected:!1},{id:"rewardStandard",text:"薪酬标准(元/小时)",selected:!1},{id:"salaryCapMonth",text:"薪酬上限",selected:!1},{id:"name",text:"姓名",selected:!0},{id:"userNo",text:"学号",selected:!0},{id:"collegeName",text:"学院",selected:!1},{id:"educationLevel",text:"培养层次",selected:!1},{id:"idCardNo",text:"身份证号",selected:!1},{id:"contact",text:"手机",selected:!1},{id:"isDifficultyStudent",text:"是否困难生",selected:!1},{id:"nation",text:"民族",selected:!1},{id:"sex",text:"性别",selected:!1},{id:"manHour",text:"工时",selected:!1},{id:"totalPayMount",text:"应发金额",selected:!0},{id:"realPayMount",text:"实发金额",selected:!0},{id:"isGrant",text:"发放状态",selected:!0},{id:"remark",text:"备注",selected:!0}]},isJobView:!1,isImport:!1,positionTypeData:[],timeStamp:""}},methods:{changeView:function(){this.isJobView=!this.isJobView,this.isJobView?(this.viewText="人员视图",this.salaryGrantManageColumns=this.jobViewColumns,this.salaryGrantManageUrl=this.jobViewUrl):(this.viewText="岗位视图",this.salaryGrantManageColumns=this.peopleViewColumns,this.salaryGrantManageUrl=this.peopleViewUrl)},importGrantResult:function(){var t=this;this.isImport=!0,this.isNeedModal=!1,this.importParams={parentPageTitle:"薪酬发放管理列表",downloadErrorTemplateUrl:"/pwps/users/excel/error/grantResult",templateName:"薪酬发放结果导入",needData:"薪酬发放结果导入(包含当前页面数据)"},this.importParams.importBtnType=[{url:"/pwps/users/salary/grantResults",method:"post",isShowBtn:!0,name:"覆盖导入",success:function(e){e.state&&(t.salaryGrantManageUrl="/table-data/pwps/salaries/page/byUser?timestamp="+Object(o.a)())}}]},showSalaryExport:function(){this.salaryPeopleExport.show=!0},_exportSalary:function(){var t=this.$refs.gruntTable.tableSearchFields,e="";for(var a in t)t[a]?e+="&"+a+"="+t[a]:e+="&"+a+"=";var i=[],o=!0,l=!1,r=void 0;try{for(var n,d=s()(this.salaryPeopleExport.fields);!(o=(n=d.next()).done);o=!0){var c=n.value;c.selected&&i.push(c.id)}}catch(t){l=!0,r=t}finally{try{!o&&d.return&&d.return()}finally{if(l)throw r}}e+="&exportFields="+i.join(","),window.location.href="/downloads/pwps/salaries/excel?detail=true&isImport=true&fileName=薪酬发放"+e}},created:function(){var t=this;Object(o.e)({url:"/api/system/dicts",dataType:"json",type:"get",data:{dictType:"岗位类型"},success:function(e){e.state?t.positionTypeData=e.data:t.$toast(e.message)}}),this.jobViewColumns=[{id:"schoolYear",title:"学年",className:"text-left",hidden:!1,width:110,search:{type:"select",data:{url:"/api/pwps/positions/all/schoolYears",optionsLabel:"name",optionsValue:"id"}},formatter:function(t){return t.position&&t.position.schoolYear&&t.position.schoolYear.name}},{id:"month",title:"月份",className:"text-left",width:70,hidden:!1,search:{type:"input",data:{placeholer:"",autoFocus:!0}}},{id:"unitId",title:"单位名称",className:"text-left",width:130,hidden:!1,formatter:function(t){return t.position&&t.position.unit&&t.position.unit.name},search:{type:"select",data:{url:"/api/pwps/units/all",optionsLabel:"name",optionsValue:"id"}}},{id:"positionName",title:"岗位名称",className:"text-left",width:150,hidden:!1,formatter:function(t){return t.position&&t.position.positionName},search:{type:"input",data:{placeholer:"",autoFocus:!0}}},{id:"positionType",title:"岗位类型",className:"text-left",width:100,hidden:!1,formatter:function(e){if(e.position){var a="";return t.positionTypeData.forEach(function(t,i){t.value===e.position.positionType&&(a=t.label)}),a}},search:{type:"select",data:{url:"/api/system/dicts?dictType=岗位类型",optionsLabel:"label",optionsValue:"value"}}},{id:"grantCount",title:"发放人数",className:"text-left",width:80,hidden:!1},{id:"totalWork",title:"岗位总工时上限",className:"text-left",width:100,hidden:!1,formatter:function(t){return t.position.totalWork}},{id:"realWork",title:"岗位实际总工时",className:"text-left",width:100,hidden:!1,formatter:function(t){return t.position.totalWork&&Number(t.position.realWork)>Number(t.position.totalWork)?'<span style="color: red">'+t.position.realWork+"</span>":t.position.realWork}},{id:"totalPayMount",title:"应发放薪酬",className:"text-left",width:90,hidden:!1},{id:"realPayMount",title:"实际发放薪酬",className:"text-left",width:90,hidden:!1}],this.peopleViewColumns=[{id:"schoolYear",title:"学年",className:"text-left",hidden:!1,width:110,search:{type:"select",data:{url:"/api/pwps/positions/all/schoolYears",optionsLabel:"name",optionsValue:"id"}},formatter:function(t){return t.position&&t.position.schoolYear&&t.position.schoolYear.name}},{id:"month",title:"月份",className:"text-left",width:80,hidden:!1,search:{type:"input"}},{id:"unitId",title:"单位名称",className:"text-left",width:120,hidden:!1,formatter:function(t){return t.position&&t.position.unit&&t.position.unit.name},search:{type:"select",data:{url:"/api/pwps/units/all",optionsLabel:"name",optionsValue:"id"}}},{id:"positionName",title:"岗位名称",className:"text-left",width:120,hidden:!1,formatter:function(t){return t.position&&t.position.positionName},search:{type:"input",data:{placeholer:"",autoFocus:!0}}},{id:"positionType",title:"岗位类型",className:"text-left",width:100,hidden:!0,formatter:function(e){if(e.position){var a="";return t.positionTypeData.forEach(function(t,i){t.value===e.position.positionType&&(a=t.label)}),a}},search:{type:"select",data:{url:"/api/system/dicts?dictType=岗位类型",optionsLabel:"label",optionsValue:"value"}}},{id:"rewardStandard",title:"薪酬标准(元/小时)",className:"text-right",width:120,hidden:!0,formatter:function(t){return t.position&&t.position.rewardStandard}},{id:"salaryCapMonth",title:"薪酬上限",className:"text-right",width:80,hidden:!0,formatter:function(t){return t.position&&t.position.salaryCapMonth}},{id:"name",title:"姓名",className:"text-left",width:100,hidden:!1,formatter:function(t){return t.user&&t.user.name},search:{type:"input",data:{placeholer:"",autoFocus:!0}}},{id:"userNo",title:"学号",className:"text-left",width:130,hidden:!1,formatter:function(t){return t.user&&t.user.userNo},search:{type:"input",data:{placeholer:"",autoFocus:!0}}},{id:"collegeName",title:"学院",className:"text-left",width:80,hidden:!1,formatter:function(t){return t.userDetail&&t.userDetail.collegeName}},{id:"educationLevel",title:"培养层次",className:"text-left",width:80,hidden:!1,formatter:function(t){return t.userDetail&&t.userDetail.educationLevelLabel}},{id:"idCardNo",title:"身份证号",className:"text-left",width:150,hidden:!0,formatter:function(t){return t.userDetail&&t.userDetail.idCardNo}},{id:"contact",title:"联系方式",className:"text-left",width:120,hidden:!0,formatter:function(t){return t.userDetail&&t.userDetail.contact}},{id:"isDifficultyStudent",title:"是否困难生",className:"text-left",width:100,hidden:!0,formatter:function(t){return t.userDetail&&(t.userDetail.isDifficultyStudent?"是":"否")}},{id:"nation",title:"民族",className:"text-left",width:80,hidden:!0,formatter:function(t){return t.userDetail&&t.userDetail.nationLabel}},{id:"sex",title:"性别",className:"text-left",width:40,hidden:!0,formatter:function(t){return t.userDetail&&t.userDetail.sexLabel}},{id:"manHour",title:"工时",className:"text-left",width:60,hidden:!0},{id:"totalPayMount",title:"应发金额",className:"text-left",width:80,hidden:!1},{id:"realPayMount",title:"实发金额",width:80,className:"text-right",hidden:!1},{id:"isGrant",title:"发放状态",className:"text-left",width:100,hidden:!1,search:{type:"select",data:{options:[{value:!0,label:"已发放"},{value:!1,label:"未发放"}],optionsLabel:"label",optionsValue:"value"}},formatter:function(t){return t.isGrant?"已发放":"未发放"}},{id:"remark",title:"备注",width:80,className:"text-left",hidden:!0}],this.salaryGrantManageColumns=this.peopleViewColumns}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.isImport?t.isImport?a("v-import",t._b({attrs:{downloadTemplateUrl:t.downloadUrl,checkTemplateUrl:t.checkTemplateUrl,isNeedModal:t.isNeedModal,modalname:"选择学年"},on:{backParentPage:function(e){t.isImport=!1}}},"v-import",t.importParams,!1),[a("div",{attrs:{slot:"modal"},slot:"modal"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"college-text"},[t._v("学年")]),t._v(" "),a("v-select",{staticClass:"btn-block search-select",attrs:{value:t.importModalSchoolYearDefault,options:t.schoolYearData,optionsLabel:"name",optionsValue:"id",search:"","close-on-select":""},on:{afterSelected:t.importModalSchoolYearSelected}})],1)])]):t._e():a("div",{staticClass:"salary-grant-check"},[a("div",{staticClass:"tab-div"},[a("div",{staticClass:"tab",class:t.isJobView?"":"active",attrs:{title:"人员视图"},on:{click:t.changeView}},[t._v("人员视图")]),t._v(" "),a("div",{staticClass:"tab",class:t.isJobView?"active":"",attrs:{title:"岗位视图"},on:{click:t.changeView}},[t._v("岗位视图")])]),t._v(" "),a("div",[a("v-table",{key:"salary",ref:"gruntTable",attrs:{title:"薪酬发放管理",url:t.salaryGrantManageUrl,pagesize:"10",idField:"id",order:!0,multiple:!1,search:!1,columnsControl:!t.isJobView,columns:t.salaryGrantManageColumns}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-right"},[t.isJobView?t._e():a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:t.importGrantResult}},[t._v("发放结果导入")]),t._v(" "),t.isJobView?t._e():a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:t.showSalaryExport}},[t._v("导出")])])])]),t._v(" "),a("v-modal",{key:"xxx",attrs:{show:t.salaryPeopleExport.show,effect:"fade",width:"400"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("导出——字段选择")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("ul",{staticClass:"list-group"},t._l(t.salaryPeopleExport.fields,function(e,i){return a("li",{key:i,staticClass:"list-group-item field-item",class:e.selected?"active":"",on:{click:function(t){e.selected=!e.selected}}},[e.selected?a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")]),t._v(" "),a("span",[t._v(t._s(e.text))])])}),0)]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.salaryPeopleExport.show=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t._exportSalary}},[t._v("导出")])])])],1)])},staticRenderFns:[]};var n=a("C7Lr")(l,r,!1,function(t){a("jN6E")},null,null);e.default=n.exports},jN6E:function(t,e){}});