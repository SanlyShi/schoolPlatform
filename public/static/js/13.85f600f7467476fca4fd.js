webpackJsonp([13],{AhwL:function(e,t){},YbAi:function(e,t,s){e.exports=s.p+"static/img/background.3a1e18c.png"},vUsG:function(e,t){},vq26:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("C331"),i=s("Gme2"),a=s("8c0Y"),n=s("ZpE2"),r=s.n(n),l=(i.a,a.a,{name:"employmentLogin",components:{EmHeader:i.a,EmUser:a.a},data:function(){return{schoolId:"",ixyLogin:!1,cas:!1,clickIxyLogin:!1,title:{name:"就业管理系统",url:"employmentPlatform"},pageType:2,formLogin:{username:"",password:""},formLoginIxy:{username:"",password:""},roleType:"student",ruleLogin:{username:[{required:!0,message:"请输入帐号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},isBlacklisted:!1,reason:{content:"123",date:"2019.04.22"},disabled:!1,disabled_userId:"",dialogVisible:!1,disabled_reason:{}}},created:function(){var e=this;this.schoolId=this.$route.params.schoolId,Object(o.e)({type:"get",url:"/system/config?sys=employment",success:function(t){t.state?(e.cas=t.data.cas,e.ixyLogin=t.data.ixyLogin):e.$message.error("error")}})},methods:{toRegister:function(){this.$router.push("/employment/register")},toForgetPsd:function(){this.$router.push("/employment/forget")},ixyLoginClick:function(){this.clickIxyLogin=!0},groupChange:function(){this.clickIxyLogin=!1},schoolLogin:function(){window.location.href=this.cas},ixySubmit:function(){var e=this,t=this,s=this.formLoginIxy.username,i=r.a.createHash("md5").update(this.formLoginIxy.password).digest("hex");Object(o.e)({url:"/users/certifications",type:"post",data:{userNo:s,password:i},success:function(e){t.closeWaiting(),e.state?location.href="/employment":t.$toast(e.message)},headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Authorization",Authorization:"schoolId="+t.schoolId}}).always(function(){e.$waiting.close()})},companyLogin_ajax:function(e){var t=this,s=this.formLogin.password;this.disabled=!1,Object(o.e)({type:"post",url:"/employment/certifications/loginCheck",data:{userMail:this.formLogin.username,userPassword:r.a.createHash("md5").update(s).digest("hex"),token:e},success:function(e){if(e.state){if("DISABLED"==e.data.userStatus)return t.disabled=!0,t.disabled_userId=e.data.id,t.$message.error("该账号已被禁用");t.$router.push("/employment/index")}else t.$message.error(e.message)}})},companyLogin:function(){var e=this;this.$refs.formLogin.validate(function(t){if(t)_dx.Captcha(document.getElementById("c1"),{appId:"5c7bafe274b534f13ec3b614135a362e",style:"inline",width:360,success:function(t){e.companyLogin_ajax(t)}});else e.$message.error("账号或密码不能为空")})},checkReason:function(){var e=this,t="/api/employment/blackList/getByMail?userId="+this.disabled_userId;Object(o.e)({url:t,type:"get",success:function(t){t.state&&(e.disabled_reason=t.data,e.dialogVisible=!0)}})},viewReason:function(){this.$createElement;this.$alert('<div style="height: 32px; line-height: 32px;"><span>原因：</span><span style="color: #F36D6D">'+this.reason.content+'</span></div><div style="height: 32px; line-height: 32px;"><span>时间：</span><span>'+this.reason.date+"</span></div>","",{confirmButtonText:"关闭",dangerouslyUseHTMLString:!0})}}}),c={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("div",{staticClass:"header"},[o("em-header",{attrs:{title:e.title}},[o("em-user",{attrs:{slot:"top-nav",pageType:e.pageType},slot:"top-nav"})],1)],1),e._v(" "),o("div",{staticClass:"content"},[o("div",{staticClass:"employment-login",style:{backgroundImage:"url("+s("YbAi")+")"}},[o("div",{staticClass:"login-content"},[o("el-radio-group",{staticClass:"radio-content",on:{change:e.groupChange},model:{value:e.roleType,callback:function(t){e.roleType=t},expression:"roleType"}},[o("el-radio",{attrs:{label:"student"}},[e._v("学生登录")]),e._v(" "),o("el-radio",{attrs:{label:"teacher"}},[e._v("教师登录")]),e._v(" "),o("el-radio",{attrs:{label:"company"}},[e._v("单位登录")])],1),e._v(" "),"student"!==e.roleType&&"teacher"!==e.roleType||e.clickIxyLogin?"company"===e.roleType?o("div",[o("div",{staticClass:"login-form"},[o("el-form",{ref:"formLogin",attrs:{model:e.formLogin,rules:e.ruleLogin}},[o("el-form-item",{attrs:{prop:"username"}},[o("el-input",{attrs:{placeholder:"请输入帐号"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.companyLogin(t)}},model:{value:e.formLogin.username,callback:function(t){e.$set(e.formLogin,"username",t)},expression:"formLogin.username"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.companyLogin(t)}},model:{value:e.formLogin.password,callback:function(t){e.$set(e.formLogin,"password",t)},expression:"formLogin.password"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"link"},[o("div",{staticClass:"link-left"},[o("span",[e._v("还没有单位帐号？去")]),e._v(" "),o("span",{staticClass:"link-btn",on:{click:e.toRegister}},[e._v("注册")])]),e._v(" "),o("div",{staticClass:"link-right"},[o("span",{staticClass:"link-btn",on:{click:e.toForgetPsd}},[e._v("忘记密码？")])])]),e._v(" "),o("div",{attrs:{id:"c1"}}),e._v(" "),o("div",{staticClass:"loginBtn"},[o("el-button",{attrs:{type:"primary"},on:{click:e.companyLogin}},[e._v("登录")])],1),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.disabled,expression:"disabled"}],staticClass:"errorMsg"},[e._v("您已被管理员拉入黑名单,若需申诉,请点击"),o("a",{on:{click:e.checkReason}},[e._v("<查看原因>")])])]):e._e():o("div",[o("div",{staticClass:"uia-btn"},[e.cas?o("el-button",{attrs:{type:"primary",round:""},on:{click:e.schoolLogin}},[e._v("统一身份认证接口")]):e._e(),e._v(" "),e.ixyLogin?o("el-button",{attrs:{type:"primary",round:""},on:{click:e.ixyLoginClick}},[e._v("学生工作平台登录")]):e._e()],1)]),e._v(" "),e.clickIxyLogin&&"company"!==e.roleType?o("div",[o("div",{staticClass:"login-form"},[o("el-form",{ref:"formLogin",attrs:{model:e.formLoginIxy,rules:e.ruleLogin}},[o("el-form-item",{attrs:{prop:"username"}},[o("el-input",{attrs:{placeholder:"请输入帐号"},model:{value:e.formLoginIxy.username,callback:function(t){e.$set(e.formLoginIxy,"username",t)},expression:"formLoginIxy.username"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.formLoginIxy.password,callback:function(t){e.$set(e.formLoginIxy,"password",t)},expression:"formLoginIxy.password"}})],1)],1)],1),e._v(" "),o("div",[o("el-button",{attrs:{type:"primary",round:""},on:{click:e.ixySubmit}},[e._v("登录")])],1)]):e._e()],1)])]),e._v(" "),o("el-dialog",{staticClass:"error_dialog",attrs:{visible:e.dialogVisible,width:"500px",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("p",{staticClass:"errorTips"},[o("span",[e._v("原因:")]),o("i",{attrs:{title:e.disabled_reason.reason}},[e._v(e._s(e.disabled_reason.reason))])]),e._v(" "),o("p",[o("span",[e._v("时间：")]),o("i",[e._v(e._s(e.disabled_reason.createTime))])])])],1)},staticRenderFns:[]};var d=s("C7Lr")(l,c,!1,function(e){s("vUsG"),s("AhwL")},"data-v-156dfc41",null);t.default=d.exports}});