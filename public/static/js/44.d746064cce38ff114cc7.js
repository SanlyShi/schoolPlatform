webpackJsonp([44],{"08P5":function(t,i,e){"use strict";(function(t){var a=e("3cXf"),s=e.n(a),n=e("C331"),o=e("eSLu");i.a={props:{data:{default:""}},components:{ActivityList:o.a},data:function(){return{showOptions:!1,menuOptions:{org:"我的组织",his:"历史活动"},activityListData:[],creatAjax:null,pageIndex:0,pageSize:10,isLoadMoreData:!1,loadingText:!1,showFilter:!1,filterData:{},timer:null,activityStatusList:[{key:"BEFORE_APPLY_START",value:"报名未开始"},{key:"APPLY_ING",value:"报名进行中"},{key:"BEFORE_ACTIVITY_START",value:"活动未开始"},{key:"ACTIVITY_ING",value:"活动进行中"}],pageStatus:{pageOptions:{sort:[{key:"HEAT_SCORE",value:"按热度排序"},{key:"PUBLISH_TIME",value:"按时间排序"}]}},noDataTips:"",isShowBoxShadow:!1,isShowNoMoreDataTips:!1,tabList:[{typeName:"全部",id:0}],currentTabIdx:0}},created:function(){this.initTab(),this._initActivityList({page:this.pageIndex,size:this.pageSize}),this._getActivityTypes(),this._getContentTypes()},methods:{_search:function(t){this.showFilter=!1,"reset"===t&&(this.filterData={}),this.pageIndex=0;var i=JSON.parse(s()(this.filterData));i.size=this.pageSize,i.page=this.pageIndex,this.activityListData=[],this._initActivityList(i)},_checkDetail:function(t){this.$emit("addBread",{route:"/activity/MActivityDetail",title:t.name,data:t})},onItemClick:function(t){this.pageIndex=0,this.currentTabIdx=t,this.filterData={};var i={};i.size=this.pageSize,i.page=this.pageIndex,this.filterData.type_id=[],0!=t&&(i.type_id=this.tabList[t].id,this.filterData.type_id.push(i.type_id)),this.activityListData=[],this._initActivityList(i)},initTab:function(){var t=this;Object(n.e)({url:"/api/sc/activityContentType/selectOptions",type:"get",success:function(i){i.state?i.data&&(t.tabList=i.data):t._toast(i.message)}})},_initActivityList:function(t){var i=this;this.loadingText=!0,this.isLoadMoreData=!1,t.status&&0!=t.status.length||(t.status=["APPLY_ING"]),this.creatAjax=Object(n.e)({url:"/api/sc/activities/pages",type:"get",data:t,success:function(t){t.state?(i.loadingText=!1,t.data.content.length>0?i.noDataTips="":i.noDataTips="暂无相关数据",t.data.content.forEach(function(t){t.isCollect=!1,i.activityListData.push(t)}),t.data.content.length<i.pageSize?(i.isLoadMoreData=!1,i.isShowNoMoreDataTips=!0):(i.isLoadMoreData=!0,i.isShowNoMoreDataTips=!1)):i._toast(t.message)}})},_publishActivity:function(){var t=this;Object(n.e)({url:"/api/sc/organizations/list/join",type:"get",success:function(i){i.state?i.data&&i.data.length>0?t.$emit("addBread",{route:"/activity/MPublishActivity",title:"",data:{publishers:i.data}}):t.$vux.alert.show({title:"您尚未加入任何组织，快去加入吧！"}):t._toast("发布权限检测失败，请稍后重试")}})},_searchActivity:function(){this.$emit("addBread",{route:"/activity/MActivitySearch",title:""})},_filterActivity:function(){this.showFilter=!0},_organizationManagePage:function(){var t=this;Object(n.e)({url:"/api/sc/organizations/list/join-audit",type:"get",success:function(i){i.state?(t.$forceUpdate(),0===i.data.length?t.$emit("addBread",{route:"/organization/MOrganizationSearch",title:""}):t.$emit("addBread",{route:"/organization/MOrganizationManage",title:""})):t._toast(i.message)}})},_history:function(){this.$emit("addBread",{route:"/activity/MActivityHistory",title:""})},_toast:function(t){this.$vux.toast.show({text:t,position:"bottom",type:"text"})},_getActivityTimeStatus:function(t){var i=new Date(t.applyStartTime.replace(/-/g,"/")),e=new Date(t.applyEndTime.replace(/-/g,"/")),a=new Date(t.startTime.replace(/-/g,"/")),s=new Date(t.endTime.replace(/-/g,"/")),n=this.creatAjax.getResponseHeader("Date")?new Date(this.creatAjax.getResponseHeader("Date")):new Date,o=i.getTime()-n.getTime(),c=e.getTime()-n.getTime(),r=a.getTime()-n.getTime(),l=s.getTime()-n.getTime(),u="";return u=o>0?this._getTimeString(o,"报名开始","start"):c>0?this._getTimeString(c,"报名截止","end"):r>0?this._getTimeString(r,"活动开始","start"):l>0?this._getTimeString(l,"活动结束","end"):"活动已结束",t.statusStr=u,u},_getTimeString:function(t,i,e){var a=t/1e3,s=Math.floor(a/86400),n=Math.floor((a-24*s*3600)/3600),o=Math.floor((a-24*s*3600-3600*n)/60);if(0!=s)return"距"+i+"还有 "+s+" 天 ";if(0!=n)return"距"+i+"还有 "+n+" 小时 ";if(0==n&&0!=o)if("start"===e){if("报名开始"===i)return"报名即将开始";if("活动开始"===i)return"活动即将开始"}else{if("报名截止"===i)return"报名即将结束";if("活动结束"===i)return"活动即将结束"}},_getContentTypes:function(){var t=this;Object(n.e)({url:"/api/sc/activityContentType",type:"get",success:function(i){i.state?(t.pageStatus.pageOptions.activityType||t.$set(t.pageStatus.pageOptions,"activityType",[]),i.data&&i.data.forEach(function(i){i.childType&&i.childType.forEach(function(e){var a={key:e.id+"",value:e.typeName,parent:i.id+""};t.pageStatus.pageOptions.activityType.push(a)})})):t._toast(i.message)}})},_getActivityTypes:function(){var t=this;Object(n.e)({url:"/api/sc/activities/types",type:"get",success:function(i){i.state?(t.pageStatus.pageOptions.activityCategory||t.$set(t.pageStatus.pageOptions,"activityCategory",[]),i.data&&i.data.forEach(function(i){var e={key:i.id,value:i.name};t.pageStatus.pageOptions.activityCategory.push(e)})):t._toast(i.message)}})},_menuClick:function(t){"org"==t?this._organizationManagePage():"his"==t&&this._history()}},watch:{filterData:{deep:!0,handler:function(t){}}},mounted:function(){var i=this;this.$pullUpToLoad({container:".activityList-content",down:{height:200,callback:function(){i.pageIndex=0;var t=JSON.parse(s()(i.filterData));t.size=i.pageSize,t.page=i.pageIndex,i.activityListData=[],i._initActivityList(t)}},up:{callback:function(){if(i.isLoadMoreData){i.pageIndex++;var t=JSON.parse(s()(i.filterData));t.size=i.pageSize,t.page=i.pageIndex,i._initActivityList(t)}}}});var e=this;t(".activityList-content").on("scroll",function(){var i=t(this).scrollTop();e.isShowBoxShadow=i>=50})}}}).call(i,e("qqHy"))},ISAO:function(t,i,e){var a={"./icon_heart_choosed_b.png":"qHIn","./icon_heart_default_b.png":"eGZ5"};function s(t){return e(n(t))}function n(t){var i=a[t];if(!(i+1))throw new Error("Cannot find module '"+t+"'.");return i}s.keys=function(){return Object.keys(a)},s.resolve=n,t.exports=s,s.id="ISAO"},cjmt:function(t,i,e){t.exports=e.p+"static/img/pic_err_none@2x.5dcfd4e.png"},crxq:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});e("lDE8");var a=e("08P5"),s={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{attrs:{id:"secondClassRoom"}},[a("view-box",[a("x-header",{staticClass:"activityList-header",style:{"box-shadow":t.isShowBoxShadow?"0 0 4px 0 rgba(0,0,0,0.12), 0 4px 4px 0 rgba(0,0,0,0.12)":"none"},attrs:{title:t.isShowBoxShadow}},[a("x-button",{staticClass:"publish-activity-btn",attrs:{slot:"overwrite-left"},nativeOn:{click:function(i){return t._publishActivity(i)}},slot:"overwrite-left"},[t._v("发起")]),t._v(" "),a("div",{staticClass:"activityList-search",attrs:{slot:"overwrite-title"},on:{click:t._searchActivity},slot:"overwrite-title"},[a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("search"))}},[t._v("search")])]),t._v(" "),a("span",{staticClass:"activityList-header-opt",attrs:{slot:"right"},slot:"right"},[a("i",{staticClass:"maticon filter-icon",domProps:{innerHTML:t._s(t.icons("filter_list"))},on:{click:t._filterActivity}},[t._v("filter_list")]),t._v(" "),a("i",{staticClass:"maticon organization-icon",domProps:{innerHTML:t._s(t.icons("more_vert"))},on:{click:function(i){t.showOptions=!0}}},[t._v("people")]),t._v(" "),t.isShowPoint?a("span",{staticClass:"tips-point"}):t._e()])],1),t._v(" "),a("div",{staticClass:"tab-wrap"},[a("div",{staticClass:"m-tab"},[a("div",{staticClass:"m-tabbar"},t._l(t.tabList,function(i,e){return a("div",{key:e,staticClass:"m-item-wrap",on:{click:function(i){return t.onItemClick(e)}}},[a("div",{staticClass:"m-item",class:{"m-tab-active":t.currentTabIdx==e}},[t._v(t._s(i.typeName))])])}),0)])]),t._v(" "),a("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[a("actionsheet",{attrs:{menus:t.menuOptions,"show-cancel":""},on:{"on-click-menu":t._menuClick},model:{value:t.showOptions,callback:function(i){t.showOptions=i},expression:"showOptions"}})],1),t._v(" "),a("div",{directives:[{name:"transfer-dom",rawName:"v-transfer-dom"}]},[a("popup",{staticClass:"popup-filter",attrs:{height:"100%","is-transparent":""},model:{value:t.showFilter,callback:function(i){t.showFilter=i},expression:"showFilter"}},[a("group",{staticClass:"popup-filter-header"},[a("cell",[a("span",{attrs:{slot:"icon"},on:{click:function(i){t.showFilter=!1}},slot:"icon"},[a("i",{staticClass:"maticon",domProps:{innerHTML:t._s(t.icons("navigate_before"))}})]),t._v(" "),a("p",[a("span",{staticClass:"filter-opt",on:{click:function(i){return t._search("reset")}}},[t._v("还原")]),a("span",{staticClass:"filter-opt sure",on:{click:t._search}},[t._v("确定")])])])],1),t._v(" "),a("div",{staticClass:"popup-filter-body",nativeOn:{click:function(i){t.showFilter=!1}}},[a("group",{staticClass:"filter-group"},[a("radio",{attrs:{title:"title",options:t.pageStatus.pageOptions.sort},model:{value:t.filterData.sort,callback:function(i){t.$set(t.filterData,"sort",i)},expression:"filterData['sort']"}})],1),t._v(" "),a("group",{staticClass:"filter-group"},[a("datetime",{attrs:{title:"活动时间开始时间"},model:{value:t.filterData.startTime,callback:function(i){t.$set(t.filterData,"startTime",i)},expression:"filterData['startTime']"}}),t._v(" "),a("datetime",{attrs:{title:"活动时间结束时间"},model:{value:t.filterData.endTime,callback:function(i){t.$set(t.filterData,"endTime",i)},expression:"filterData['endTime']"}})],1),t._v(" "),a("group",{staticClass:"filter-group"},[a("checklist",{attrs:{options:t.activityStatusList||[]},model:{value:t.filterData.status,callback:function(i){t.$set(t.filterData,"status",i)},expression:"filterData['status']"}})],1),t._v(" "),a("group",{staticClass:"filter-group"},[a("checklist",{attrs:{options:t.pageStatus.pageOptions.activityType||[]},model:{value:t.filterData.content_type_id,callback:function(i){t.$set(t.filterData,"content_type_id",i)},expression:"filterData['content_type_id']"}})],1),t._v(" "),a("group",{staticClass:"filter-group"},[a("checklist",{attrs:{options:t.pageStatus.pageOptions.activityCategory||[]},model:{value:t.filterData.type_id,callback:function(i){t.$set(t.filterData,"type_id",i)},expression:"filterData['type_id']"}})],1)],1)],1)],1),t._v(" "),a("div",{staticClass:"activityList-content",attrs:{id:"listOfActivity"}},[t.activityListData.length>0?a("div",[t._l(t.activityListData,function(i,e){return a("div",{key:e,on:{click:function(e){return t._checkDetail(i)}}},[a("activity-list",{attrs:{activityItem:i,creatAjax:t.creatAjax}})],1)}),t._v(" "),t.loadingText?a("div",{staticClass:"noMoreData"},[t._v("—— 加载中 ——")]):t._e(),t._v(" "),!t.isLoadMoreData&&t.isShowNoMoreDataTips?a("div",{staticClass:"noMoreData"},[t._v("—— 没有更多数据了 ——")]):t._e()],2):t.noDataTips?a("div",{staticClass:"nodataText"},[a("div",{staticClass:"empty"},[a("img",{attrs:{src:e("cjmt"),alt:""}}),t._v(" "),a("p",[t._v("暂无活动")])])]):t._e()])],1)],1)},staticRenderFns:[]};var n=function(t){e("gIy9")},o=e("C7Lr")(a.a,s,!1,n,null,null);i.default=o.exports},eSLu:function(t,i,e){"use strict";var a=e("C331"),s=e("EoEJ"),n=(s.a,{components:{actToast:s.a},props:{activityItem:{default:null},creatAjax:{default:null}},data:function(){return{toast:{show:!1,img:"",title:""},item:null,isCollect:!1,defaultImg:0}},computed:{},watch:{},created:function(){var t=this;this.item=this.activityItem,Object(a.e)({url:"/api/sc/activitySocializations/count/"+this.item.id,type:"get",success:function(i){t.defaultImg=Number(t.item.id)%4+1,i.state?(t.isCollect=i.data.isCollect,t.item.isCollect=t.isCollect):t._toast(i.message)}})},mounted:function(){},methods:{_collect:function(t){var i=this,e="";e=t.isCollect?"/api/sc/activitySocializations/cancelCollection":"/api/sc/activitySocializations/createCollection",Object(a.e)({url:e,type:"post",data:{id:t.id},success:function(e){e.state?(i.toast={show:!0,img:"icon_heart_"+(t.isCollect?"default":"choosed")+"_b",title:t.isCollect?"取消收藏":"收藏成功"},setTimeout(function(){i.toast.show=!1},1e3),t.isCollect=!t.isCollect,i.item.isCollect=t.isCollect):i._toast(e.message)}})},_getActivityTimeStatus:function(t){var i=new Date(t.applyStartTime.replace(/-/g,"/")),e=new Date(t.applyEndTime.replace(/-/g,"/")),a=new Date(t.startTime.replace(/-/g,"/")),s=new Date(t.endTime.replace(/-/g,"/")),n=this.creatAjax.getResponseHeader("Date")?new Date(this.creatAjax.getResponseHeader("Date")):new Date,o=i.getTime()-n.getTime(),c=e.getTime()-n.getTime(),r=a.getTime()-n.getTime(),l=s.getTime()-n.getTime(),u="";return u=o>0?this._getTimeString(o,"报名开始","start"):c>0?this._getTimeString(c,"报名截止","end"):r>0?this._getTimeString(r,"活动开始","start"):l>0?this._getTimeString(l,"活动结束","end"):"活动已结束",t.statusStr=u,u},_getTimeString:function(t,i,e){var a=t/1e3,s=Math.floor(a/86400),n=Math.floor((a-24*s*3600)/3600),o=Math.floor((a-24*s*3600-3600*n)/60);if(0!=s)return"距"+i+"还有 "+s+" 天 "+n+" 小时 ";if(0!=n)return"距"+i+"还有 "+n+" 小时 ";if(0==n&&0!=o)if("start"===e){if("报名开始"===i)return"报名即将开始";if("活动开始"===i)return"活动即将开始"}else{if("报名截止"===i)return"报名即将结束";if("活动结束"===i)return"活动即将结束"}}}}),o={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",[a("div",{staticClass:"activity-positive-card"},[a("div",{staticClass:"collect",on:{click:function(i){return i.stopPropagation(),t._collect(t.item)}}},[a("img",{attrs:{src:e("ISAO")("./icon_heart_"+(t.item.isCollect||t.isCollect?"choosed":"default")+"_b.png"),alt:""}})]),t._v(" "),a("div",{staticClass:"activity-type set-text-right",attrs:{title:""}},[t._v(t._s(t.item.typeName))]),t._v(" "),a("div",{staticClass:"cover-wrap"},[t.item.images.length>0&&t.item.images[0].isCover?a("img",{staticClass:"activity-cover",attrs:{src:t.imageUrlPrefix+t.item.images[0].image+"?thumb=true",container:"#listOfActivity1",alt:""}}):t.defaultImg?a("img",{staticClass:"activity-cover",attrs:{src:e("VhEo")("./pic0"+t.defaultImg+".png"),alt:""}}):t._e(),t._v(" "),a("div",{staticClass:"activity-time"},[t._v(t._s(t._getActivityTimeStatus(t.item)))])]),t._v(" "),a("flexbox",{staticClass:"cnt-wrap",attrs:{orient:"vertical"}},[a("flexbox-item",[a("div",{staticClass:"activity-title",attrs:{title:""}},[t._v(t._s(t.item.name))]),t._v(" "),a("div",{staticClass:"activity-tag"},[t._v(t._s(t.item.contentTypeParentName))])]),t._v(" "),a("flexbox-item",{staticClass:"box_flex"},[t.item.teacherName?a("div",{staticClass:"activity-info mb7"},[a("img",{staticClass:"icon",attrs:{src:e("SLiz"),alt:""}}),t._v(t._s(t.item.teacherName))]):t._e(),t._v(" "),t.item.classTime?a("div",{staticClass:"activity-info mb7"},[a("img",{staticClass:"icon",attrs:{src:e("zPLm"),alt:""}}),t._v(t._s(t.item.classTime))]):t._e()]),t._v(" "),a("flexbox-item",{staticClass:"box_flex mb0"},[t.item.studentOriented&&t.item.studentOriented.length>0?a("div",{staticClass:"activity-info"},[a("img",{staticClass:"icon",attrs:{src:e("ZpGA"),alt:""}}),t._v(t._s(t.item.studentOriented.length>1?t.item.studentOriented[0].name+"等":t.item.studentOriented[0].name))]):t.item.grade&&t.item.grade.length>0?a("div",{staticClass:"activity-info"},[a("img",{staticClass:"icon",attrs:{src:e("ZpGA"),alt:""}}),t._v(t._s(t.item.grade.length>1?t.item.grade[0]+"级等":t.item.grade[0]+"等"))]):a("div",{staticClass:"activity-info"},[a("img",{staticClass:"icon",attrs:{src:e("ZpGA"),alt:""}}),t._v("面向全体")]),t._v(" "),a("div",{staticClass:"activity-info"},[a("img",{staticClass:"icon",attrs:{src:e("FxqL"),alt:""}}),t._v(t._s(t.item.place))])])],1)],1),t._v(" "),t.toast.show?a("act-toast",{attrs:{imgUrl:t.toast.img,title:t.toast.title}}):t._e()],1)},staticRenderFns:[]};var c=e("C7Lr")(n,o,!1,function(t){e("tHGq")},"data-v-cc33faa0",null);i.a=c.exports},gIy9:function(t,i){},lDE8:function(t,i,e){"use strict";(function(t){var i=e("3cXf");e.n(i),e("C331"),e("eSLu").a}).call(i,e("qqHy"))},tHGq:function(t,i){}});