webpackJsonp([176],{"746C":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});e("kV13");var s=e("C331"),o={created:function(){var t=this,a=localStorage.getItem("lang"),e=this;Object(s.g)(a)&&(this.lang=a),this.selectTab(this.tabs.college),this.columns.college=[{id:"name",title:this.translate.college,className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:"搜索学院"}}},{id:"code",title:this.translate.collegeCode,className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:"搜索学院代码"}}},{id:"opt",title:this.translate.opt,className:"text-left",width:"220px",hidden:!1,formatter:function(){return[{tag:"a",text:e.translate.edit,className:"opt-btn",callback:function(t,a){e._showEditModal(t,a)}},{tag:"a",text:e.translate.remove,className:"opt-btn",callback:function(t,a){e._deleteData(t,a)}}]}}],this.columns.dept=[{id:"departmentName",title:"系别名称",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:"搜索系别"}}},{id:"departmentCode",title:"系别代码",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:"搜索系别代码"}}}],this.columns.major=[{id:"majorName",title:"专业名称",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:"搜索专业"}}},{id:"majorCode",title:"专业代码",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:"搜索专业代码"}}},{id:"collegeCode",title:"所属学院",className:"text-left",hidden:!1,search:{type:"select",data:{options:this.collegeList,optionsLabel:"label",optionsValue:"value"}},formatter:function(a,e){var s="";return t.collegeList.map(function(t){t.value==a.collegeCode&&(s=t.label)}),s}},{id:"opt",title:this.translate.opt,className:"text-left",width:"220px",hidden:!1,formatter:function(){return[{tag:"a",text:e.translate.edit,className:"opt-btn",callback:function(t,a){e._showEditModal(t,a)}},{tag:"a",text:e.translate.remove,className:"opt-btn",callback:function(t,a){e._deleteData(t,a)}}]}}],this.importParams.parentPageTitle=this.translate.importTableName},data:function(){return{curTab:"",tabs:{college:"college",dept:"dept",major:"major"},tabsNames:{college:"学院",dept:"系别",major:"专业"},columns:{college:[],dept:[],major:[]},collegeList:[],url:{table:{college:"/table-data/colleges/pages",dept:"/table-data/units/department/pages",major:"/table-data/system/major/pages"},add:{college:"/api/colleges/addOneCollege",dept:"",major:"/api/system/major/addOneMajor"},edit:{college:"",dept:"",major:"/api/system/major/editMajor"},delete:{college:"/api/colleges/deleteCollege",dept:"",major:"/api/system/major/deleteMajor"},export:{college:"/downloads/colleges/exportExcel",dept:"",major:"/downloads/system/major/exportExcel"},downloadTemplateUrl:{college:"/colleges/collegeExcelTemplate",dept:"/colleges/excelTemplates",major:"/system/major/excelTemplates"},checkTemplateUrl:{college:"/colleges/importCollegeExcel",dept:"/colleges/excel",major:"/system/major/importMajorExcel"},import:{college:"/colleges/updateCollegeExcel",dept:"/colleges/updateExcel",major:"/system/major/updateMajorExcel"}},timestamp:"",importParams:{parentPageTitle:"",downloadTemplateUrl:"/colleges/excelTemplates",downloadErrorTemplateUrl:"/colleges/errExcel",checkTemplateUrl:"/colleges/excel",templateName:"学院导入模板.xlsx",importBtnType:null},addParams:{college:{name:"",code:""},dept:{name:"",code:""},major:{majorName:"",majorCode:"",collegeCode:""}},paramsName:{college:{name:"name",code:"code"},dept:{name:"name",code:"code"},major:{name:"majorName",code:"majorCode",collegeCode:"collegeCode"}},errorMsg:{name:"",code:""},modalType:"add",showAddModal:!1,showEditModal:!1,showBatchSetModal:!1,options:[],college:{},newCollege:{userIdErrorMsg:"",userName:"",nameErrorMsg:""},isDisabled:{add:!0,batchSet:!0},showErrorMsg:!1,checkResult:"",isParentPage:!0,lang:"zh-cn"}},computed:{translate:function(){return Object(s.g)(this.lang).collegeManage}},methods:{afterSelected:function(t){},blurName:function(){this.addParams[this.curTab][this.paramsName[this.curTab].name]?this.errorMsg.name="":this.errorMsg.name="请输入"+this.tabsNames[this.curTab]+"名称"},blurCode:function(){this.addParams[this.curTab][this.paramsName[this.curTab].code]?this.errorMsg.code="":this.errorMsg.code="请输入"+this.tabsNames[this.curTab]+"代码"},importCollege:function(){var t=this;this.isParentPage=!1,this.showAddModal=!1,this.importParams.checkTemplateUrl=this.url.checkTemplateUrl[this.curTab],this.importParams.downloadTemplateUrl=this.url.downloadTemplateUrl[this.curTab],this.importParams.templateName=this.tabsNames[this.curTab]+"导入模板.xlsx",this.importParams.importBtnType=[{name:this.translate.incrementImport,url:this.url.import[this.curTab],method:"post",isShowBtn:!0,success:function(a){a.state&&(t.timestamp=(new Date).getTime())}}]},backParentPage:function(){this.isParentPage=!0,this.showAddModal=!1},_showEditModal:function(t,a){this.modalType="edit",this.college=t,this.addParams[this.curTab].id=t.id,this.addParams[this.curTab][this.paramsName[this.curTab].name]=t[this.paramsName[this.curTab].name],this.addParams[this.curTab][this.paramsName[this.curTab].code]=t[this.paramsName[this.curTab].code],"major"==this.curTab&&(this.addParams[this.curTab][this.paramsName[this.curTab].collegeCode]=t[this.paramsName[this.curTab].collegeCode]),this.errorMsg.name="",this.errorMsg.code="",this.showEditModal=!0},_deleteData:function(t,a){var e=this;if(confirm("您确定要删除该"+this.tabsNames[this.curTab])){var o="/api/colleges/"+t.id+"/delete";"major"==this.curTab&&(o="/api/system/major/"+t.id+"/delete"),Object(s.e)({url:o,dataType:"json",type:"post",success:function(t){t.state?(e.timestamp=(new Date).getTime(),e.$toast("删除成功")):e.$toast(t.message)}})}},_showAddModal:function(){this.showEditModal=!0,this.showAddModal=!1,this.addParams[this.curTab].id=null,this.addParams[this.curTab][this.paramsName[this.curTab].name]="",this.addParams[this.curTab][this.paramsName[this.curTab].code]="","major"==this.curTab&&(this.addParams[this.curTab][this.paramsName[this.curTab].collegeCode]=""),this.errorMsg.name="",this.errorMsg.code=""},_export:function(){location.href=this.url.export[this.curTab]},_save:function(){var t=this;if(!this.addParams[t.curTab][t.paramsName[t.curTab].name])return this.errorMsg.name="请输入"+this.tabsNames[this.curTab]+"名称",!1;if(this.errorMsg.name="",!this.addParams[t.curTab][t.paramsName[t.curTab].code])return this.errorMsg.code="请输入"+this.tabsNames[this.curTab]+"代码",!1;this.errorMsg.code="";var a=this.url[this.modalType][this.curTab];"edit"==this.modalType&&"college"==this.curTab?a="/api/"+this.curTab+"s/"+this.addParams[this.curTab].id:"edit"==this.modalType&&"major"==this.curTab&&(a="/api/system/"+this.curTab+"/"+this.addParams[this.curTab].id+"/editMajor"),Object(s.e)({url:a,dataType:"json",data:this.addParams[this.curTab],type:"post",success:function(a){a.state?(t.timestamp=(new Date).getTime(),t.showEditModal=!1,t.$toast("操作成功")):t.$toast(a.message)}})},selectTab:function(t){this.curTab=t;var a=this;"major"==this.curTab&&Object(s.e)({url:"/api/colleges/getAllCollegeCode",dataType:"json",type:"get",success:function(t){t.state?(a.collegeList=t.data,a.columns.major[2].search.data.options=a.collegeList):a.$toast(t.message)}})}}},r={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.isParentPage?e("div",{staticClass:"container-fluid",attrs:{id:"collegeImport-page"}},[e("div",{staticClass:"row",attrs:{id:"tabs-container"}},[e("div",{staticClass:"info-title"},[t._v("学籍信息导入")]),t._v(" "),e("div",{staticClass:"tabs"},t._l([t.tabs.college,t.tabs.dept,t.tabs.major],function(a,s){return e("div",{key:s,staticClass:"tab",class:t.curTab===t.tabs[a]?"active":"",on:{click:function(e){return t.selectTab(t.tabs[a])}}},[t._v("\n        "+t._s(t.tabsNames[a])+"\n      ")])}),0)]),t._v(" "),e("div",{staticClass:"row text-center"},[e("v-table",{attrs:{url:t.url.table[t.curTab]+"?timestamp="+t.timestamp,pagesize:"15",idField:"id",columns:t.columns[t.curTab],multiple:!1,order:!0,search:!0}},[e("div",{staticClass:"table-options-container",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},["dept"!==t.curTab?e("div",{staticClass:"btn-group pull-right"},[e("button",{staticClass:"btn btn-bgColor-style clearBtnBorder ",attrs:{type:"button"},on:{click:function(a){t.showAddModal=!0,t.modalType="add"}}},[t._v("新增")]),t._v(" "),e("button",{staticClass:"btn btn-bgColor-style clearBtnBorder ",attrs:{type:"button"},on:{click:t._export}},[t._v("导出")])]):e("div",{staticClass:"btn-group pull-right"},[e("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:function(a){return t.importCollege()}}},[t._v(t._s(t.translate.import))])])])])],1),t._v(" "),e("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"420"}},[e("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("\n        新增\n      ")])]),t._v(" "),e("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[e("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{width:"380px","text-align":"center"},attrs:{type:"button"},on:{click:t._showAddModal}},[t._v("单条增加")]),t._v(" "),e("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{width:"380px","text-align":"center","margin-top":"20px"},attrs:{type:"button"},on:{click:function(a){return t.importCollege()}}},[t._v("批量导入")])]),t._v(" "),e("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(a){t.showAddModal=!1}}},[t._v("取消")])])]),t._v(" "),e("v-modal",{attrs:{show:t.showEditModal,effect:"fade",width:"420"}},[e("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("\n          "+t._s("add"==t.modalType?"新增":"编辑")+t._s(t.tabsNames[t.curTab])+"\n      ")])]),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{overflow:"inherit"},attrs:{slot:"modal-body"},slot:"modal-body"},[e("div",{staticClass:"form-group box_flex"},[e("div",{staticClass:"label require"},[e("span",[t._v(t._s(t.tabsNames[t.curTab])+"名称:")])]),t._v(" "),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.addParams[t.curTab][t.paramsName[t.curTab].name],expression:"addParams[curTab][paramsName[curTab].name]"}],staticClass:"form-control search-input",attrs:{type:"text",oninput:"value=value.replace(/^ +| +$/g,'')",placeholder:"请输入不重复的"+t.tabsNames[t.curTab]+"名称"},domProps:{value:t.addParams[t.curTab][t.paramsName[t.curTab].name]},on:{blur:t.blurName,input:function(a){a.target.composing||t.$set(t.addParams[t.curTab],t.paramsName[t.curTab].name,a.target.value)}}}),t._v(" "),e("div",{staticClass:"errMsg"},[t._v(t._s(t.errorMsg.name))])])]),t._v(" "),e("div",{staticClass:"form-group box_flex"},[e("div",{staticClass:"label require"},[e("span",[t._v(t._s(t.tabsNames[t.curTab])+"代码:")])]),t._v(" "),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.addParams[t.curTab][t.paramsName[t.curTab].code],expression:"addParams[curTab][paramsName[curTab].code]"}],staticClass:"form-control search-input",attrs:{type:"text",oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"请输入不重复的"+t.tabsNames[t.curTab]+"代码"},domProps:{value:t.addParams[t.curTab][t.paramsName[t.curTab].code]},on:{blur:t.blurCode,input:function(a){a.target.composing||t.$set(t.addParams[t.curTab],t.paramsName[t.curTab].code,a.target.value)}}}),t._v(" "),e("div",{staticClass:"errMsg"},[t._v(t._s(t.errorMsg.code))])])]),t._v(" "),"major"==t.curTab?e("div",{staticClass:"form-group box_flex"},[e("div",{staticClass:"label"},[e("span",[t._v("所属学院:")])]),t._v(" "),e("v-select",{attrs:{options:this.collegeList,"options-value":"value","options-label":"label","close-on-select":"",justify:""},on:{afterSelected:t.afterSelected},model:{value:t.addParams[t.curTab][t.paramsName[t.curTab].collegeCode],callback:function(a){t.$set(t.addParams[t.curTab],t.paramsName[t.curTab].collegeCode,a)},expression:"addParams[curTab][paramsName[curTab].collegeCode]"}})],1):t._e()]),t._v(" "),e("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(a){t.showEditModal=!1}}},[t._v("取消")]),t._v(" "),e("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t._save}},[t._v("保存")])])])],1):e("v-import",t._b({on:{backParentPage:t.backParentPage}},"v-import",t.importParams,!1))},staticRenderFns:[]};var l=e("C7Lr")(o,r,!1,function(t){e("KWdM")},null,null);a.default=l.exports},KWdM:function(t,a){}});