webpackJsonp([66],{"1YRp":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("3cXf"),r=a.n(s),i=(a("kV13"),a("y0ro")),n=a("C331"),o=(i.a,{mixins:[i.a],props:{userInfo:{default:null}},data:function(){return{url:"/table-data/fts/score/getScoreListByUserId?timestamp=",timestamp:new Date,columns:[],lang:"zh-cn",isSelectAll:!1,showExport:!1,fieldsToExport:[],exporting:!1,showAddModal:!1,showAddOneInfoModal:!1,addParams:{userId:null,schoolYear:"",term:"",courseName:"",score:""},require:{schoolYear:"学年",term:"学期",courseName:"课程名称",score:"成绩"},schoolYearList:[],termList:[{label:"1",value:"1"},{label:"2",value:"2"}],modalType:"add"}},created:function(){this.getSchoolYear(),this._initColumns()},mounted:function(){},methods:{_initColumns:function(){var t=this;this.columns=[{id:"schoolYear",title:"学年",className:"text-left",width:120,hidden:!1,search:{type:"select",data:{options:this.schoolYearList,optionsLabel:"label",optionsValue:"value"}}},{id:"term",title:"学期",className:"text-left",width:80,hidden:!1,search:{type:"select",data:{options:this.termList,optionsLabel:"label",optionsValue:"value"}}},{id:"courseName",title:"课程名称",className:"text-left",width:120,hidden:!1,search:{type:"input"}},{id:"score",title:"成绩",className:"text-left",width:100,hidden:!1,search:{type:"input"}},{id:"opt",className:"text-left",title:"操作",width:120,hidden:!1,formatter:function(){return[{tag:"a",text:"编辑",className:"opt-btn",callback:function(e,a){t.modalType="edit";var s=JSON.parse(r()(e));t.addParams.id=s.id,t.addParams.userId=s.userId,t.addParams.term=s.term,t.addParams.courseName=s.courseName,t.addParams.score=s.score,t.addParams.schoolYear=t.schoolYearList.find(function(t){return t.label==e.schoolYear}).value,t.showAddOneInfoModal=!0}},{tag:"a",text:"删除",className:"opt-btn",callback:function(e,a){t.deleteInfo(e.id)}}]}}]},getSchoolYear:function(){var t=this;Object(n.e)({url:"/api/fts/dict/findDictByTypeName?typeName=学年",dataType:"json",type:"get",async:!1,success:function(e){e.state&&(t.schoolYearList=e.data.map(function(t){return{label:t.label,value:t.value}}))}})},back:function(){this.$emit("back")},deleteInfo:function(t){var e=this;confirm("确定删除该学生该科成绩")&&Object(n.e)({url:"/api/fts/score/deleteScoreById?id="+t,dataType:"json",type:"post",async:!1,success:function(t){t.state&&(e.timestamp=(new Date).getTime(),e.$toast("删除成功！"))}})},addInfoByOne:function(){this.showAddOneInfoModal=!0,this.showAddModal=!1,this.addParams={userId:null,schoolYear:"",term:"",courseName:"",score:""}},batchAddInfo:function(){var t=this;this.showExport=!0,this.showAddModal=!1,this.importParams={parentPageTitle:"",downloadTemplateUrl:"/fts/score/template",downloadErrorTemplateUrl:"/fts/score/errorFile",checkTemplateUrl:"/fts/score/checkExcel",templateName:"学生期末成绩导入模板",importBtnType:[{url:"/fts/score/addByExcel",method:"post",isShowBtn:!0,name:"增量导入",success:function(e){t.timestamp=(new Date).getTime(),t.showExport=!1}}]},this.quickAddRecord()},myIsNaN:function(t){return"number"==typeof t&&!isNaN(t)},addOneInfo:function(){var t=this;for(var e in this.addParams.userId=this.userInfo.userId,this.require)if(!this.addParams[e])return void this.$toast(this.require[e]+"不能为空");Object(n.e)({url:"/api/fts/score/"+("add"==this.modalType?"addScore":"updateScore"),dataType:"json",type:"post",data:this.addParams,async:!1,success:function(e){e.state?(t.showAddOneInfoModal=!1,t.timestamp=(new Date).getTime(),t.$toast(("add"==t.modalType?"新增":"编辑")+"成功！")):t.$toast(e.message)}})}}}),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inSchoolInfo container-fluid"},[t.showExport?t._e():a("div",{staticClass:"row text-center"},[a("a",{staticClass:"box_flex align_center back_wrap",attrs:{type:"button"},on:{click:function(e){return t.back()}}},[a("i",{staticClass:"maticon back-icon-btn",domProps:{innerHTML:t._s(t.icons("arrow_back"))}},[t._v("arrow_back")]),a("span",{staticClass:"nav-title"},[t._v("返回")])]),t._v(" "),a("v-table",{ref:"studentTable",attrs:{url:t.url+t.timestamp+"&userId="+t.userInfo.userId,pagesize:"10",idField:"id",columns:t.columns,order:!1,search:!1}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left"},[a("div",{staticClass:"user-info"},[a("span",[t._v(t._s(t.userInfo.name))]),t._v(" "),a("span",[t._v(t._s(t.userInfo.studentId))])])]),t._v(" "),a("div",{staticClass:"btn-group pull-right"},[a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:function(e){t.showAddModal=!0,t.modalType="add"}}},[t._v("新增")])])])])],1),t._v(" "),a("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"420"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        新增\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{width:"380px","text-align":"center"},attrs:{type:"button"},on:{click:t.addInfoByOne}},[t._v("单条增加")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{width:"380px","text-align":"center","margin-top":"20px"},attrs:{type:"button"},on:{click:function(e){return t.batchAddInfo()}}},[t._v("批量导入")])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddModal=!1}}},[t._v("取消")])])]),t._v(" "),a("v-modal",{attrs:{show:t.showAddOneInfoModal,effect:"fade",width:"460"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s("add"==t.modalType?"新增":"编辑")+"\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body container-fluid",staticStyle:{overflow:"inherit"},attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("学年:")])]),t._v(" "),a("v-select",{attrs:{options:t.schoolYearList,"options-value":"value","options-label":"label","close-on-select":"",justify:""},model:{value:t.addParams.schoolYear,callback:function(e){t.$set(t.addParams,"schoolYear",e)},expression:"addParams['schoolYear']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("学期:")])]),t._v(" "),a("v-select",{attrs:{options:t.termList,"options-value":"value","options-label":"label","close-on-select":"",justify:""},model:{value:t.addParams.term,callback:function(e){t.$set(t.addParams,"term",e)},expression:"addParams['term']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("课程名称:")])]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.addParams.courseName,expression:"addParams['courseName']"}],staticClass:"form-control search-input",attrs:{type:"text",placeholder:"请输入课程名称"},domProps:{value:t.addParams.courseName},on:{input:function(e){e.target.composing||t.$set(t.addParams,"courseName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("成绩:")])]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.addParams.score,expression:"addParams['score']"}],staticClass:"form-control search-input",attrs:{type:"text",placeholder:"请输入成绩"},domProps:{value:t.addParams.score},on:{input:function(e){e.target.composing||t.$set(t.addParams,"score",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddOneInfoModal=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.addOneInfo}},[t._v("确定")])])]),t._v(" "),t.showExport?a("div",[a("v-import",t._b({on:{backParentPage:function(e){t.showExport=!1}}},"v-import",t.importParams,!1))],1):t._e()],1)},staticRenderFns:[]};var d=a("C7Lr")(o,l,!1,function(t){a("gpRL")},"data-v-1ec99675",null).exports,c=(i.a,{mixins:[i.a],props:{userInfo:{default:null}},data:function(){return{url:"/table-data/fts/attendance/getAttendanceListByUserId?timestamp=",timestamp:new Date,columns:[],tabbar:[{name:"缺勤记录",type:"ABSENT"},{name:"请假记录",type:"LEAVE"}],currentTab:0,lang:"zh-cn",isSelectAll:!1,showExport:!1,fieldsToExport:[],exporting:!1,showAddModal:!1,showAddOneInfoModal:!1,addParams:{userId:null,schoolYear:"",term:"",courseName:"",happenTime:""},require:{type:"考勤类型",schoolYear:"学年",term:"学期",courseName:"课程名称",happenTime:"时间"},schoolYearList:[],termList:[{label:"1",value:"1"},{label:"2",value:"2"}],modalType:"add"}},created:function(){this.getSchoolYear(),this._initColumns()},mounted:function(){},methods:{selectTab:function(t){this.currentTab=t},_initColumns:function(){var t=this;this.columns=[{id:"schoolYear",title:"学年",className:"text-left",width:120,hidden:!1,search:{type:"select",data:{options:this.schoolYearList,optionsLabel:"label",optionsValue:"value"}}},{id:"term",title:"学期",className:"text-left",width:80,hidden:!1,search:{type:"select",data:{options:this.termList,optionsLabel:"label",optionsValue:"value"}}},{id:"courseName",title:"课程名称",className:"text-left",width:120,hidden:!1,search:{type:"input"}},{id:"happenTime",title:"时间",className:"text-left",width:100,hidden:!1,search:{type:"datetime",data:{dateFormat:"yyyy-MM-dd",change:function(e){e.value,e.target;t.url="/table-data/fts/attendance/getAttendanceListByUserId?happenTimeBegin="+(t.$refs.studentTable.tableSearchFields.happenTime_start?t.$refs.studentTable.tableSearchFields.happenTime_start.substr(0,10):"")+"&happenTimeEnd="+(t.$refs.studentTable.tableSearchFields.happenTime_end?t.$refs.studentTable.tableSearchFields.happenTime_end.substr(0,10):"")+"&timestamp="}}}},{id:"opt",className:"text-left",title:"操作",width:120,hidden:!1,formatter:function(){return[{tag:"a",text:"编辑",className:"opt-btn",callback:function(e,a){t.modalType="edit";var s=JSON.parse(r()(e));t.addParams.id=s.id,t.addParams.type=s.type,t.addParams.userId=s.userId,t.addParams.term=s.term,t.addParams.courseName=s.courseName,t.addParams.happenTime=s.happenTime,t.addParams.schoolYear=t.schoolYearList.find(function(t){return t.label==e.schoolYear}).value,t.showAddOneInfoModal=!0}},{tag:"a",text:"删除",className:"opt-btn",callback:function(e,a){t.deleteInfo(e.id)}}]}}]},getSchoolYear:function(){var t=this;Object(n.e)({url:"/api/fts/dict/findDictByTypeName?typeName=学年",dataType:"json",type:"get",async:!1,success:function(e){e.state&&(t.schoolYearList=e.data.map(function(t){return{label:t.label,value:t.value}}))}})},back:function(){this.$emit("back")},deleteInfo:function(t){var e=this;confirm("确定删除该学生该"+this.tabbar[this.currentTab].name)&&Object(n.e)({url:"/api/fts/attendance/deleteAttendanceById?id="+t,dataType:"json",type:"post",async:!1,success:function(t){t.state&&(e.timestamp=(new Date).getTime(),e.$toast("删除成功！"))}})},_daySelected:function(t){this.addParams.happenTime=t.value.substr(0,10)},addInfoByOne:function(){this.showAddOneInfoModal=!0,this.showAddModal=!1,this.addParams={userId:null,type:this.tabbar[this.currentTab].type,schoolYear:"",term:"",courseName:"",happenTime:""}},batchAddInfo:function(){var t=this;this.showExport=!0,this.showAddModal=!1,this.importParams={parentPageTitle:"",downloadTemplateUrl:"/fts/attendance/template",downloadErrorTemplateUrl:"/fts/score/errorFile",checkTemplateUrl:"/fts/attendance/checkExcel",templateName:"学生考勤信息导入模板",importBtnType:[{url:"/fts/attendance/addByExcel",method:"post",isShowBtn:!0,name:"增量导入",success:function(e){t.timestamp=(new Date).getTime(),t.showExport=!1}}]},this.quickAddRecord()},addOneInfo:function(){var t=this;for(var e in this.addParams.userId=this.userInfo.userId,this.require)if(!this.addParams[e])return void this.$toast(this.require[e]+"不能为空");Object(n.e)({url:"/api/fts/attendance/"+("add"==this.modalType?"addAttendance":"updateAttendance"),dataType:"json",type:"post",data:this.addParams,async:!1,success:function(e){e.state?(t.showAddOneInfoModal=!1,t.timestamp=(new Date).getTime(),t.$toast(("add"==t.modalType?"新增":"编辑")+"成功！")):t.$toast(e.message)}})}}}),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inSchoolInfo container-fluid"},[t.showExport?t._e():a("div",{staticClass:"row"},[a("a",{staticClass:"box_flex align_center back_wrap",attrs:{type:"button"},on:{click:function(e){return t.back()}}},[a("i",{staticClass:"maticon back-icon-btn",domProps:{innerHTML:t._s(t.icons("arrow_back"))}},[t._v("arrow_back")]),a("span",{staticClass:"nav-title"},[t._v("返回")])]),t._v(" "),a("div",{staticClass:"tab-div"},t._l(t.tabbar,function(e,s){return a("div",{key:s,staticClass:"tab",class:t.currentTab==s?"active":"",on:{click:function(e){return t.selectTab(s)}}},[t._v(t._s(e.name))])}),0),t._v(" "),a("v-table",{ref:"studentTable",attrs:{url:t.url+t.timestamp+"&userId="+t.userInfo.userId+"&type="+t.tabbar[t.currentTab].type,pagesize:"10",idField:"id",columns:t.columns,order:!1,search:!1}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left"},[a("div",{staticClass:"user-info"},[a("span",[t._v(t._s(t.userInfo.name))]),t._v(" "),a("span",[t._v(t._s(t.userInfo.studentId))]),t._v(" "),a("span",{staticStyle:{color:"#999","font-size":"12px"}},[t._v("本页数据截止至前一天")])])]),t._v(" "),a("div",{staticClass:"btn-group pull-right"},[a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:function(e){t.showAddModal=!0,t.modalType="add"}}},[t._v("新增")])])])])],1),t._v(" "),a("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"420"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        新增\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{width:"380px","text-align":"center"},attrs:{type:"button"},on:{click:t.addInfoByOne}},[t._v("单条增加")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{width:"380px","text-align":"center","margin-top":"20px"},attrs:{type:"button"},on:{click:function(e){return t.batchAddInfo()}}},[t._v("批量导入")])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddModal=!1}}},[t._v("取消")])])]),t._v(" "),a("v-modal",{attrs:{show:t.showAddOneInfoModal,effect:"fade",width:"460"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s("add"==t.modalType?"新增":"编辑")+"\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body container-fluid",staticStyle:{overflow:"inherit"},attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("考勤类型:")])]),t._v(" "),a("v-select",{attrs:{options:t.tabbar,disabled:"true","options-value":"type","options-label":"name","close-on-select":"",justify:""},model:{value:t.addParams.type,callback:function(e){t.$set(t.addParams,"type",e)},expression:"addParams['type']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("学年:")])]),t._v(" "),a("v-select",{attrs:{options:t.schoolYearList,"options-value":"value","options-label":"label","close-on-select":"",justify:""},model:{value:t.addParams.schoolYear,callback:function(e){t.$set(t.addParams,"schoolYear",e)},expression:"addParams['schoolYear']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("学期:")])]),t._v(" "),a("v-select",{attrs:{options:t.termList,"options-value":"value","options-label":"label","close-on-select":"",justify:""},model:{value:t.addParams.term,callback:function(e){t.$set(t.addParams,"term",e)},expression:"addParams['term']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("课程名称:")])]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.addParams.courseName,expression:"addParams['courseName']"}],staticClass:"form-control search-input",attrs:{type:"text",placeholder:"请输入课程名称"},domProps:{value:t.addParams.courseName},on:{input:function(e){e.target.composing||t.$set(t.addParams,"courseName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("时间:")])]),t._v(" "),a("v-datepicker",{on:{daySelected:t._daySelected},model:{value:t.addParams.happenTime,callback:function(e){t.$set(t.addParams,"happenTime",e)},expression:"addParams['happenTime']"}})],1)]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddOneInfoModal=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.addOneInfo}},[t._v("确定")])])]),t._v(" "),t.showExport?a("div",[a("v-import",t._b({on:{backParentPage:function(e){t.showExport=!1}}},"v-import",t.importParams,!1))],1):t._e()],1)},staticRenderFns:[]};var m=a("C7Lr")(c,u,!1,function(t){a("yXru")},"data-v-771e59f6",null).exports,p=(i.a,{mixins:[i.a],props:{userInfo:{default:null}},data:function(){return{url:"/table-data/fts/rewardPunishment/getRewardListByUserId?timestamp=",timestamp:new Date,columns:[],tabbar:[{name:"奖励记录",type:"Reward"},{name:"处分记录",type:"Punishment"}],currentTab:0,lang:"zh-cn",isSelectAll:!1,showExport:!1,fieldsToExport:[],exporting:!1,showAddModal:!1,showAddOneInfoModal:!1,addParams:{Reward:{userId:null,schoolYear:"",name:"",evaluateTime:"",level:""},Punishment:{userId:null,degree:"",reason:"",revokeTime:"",punishmentTime:""}},require:{Reward:{schoolYear:"奖励学年",name:"奖励名称",evaluateTime:"评定日期"},Punishment:{degree:"处分程度",punishmentTime:"处分时间",reason:"处分原因"}},schoolYearList:[],levelList:[],degreeList:[],termList:[{label:"1",value:"1"},{label:"2",value:"2"}],modalType:"add"}},created:function(){this.getSchoolYear(),this.getLevel(),this.getDegree(),this._initColumns()},mounted:function(){},methods:{selectTab:function(t){this.currentTab=t,this._initColumns(),this.url="/table-data/fts/rewardPunishment/get"+this.tabbar[this.currentTab].type+"ListByUserId?timestamp="},_initColumns:function(){var t=this;this.columns="Reward"==this.tabbar[this.currentTab].type?[{id:"name",title:"奖励名称",className:"text-left",width:120,hidden:!1,search:{type:"input"}},{id:"schoolYear",title:"奖励学年",className:"text-left",width:120,hidden:!1,search:{type:"select",data:{options:this.schoolYearList,optionsLabel:"label",optionsValue:"value"}}},{id:"evaluateTime",title:"评定日期",className:"text-left",width:100,hidden:!1,search:{type:"datetime",data:{dateFormat:"yyyy-MM-dd",change:function(e){e.value,e.target;t.url="/table-data/fts/rewardPunishment/get"+t.tabbar[t.currentTab].type+"ListByUserId?evaluateTimeBegin="+(t.$refs.studentTable.tableSearchFields.evaluateTime_start?t.$refs.studentTable.tableSearchFields.evaluateTime_start.substr(0,10):"")+"&evaluateTimeEnd="+(t.$refs.studentTable.tableSearchFields.evaluateTime_end?t.$refs.studentTable.tableSearchFields.evaluateTime_end.substr(0,10):"")+"&timestamp="}}}},{id:"level",title:"奖励级别",className:"text-left",width:120,hidden:!1,search:{type:"select",data:{options:this.levelList,optionsLabel:"label",optionsValue:"value"}}}]:[{id:"degree",title:"处分程度",className:"text-left",width:120,hidden:!1,search:{type:"select",data:{options:this.degreeList,optionsLabel:"label",optionsValue:"value"}}},{id:"reason",title:"处分原因",className:"text-left",width:250,hidden:!1,search:{type:"input"}},{id:"punishmentTime",title:"处分日期",className:"text-left",width:120,hidden:!1,search:{type:"datetime",data:{dateFormat:"yyyy-MM-dd",change:function(e){e.value,e.target;t.url="/table-data/fts/rewardPunishment/get"+t.tabbar[t.currentTab].type+"ListByUserId?punishmentTimeBegin="+(t.$refs.studentTable.tableSearchFields.punishmentTime_start?t.$refs.studentTable.tableSearchFields.punishmentTime_start.substr(0,10):"")+"&punishmentTimeEnd="+(t.$refs.studentTable.tableSearchFields.punishmentTime_end?t.$refs.studentTable.tableSearchFields.punishmentTime_end.substr(0,10):"")+"&timestamp="}}}},{id:"revokeTime",title:"处分撤销时间",className:"text-left",width:100,hidden:!1,search:{type:"input"}}],this.columns.push({id:"opt",className:"text-left",title:"操作",width:120,hidden:!1,formatter:function(){return[{tag:"a",text:"编辑",className:"opt-btn",callback:function(e,a){t.modalType="edit";var s=JSON.parse(r()(e));t.addParams[t.tabbar[t.currentTab].type]=0==t.currentTab?{id:s.id,schoolYear:t.schoolYearList.find(function(t){return t.label==e.schoolYear}).value,name:s.name,evaluateTime:s.evaluateTime,level:t.levelList.find(function(t){return t.label==e.level}).value}:{id:s.id,degree:t.degreeList.find(function(t){return t.label==e.degree}).value,reason:s.reason,revokeTime:s.revokeTime,punishmentTime:s.punishmentTime},t.showAddOneInfoModal=!0}},{tag:"a",text:"删除",className:"opt-btn",callback:function(e,a){t.deleteInfo(e.id)}}]}})},getSchoolYear:function(){var t=this;Object(n.e)({url:"/api/fts/dict/findDictByTypeName?typeName=学年",dataType:"json",type:"get",async:!1,success:function(e){e.state?t.schoolYearList=e.data.map(function(t){return{label:t.label,value:t.value}}):t.$toast(e.message)}})},getLevel:function(){var t=this;Object(n.e)({url:"/api/fts/dict/findDictByTypeName?typeName=奖励级别",dataType:"json",type:"get",async:!1,success:function(e){e.state?t.levelList=e.data.map(function(t){return{label:t.label,value:t.value}}):t.$toast(e.message)}})},getDegree:function(){var t=this;Object(n.e)({url:"/api/fts/dict/findDictByTypeName?typeName=处分程度",dataType:"json",type:"get",async:!1,success:function(e){e.state?t.degreeList=e.data.map(function(t){return{label:t.label,value:t.value}}):t.$toast(e.message)}})},back:function(){this.$emit("back")},deleteInfo:function(t){var e=this;confirm("确定删除该学生该"+this.tabbar[this.currentTab].name)&&Object(n.e)({url:"/api/fts/rewardPunishment/delete"+this.tabbar[this.currentTab].type+"ById?id="+t,dataType:"json",type:"post",async:!1,success:function(t){t.state?(e.timestamp=(new Date).getTime(),e.$toast("删除成功！")):e.$toast(t.message)}})},_daySelectedEvaluateTime:function(t){this.addParams.Reward.evaluateTime=t.value.substr(0,10)},_daySelectedRevokeTime:function(t){this.addParams.Punishment.revokeTime=t.value.substr(0,10)},_daySelectedPunishmentTime:function(t){this.addParams.Punishment.punishmentTime=t.value.substr(0,10)},addInfoByOne:function(){this.showAddOneInfoModal=!0,this.showAddModal=!1,this.addParams={Reward:{userId:null,schoolYear:"",name:"",evaluateTime:"",level:""},Punishment:{userId:null,degree:"",reason:"",revokeTime:"",punishmentTime:""}}},batchAddInfo:function(){var t=this;this.showExport=!0,this.showAddModal=!1,this.importParams={parentPageTitle:"",downloadTemplateUrl:"/fts/rewardPunishment/template",downloadErrorTemplateUrl:"/fts/score/errorFile",checkTemplateUrl:"/fts/rewardPunishment/checkExcel",templateName:"学生奖惩信息导入模板",importBtnType:[{url:"/fts/rewardPunishment/addByExcel",method:"post",isShowBtn:!0,name:"增量导入",success:function(e){t.timestamp=(new Date).getTime(),t.showExport=!1}}]},this.quickAddRecord()},addOneInfo:function(){var t=this;for(var e in this.addParams[this.tabbar[this.currentTab].type].userId=this.userInfo.userId,this.require[this.tabbar[this.currentTab].type])if(!this.addParams[this.tabbar[this.currentTab].type][e])return void this.$toast(this.require[this.tabbar[this.currentTab].type][e]+"不能为空");var a="add"+this.tabbar[this.currentTab].type,s="update"+this.tabbar[this.currentTab].type;Object(n.e)({url:"/api/fts/rewardPunishment/"+("add"==this.modalType?a:s),dataType:"json",type:"post",data:this.addParams[this.tabbar[this.currentTab].type],async:!1,success:function(e){e.state?(t.showAddOneInfoModal=!1,t.timestamp=(new Date).getTime(),t.$toast(("add"==t.modalType?"新增":"编辑")+"成功！")):t.$toast(e.message)}})}}}),h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inSchoolInfo container-fluid"},[t.showExport?t._e():a("div",{staticClass:"row"},[a("a",{staticClass:"box_flex align_center back_wrap",attrs:{type:"button"},on:{click:function(e){return t.back()}}},[a("i",{staticClass:"maticon back-icon-btn",domProps:{innerHTML:t._s(t.icons("arrow_back"))}},[t._v("arrow_back")]),a("span",{staticClass:"nav-title"},[t._v("返回")])]),t._v(" "),a("div",{staticClass:"tab-div"},t._l(t.tabbar,function(e,s){return a("div",{key:s,staticClass:"tab",class:t.currentTab==s?"active":"",on:{click:function(e){return t.selectTab(s)}}},[t._v(t._s(e.name))])}),0),t._v(" "),a("v-table",{ref:"studentTable",attrs:{url:t.url+t.timestamp+"&userId="+t.userInfo.userId,pagesize:"10",idField:"id",columns:t.columns,order:!1,search:!1}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-left"},[a("div",{staticClass:"user-info"},[a("span",[t._v(t._s(t.userInfo.name))]),t._v(" "),a("span",[t._v(t._s(t.userInfo.studentId))])])]),t._v(" "),a("div",{staticClass:"btn-group pull-right"},[a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:function(e){t.showAddModal=!0,t.modalType="add"}}},[t._v("新增")])])])])],1),t._v(" "),a("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"420"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        新增\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{width:"380px","text-align":"center"},attrs:{type:"button"},on:{click:t.addInfoByOne}},[t._v("单条增加")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{width:"380px","text-align":"center","margin-top":"20px"},attrs:{type:"button"},on:{click:function(e){return t.batchAddInfo()}}},[t._v("批量导入")])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddModal=!1}}},[t._v("取消")])])]),t._v(" "),a("v-modal",{attrs:{show:t.showAddOneInfoModal,effect:"fade",width:"460"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s("add"==t.modalType?"新增":"编辑")+"\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body container-fluid",staticStyle:{overflow:"inherit"},attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("奖惩类型:")])]),t._v(" "),a("v-select",{attrs:{options:t.tabbar,"options-value":"type",disabled:"true","options-label":"name","close-on-select":"",justify:""},model:{value:t.tabbar[t.currentTab].type,callback:function(e){t.$set(t.tabbar[t.currentTab],"type",e)},expression:"tabbar[currentTab].type"}})],1),t._v(" "),0==t.currentTab?a("div",[a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("奖励名称:")])]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.addParams[t.tabbar[t.currentTab].type].name,expression:"addParams[tabbar[currentTab].type]['name']"}],staticClass:"form-control search-input",attrs:{type:"text",placeholder:"请输入奖励名称"},domProps:{value:t.addParams[t.tabbar[t.currentTab].type].name},on:{input:function(e){e.target.composing||t.$set(t.addParams[t.tabbar[t.currentTab].type],"name",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("奖励学年:")])]),t._v(" "),a("v-select",{attrs:{options:t.schoolYearList,"options-value":"value","options-label":"label","close-on-select":"",justify:""},model:{value:t.addParams[t.tabbar[t.currentTab].type].schoolYear,callback:function(e){t.$set(t.addParams[t.tabbar[t.currentTab].type],"schoolYear",e)},expression:"addParams[tabbar[currentTab].type]['schoolYear']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("评定日期:")])]),t._v(" "),a("v-datepicker",{on:{daySelected:t._daySelectedEvaluateTime},model:{value:t.addParams[t.tabbar[t.currentTab].type].evaluateTime,callback:function(e){t.$set(t.addParams[t.tabbar[t.currentTab].type],"evaluateTime",e)},expression:"addParams[tabbar[currentTab].type]['evaluateTime']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label"},[a("span",[t._v("奖励级别:")])]),t._v(" "),a("v-select",{attrs:{options:t.levelList,"options-value":"value","options-label":"label","close-on-select":"",justify:""},model:{value:t.addParams[t.tabbar[t.currentTab].type].level,callback:function(e){t.$set(t.addParams[t.tabbar[t.currentTab].type],"level",e)},expression:"addParams[tabbar[currentTab].type]['level']"}})],1)]):a("div",[a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("处分程度:")])]),t._v(" "),a("v-select",{attrs:{options:t.degreeList,"options-value":"value","options-label":"label","close-on-select":"",justify:""},model:{value:t.addParams[t.tabbar[t.currentTab].type].degree,callback:function(e){t.$set(t.addParams[t.tabbar[t.currentTab].type],"degree",e)},expression:"addParams[tabbar[currentTab].type]['degree']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label require"},[a("span",[t._v("处分日期:")])]),t._v(" "),a("v-datepicker",{on:{daySelected:t._daySelectedPunishmentTime},model:{value:t.addParams[t.tabbar[t.currentTab].type].punishmentTime,callback:function(e){t.$set(t.addParams[t.tabbar[t.currentTab].type],"punishmentTime",e)},expression:"addParams[tabbar[currentTab].type]['punishmentTime']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label mt-66 require"},[a("span",[t._v("处分原因:")])]),t._v(" "),a("v-textarea",{staticStyle:{width:"250px"},attrs:{autoHeight:!0,rows:4,placeholder:"请输入处分原因",maxLength:200},model:{value:t.addParams[t.tabbar[t.currentTab].type].reason,callback:function(e){t.$set(t.addParams[t.tabbar[t.currentTab].type],"reason",e)},expression:"addParams[tabbar[currentTab].type]['reason']"}})],1),t._v(" "),a("div",{staticClass:"form-group box_flex align_center"},[a("div",{staticClass:"label"},[a("span",[t._v("处分撤销时间:")])]),t._v(" "),a("v-datepicker",{on:{daySelected:t._daySelectedRevokeTime},model:{value:t.addParams[t.tabbar[t.currentTab].type].revokeTime,callback:function(e){t.$set(t.addParams[t.tabbar[t.currentTab].type],"revokeTime",e)},expression:"addParams[tabbar[currentTab].type]['revokeTime']"}})],1)])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddOneInfoModal=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.addOneInfo}},[t._v("确定")])])]),t._v(" "),t.showExport?a("div",[a("v-import",t._b({on:{backParentPage:function(e){t.showExport=!1}}},"v-import",t.importParams,!1))],1):t._e()],1)},staticRenderFns:[]};var b=a("C7Lr")(p,h,!1,function(t){a("gcMr")},"data-v-2101de7a",null).exports,f=(i.a,{mixins:[i.a],props:{data:{default:null}},components:{scoreDetail:d,attendanceDetail:m,rewardPunishment:b},data:function(){return{type:"",title:{score:"期末成绩",attendance:"考勤信息",rewardPunishment:"奖惩信息"},url:"/table-data/fts/student/getStudentList",columns:[],definedSearch:{studentId:"",name:"",college:"",grade:"",educationLevel:"",className:"",fields:""},lang:"zh-cn",isSelectAll:!1,showExport:!1,fieldsToExport:[],exporting:!1,treeIndexArr:[],treeInfo:{score:["学年","学期","课程名称","成绩"],attendance:["学年","学期","课程名称","时间"],rewardPunishment:["奖励名称","奖励学年","评定日期","处分程度","处分日期","处分撤销时间"]},showDetail:!1,showAddModal:!1,showAddOnePersonModal:!1,addPersonParams:{},record:{}}},computed:{exportStatus:function(){return this.exporting?"导出中":this.translate.export},isSelectAll:function(){return 2==this.treeIndexArr.length}},watch:{treeIndexArr:function(t){2==t.length?this.isSelectAll=!0:this.isSelectAll=!1}},created:function(){this.type=this.$route.query.type,this.getClassList(),this.getGradeList(),this._initColumns(),this.getStuTree()},mounted:function(){},methods:{_initColumns:function(){var t=this;this.columns=[{id:"studentId",title:"学号",className:"text-left",width:120,hidden:!1,search:{type:"input"}},{id:"name",title:"姓名",className:"text-left",width:80,hidden:!1,search:{type:"input"}},{id:"college",title:"学院",className:"text-left",width:120,hidden:!1,search:{type:"select",data:{url:"/api/fts/dict/getUnitList",optionsLabel:"label",optionsValue:"value"}}},{id:"educationLevel",title:"培养层次",className:"text-left",width:100,hidden:!1,search:{type:"select",data:{url:"/api/fts/dict/findDictByTypeName?typeName=培养层次",optionsLabel:"label",optionsValue:"value"}}},{id:"grade",title:"年级",className:"text-left",width:100,hidden:!1,search:{type:"select",data:{options:this.gradeList,optionsLabel:"label",optionsValue:"value"}}},{id:"className",title:"班级",className:"text-left",width:120,hidden:!1,search:{type:"select",data:{options:this.classList,optionsLabel:"label",optionsValue:"value"}}},{id:"opt",className:"text-left",title:"操作",width:120,hidden:!1,formatter:function(){return[{tag:"a",text:"查看",className:"opt-btn",callback:function(e,a){t.record=e,t.showDetail=!0}}]}}],this.url="/table-data/fts/student/getStudentList?timestamp="+(new Date).getTime()},getClassList:function(){var t=this;Object(n.e)({url:"/api/fts/dict/getClassList",dataType:"json",type:"get",async:!1,success:function(e){e.state&&(t.classList=e.data.map(function(t){return{label:t,value:t}}))}})},getGradeList:function(){var t=this;Object(n.e)({url:"/api/fts/dict/getGradeList",dataType:"json",type:"get",async:!1,success:function(e){e.state&&(t.gradeList=e.data.map(function(t){return{label:t,value:t}}))}})},showExportModal:function(){this.showExport=!0},clickChild:function(t){var e=0,a=JSON.parse(r()(t));a.result.forEach(function(t){t.id==a.item.id&&(t.checked=!a.item.checked),t.checked&&e++});var s=this.treeIndexArr.findIndex(function(t){return t==a.index});-1==s&&e==a.result.length?this.treeIndexArr.push(a.index+1):-1!==s&&e!==a.result.length&&this.treeIndexArr.splice(s,1)},ckeckItem:function(t,e){var a=this.treeIndexArr.findIndex(function(e){return e==t});a>-1?this.treeIndexArr.splice(a,1):this.treeIndexArr.push(t)},selectAll:function(){this.isSelectAll=!this.isSelectAll,this.isSelectAll?(this.treeIndexArr=[1,2],this.$refs.tree.setAllChecked()):(this.$refs.tree.setAllUnchecked(),this.treeIndexArr=[])},getStuTree:function(){var t=[],e={id:1,title:"学生基本信息",edit:!1,children:[]};this.columns.forEach(function(t,a){"opt"!=t.id&&e.children.push({id:a+1,title:t.title,disabled:!1,meta:!0,checked:!1})}),t.push(e);var a={id:2,title:this.title[this.type]+"信息",edit:!1,children:[]};this.treeInfo[this.type].forEach(function(t,e){a.children.push({id:6+e+1,title:t,disabled:!1,meta:!0,checked:!1})}),t.push(a),this.fieldsToExport=t},exportTable:function(){if(!this.exporting){var t=[];if(this.$refs.tree.getChecked().forEach(function(e){e.meta&&e.checked&&t.push(e.id)}),!t.length)return this.$toast("请勾选至少一个字段");this.exporting=!0,this.definedSearch.studentId=this.$refs.studentTable.tableSearchFields.studentId,this.definedSearch.name=this.$refs.studentTable.tableSearchFields.name,this.definedSearch.college=this.$refs.studentTable.tableSearchFields.college,this.definedSearch.educationLevel=this.$refs.studentTable.tableSearchFields.educationLevel,this.definedSearch.grade=this.$refs.studentTable.tableSearchFields.grade,this.definedSearch.className=this.$refs.studentTable.tableSearchFields.className,this.definedSearch.fields=t.join(",");var e="/downloads/fts/"+this.type+"/excelOutStudentAnd"+(this.type.charAt(0).toUpperCase()+this.type.slice(1))+"?";for(var a in this.definedSearch)e+=a+"="+this.definedSearch[a]+"&";e=e.substr(0,e.length-1),window.location.href=e,this.exporting=!1,this.showExport=!1,this.getStuTree()}},deleteInfo:function(t){var e=this;if(confirm("确定删除该学生"+this.title[this.type])){var a=[this.type];"rewardPunishment"==this.type&&(a=["reward","punishment"]),a.map(function(a){Object(n.e)({url:"/api/fts/"+e.type+"/delete"+(a.charAt(0).toUpperCase()+a.slice(1))+"ByUserId?userId="+t,dataType:"json",type:"post",async:!1,success:function(t){t.state&&e.$toast("删除成功！")}})})}},back:function(){this.showDetail=!1}}}),v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.showDetail?a("div",["score"==this.type?a("score-detail",{attrs:{userInfo:t.record},on:{back:t.back}}):"attendance"==this.type?a("attendance-detail",{attrs:{userInfo:t.record},on:{back:t.back}}):"rewardPunishment"==this.type?a("reward-punishment",{attrs:{userInfo:t.record},on:{back:t.back}}):t._e()],1):a("div",{staticClass:"inSchoolInfo container-fluid"},[a("div",{staticClass:"row text-center"},[a("v-table",{ref:"studentTable",attrs:{title:t.title[t.type]+"学生信息",url:t.url,pagesize:"10",idField:"id",columns:t.columns,order:!0,search:!1,searchParams:t.definedSearch}},[a("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:t.showExportModal}},[t._v("批量导出")])])])],1),t._v(" "),a("v-modal",{attrs:{show:t.showExport,effect:"fade"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("导出")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("v-tree",{ref:"tree",attrs:{id:"resourceTree",cascade:"true",items:t.fieldsToExport,checkable:!0,search:!1},on:{clickChild:t.clickChild,itemClick:t.ckeckItem}})],1),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("div",{staticClass:"input-group merge-table pull-left flex-align-center"},[a("span",{on:{click:t.selectAll}},[t.isSelectAll?a("i",{staticClass:"maticon role-icon active",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon role-icon",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])]),t._v(" "),a("span",{staticClass:"role-name"},[t._v("全选")])]),t._v(" "),a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showExport=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.exportTable}},[t._v("导出")])])])],1)},staticRenderFns:[]};var y=a("C7Lr")(f,v,!1,function(t){a("FSr1")},"data-v-5c5b5844",null);e.default=y.exports},FSr1:function(t,e){},gcMr:function(t,e){},gpRL:function(t,e){},yXru:function(t,e){}});