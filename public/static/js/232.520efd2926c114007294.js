webpackJsonp([232],{"e+W3":function(e,t){},gPgL:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("Gme2"),a=s("8c0Y"),o=s("C331"),i=(s("0Nqt"),r.a,a.a,{name:"forgetPassword",components:{EmHeader:r.a,EmUser:a.a},data:function(){var e=this;return{title:{name:"就业管理系统",url:"employmentPlatform"},pageType:1,user:null,curStep:0,stepList:[{title:"找回密码"},{title:"发送邮件"},{title:"重置密码"}],formForgetPsd:{email:""},formForgetPsdRules:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]},formNewPsd:{pass:"",checkPass:""},formPsdRules:{pass:[{validator:function(t,s,r){""===s?r(new Error("请输入密码")):(""!==e.formNewPsd.checkPass&&e.$refs.formNewPsd.validateField("checkPass"),r())},trigger:"blur"}],checkPass:[{validator:function(t,s,r){""===s?r(new Error("请再次输入密码")):s!==e.formNewPsd.pass?r(new Error("两次输入密码不一致!")):r()},trigger:"blur"}]}}},beforeCreate:function(){document.querySelector("body").setAttribute("style","background:#fff")},beforeDestroy:function(){document.querySelector("body").removeAttribute("style")},created:function(){this.getUrlParam("schoolId")&&this.getUrlParam("dataKey")&&(this.curStep=2)},methods:{starEncrypt:function(e){var t=e.replace(/([@][^@]+)$/,""),s=e.match(/([^@]+)$/)[1],r="******"+s;switch(t.length){case 1:case 2:case 3:case 4:break;case 5:case 6:case 7:r=t.substr(0,1)+"******"+t.substr(t.length-1,t.length)+s;break;case 8:case 9:case 10:r=t.substr(0,2)+"******"+t.substr(t.length-2,t.length)+s;break;default:r=t.substr(0,3)+"******"+t.substr(t.length-3,t.length)+s}return r},getUrlParam:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),s=window.location.search.substr(1).match(t);return s?decodeURIComponent(s[2]):null},resendEmail:function(){var e=this;Object(o.e)({url:"/api/employment/certifications/passwordResetConfirm",type:"post",data:{userMail:this.formForgetPsd.email,confirmUrl:"employment/forget"},success:function(t){t.state?e.$message.success("邮件重新发送成功"):e.$message.error(t.message)}})},submitEmail:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;Object(o.e)({url:"/api/employment/certifications/passwordResetConfirm",type:"post",data:{userMail:t.formForgetPsd.email,confirmUrl:"employment/forget"},success:function(e){e.state?(t.$message.success("邮件发送成功"),t.curStep=1):t.$message.error(e.message)}})})},submitNewPsd:function(){var e=this,t=this;this.$refs.formNewPsd.validate(function(s){if(!s)return!1;Object(o.e)({url:"/api/employment/certifications/passwordReset",type:"post",data:{dataKey:e.getUrlParam("dataKey"),userPassword:t.formNewPsd.pass},success:function(t){t.state?(e.$message.success("密码设置成功"),e.$router.push("/default/login/employment")):e.$message.error(t.message)}})})}}}),l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"header"},[s("em-header",{attrs:{title:e.title}},[s("em-user",{attrs:{slot:"top-nav",pageType:e.pageType,user:e.user},slot:"top-nav"})],1)],1),e._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"forget-psd"},[s("div",{staticClass:"title"},[e._v("\n        "+e._s(e.stepList[e.curStep].title)+"\n      ")]),e._v(" "),s("div",{staticClass:"main"},[0===e.curStep?s("div",[s("el-form",{ref:"formForgetPsd",attrs:{model:e.formForgetPsd,rules:e.formForgetPsdRules}},[s("el-form-item",{attrs:{prop:"email"}},[s("el-input",{attrs:{placeholder:"请输入邮箱地址"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitEmail("formForgetPsd")}},model:{value:e.formForgetPsd.email,callback:function(t){e.$set(e.formForgetPsd,"email",t)},expression:"formForgetPsd.email"}})],1),e._v(" "),s("el-form-item",{staticStyle:{display:"none"},attrs:{prop:"email"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入邮箱地址"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitEmail("formForgetPsd")}},model:{value:e.formForgetPsd.email,callback:function(t){e.$set(e.formForgetPsd,"email",t)},expression:"formForgetPsd.email"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitEmail("formForgetPsd")}}},[e._v("下一步")])],1)],1)],1):e._e(),e._v(" "),1===e.curStep?s("div",[s("div",{staticClass:"message"},[s("span",{staticClass:"text"},[e._v("已向绑定的邮箱")]),e._v(" "),s("span",{staticClass:"font-weight"},[e._v(e._s(e.starEncrypt(e.formForgetPsd.email)))]),e._v(" "),s("span",{staticClass:"text"},[e._v("重新发送了一份重置密码的邮件，请注意查收")])]),e._v(" "),s("div",[e._m(0),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.resendEmail}},[e._v("重新发送")])],1)]):e._e(),e._v(" "),2===e.curStep?s("div",[s("el-form",{ref:"formNewPsd",attrs:{model:e.formNewPsd,rules:e.formPsdRules,"label-width":"100px","label-position":"right"}},[s("el-form-item",{attrs:{label:"新密码",prop:"pass"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:e.formNewPsd.pass,callback:function(t){e.$set(e.formNewPsd,"pass",t)},expression:"formNewPsd.pass"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"确认新密码",prop:"checkPass"}},[s("el-input",{attrs:{type:"password",placeholder:"请再次输入新密码"},model:{value:e.formNewPsd.checkPass,callback:function(t){e.$set(e.formNewPsd,"checkPass",t)},expression:"formNewPsd.checkPass"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.submitNewPsd}},[e._v("确认密码")])],1)],1)],1):e._e()])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"no-receive"},[t("span",{staticClass:"text"},[this._v("没有收到？")])])}]};var n=s("C7Lr")(i,l,!1,function(e){s("e+W3")},"data-v-405acb55",null);t.default=n.exports}});