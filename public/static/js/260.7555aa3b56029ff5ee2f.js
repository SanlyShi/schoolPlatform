webpackJsonp([260],{"I/xv":function(t,e){},moLw:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("kV13"),s=a("C331"),n=a("7CEZ");o.default.component("FormSetManage",n.default);o.default.component("FormSetManage",n.default);var u={props:{data:{default:null},role:{default:""}},created:function(){var t=localStorage.getItem("lang");Object(s.g)(t)&&(this.lang=t),this._initColumns()},data:function(){return{studentBie:!0,columns:[],onGuardStatus:!0,url:"/table-data/tutor/getTutors",tableName:"导师信息",method:"get",lang:"zh-cn",student:{name:""},layoutManageJson:{infoTypes:[],route:"main",layoutsJson:{},logJson:{},instanceJson:{},preview:!1,curInfoId:""},showAddModal:!1,tutor:{message:"",userId:"",userNo:"",userName:""},timeStamp:"",curRouter:"tutorInfoList",importParams:{parentPageTitle:"导师信息列表",downloadTemplateUrl:"/tutor/tutorExcelDownload",checkTemplateUrl:"/tutor/checkTutor",downloadErrorTemplateUrl:"/tutor/tutorExcelInput/error",templateName:"批量导入导师信息",importBtnType:null}}},computed:{translate:function(){return Object(s.g)(this.lang).infoManage}},methods:{_addTutor:function(){this.showAddModal=!0,this.tutor={message:"",userId:"",userNo:"",userName:""}},_batchTutor:function(){var t=this;this.curRouter="importPag",this.importParams.importBtnType=[{url:"/tutor/inputExcelTutor",method:"POST",isShowBtn:!0,name:"增量导入",success:function(e){e.state&&(t.timeStamp=Object(s.a)())}}]},checkAddUser:function(){var t=this;Object(s.e)({url:"/api/users/"+this.tutor.userNo,type:"GET",success:function(e){e.state?(t.tutor.userId=e.data.userId,t.tutor.userName=e.data.name,t.tutor.errorMessage=""):(t.tutor.errorMessage="用户不存在",t.tutor.userId="",t.tutor.userName="")}})},sureAddTutor:function(){var t=this;Object(s.e)({url:"/api/tutor/addTutor",type:"post",data:{userNo:this.tutor.userNo,userId:this.tutor.userId,userName:this.tutor.userName},success:function(e){e.state?(t.showAddModal=!1,t.$toast("新增成功"),t.timeStamp=Object(s.a)()):"50003"===e.code?t.$toast("该导师已存在"):t.$toast(e.message)}})},_initColumns:function(){var t=this;this.columns=[{id:"userNo",title:"教工号",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:"教工号"}}},{id:"tutorName",title:"姓名",className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:"姓名"}}},{id:"opt",title:this.translate.opt,className:"text-center",hidden:!1,formatter:function(){return[{tag:"a",text:"删除",className:"opt-btn",callback:function(e,a){window.confirm("确定删除吗？")&&Object(s.e)({url:"/api/tutor/deleteTutor?userNo="+e.userNo,type:"POST",success:function(e){e.state?(t.$toast("删除成功"),t.timeStamp=Object(s.a)()):(t.$toast("删除失败"),t.$toast(e.message))}})}}]}}]},_resetLayoutManageJson:function(){this.layoutManageJson.layoutsJson={},this.layoutManageJson.logsJson={},this.layoutManageJson.instanceJson={},this.layoutManageJson.curInfoId=""},_setLayout:function(){var t=this;0===this.layoutManageJson.infoTypes.length?(this.$waiting.show(),this._getInfoTypes(function(){t.$waiting.close(),t.layoutManageJson.route="formSetManage",t.$emit("fullScreen",!0)})):(this.layoutManageJson.route="formSetManage",this.$emit("fullScreen",!0))},_getInfoTypes:function(t,e){var a=this;Object(s.e)({url:"/api/information/columnTypes/INSTRUCTOR",type:"get",data:{searchContent:e},success:function(e){e.state?e.data&&e.data.length>0?(a.layoutManageJson.infoTypes=e.data||[],a.layoutManageJson.infoTypes.forEach(function(t){a.$set(t,"title",t.text)}),t&&t()):a.$toast(a.translate.nullColumnTypesTip):a.$toast(e.message)}}).always(function(){})},_closeFormSetting:function(){this.layoutManageJson.route="main",this.$emit("fullScreen",!1)},_saveFormInfo:function(t){var e=this;t.length>0?(this.$waiting.show(),Object(s.e)({url:"/api/information/infoSettings/INSTRUCTOR",type:"post",data:{infoTypes:t},success:function(t){t.state?(e.layoutManageJson.route="main",e.$toast(e.translate.successTip)):e.$toast(t.message)}}).always(function(){e.$waiting.close()})):(this.layoutManageJson.route="main",this.$toast(this.translate.successTip))},_initInfoType:function(t){var e=this;this.layoutManageJson.layoutsJson[t.id]&&this.layoutManageJson.logsJson[t.id]?this.layoutManageJson.curInfoId=t.id:(this.$waiting.show({container:".preview-container"}),Object(s.e)({url:"/api/information/infoSetting/INSTRUCTOR/"+t.id,type:"get",data:{userId:this.student.userId,distributary:"bySchool"},success:function(a){a.state?(a.data||(a.data=[]),a.data.components.forEach(function(t){o.default.set(t,"x",t.location.left),o.default.set(t,"y",t.location.top),o.default.set(t,"w",t.size.width),o.default.set(t,"h",t.size.height)}),e.$set(e.layoutManageJson.layoutsJson,t.id,a.data),Object(s.e)({url:"/api/information/infoInstance/changeLogs/INSTRUCTOR/"+t.id,type:"get",data:{userId:e.student.userId},success:function(a){a.state?(e.$set(e.layoutManageJson.logsJson,t.id,a.data||[]),e.layoutManageJson.curInfoId=t.id,e.layoutManageJson.preview=!0):e.$toast(a.message)}})):e.$toast(a.message)}}).always(function(){e.$waiting.close()}))},_getInfoValue:function(t){this.$set(this.layoutManageJson.instanceJson,this.layoutManageJson.curInfoId,t)},_submitAll:function(){var t=this,e=[];for(var a in this.layoutManageJson.instanceJson)e.push({infoId:a,formData:this.layoutManageJson.instanceJson[a].formData});0!==e.length?(this.$waiting.show(),Object(s.e)({url:"/api/information/infoInstance/INSTRUCTOR/bySchool/"+this.student.userId,type:"post",data:{typesValue:e,source:"INSTRUCTOR"},success:function(e){e.state?(t.$toast(t.translate.successTip),t.layoutManageJson.instanceJson={},t.layoutManageJson.preview=!1):t.$toast(e.message)}}).always(function(){t.$waiting.close()})):this.$toast("暂无需保存记录")},_saveRoles:function(t){var e=this;Object(s.e)({url:"/api/information/player/"+t.type,type:"post",data:{players:t.players,educationLevel:t.educationLevel},success:function(t){t.state?(e.$toast(e.translate.successTip),e.layoutManageJson.route="formSetManage"):e.$toast(t.message)}})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return"tutorInfoList"===t.curRouter?a("div",{staticClass:"info-set-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:"main"===t.layoutManageJson.route,expression:"layoutManageJson.route === 'main'"}],staticClass:"tutor-info-page"},[a("div",{staticClass:"content text-center"},[a("v-table",{ref:"studentTable",attrs:{title:"全校导师信息",url:t.url+"?timeStamp="+t.timeStamp,method:t.method,pagesize:"10",idField:"id",columns:t.columns,search:!1,order:!0,multiple:!0,columnsControl:!0}},[a("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:t._addTutor}},[t._v("新增人员")]),t._v(" "),a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:t._batchTutor}},[t._v("批量新增人员")])])])],1)]),t._v(" "),"main"!==t.layoutManageJson.route?a("FormSetManage",{directives:[{name:"show",rawName:"v-show",value:"formSetManage"===t.layoutManageJson.route,expression:"layoutManageJson.route === 'formSetManage'"}],attrs:{infoSetting:{type:"TUTOR",tabs:t.layoutManageJson.infoTypes},student:t.studentBie},on:{back:t._closeFormSetting,submit:t._saveFormInfo,gotoRoleSet:function(e){t.layoutManageJson.route="joinRoleSet"}}}):t._e(),t._v(" "),"joinRoleSet"===t.layoutManageJson.route?a("JoinRoleSetManage",{attrs:{roleSetting:{type:"TUTOR",educationLevel:t.layoutManageJson.educationLevel}},on:{back:function(e){t.layoutManageJson.route="formSetManage"},submit:t._saveRoles}}):t._e(),t._v(" "),t.layoutManageJson.preview?a("div",{staticClass:"preview-container"},[a("preview",{attrs:{data:t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId]&&t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId].components,defaultData:t.layoutManageJson.instanceJson[t.layoutManageJson.curInfoId],log:t.layoutManageJson.logsJson[t.layoutManageJson.curInfoId],script:t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId]&&t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId].property&&t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId].property.script,previewType:"form",infoSetting:{tabs:t.layoutManageJson.infoTypes,curInfoId:t.layoutManageJson.curInfoId}},on:{tabExchange:t._initInfoType,submit:t._getInfoValue,submitAll:t._submitAll,search:function(e){return t._getInfoTypes(null,e)},back:function(e){t.layoutManageJson.preview=!1}}})],1):t._e(),t._v(" "),a("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"500"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        新增人员\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"input-label"},[t._v("教工号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tutor.userNo,expression:"tutor.userNo"}],staticClass:"form-control search-input modal-form-style",attrs:{id:"user-no",type:"text"},domProps:{value:t.tutor.userNo},on:{change:t.checkAddUser,input:function(e){e.target.composing||t.$set(t.tutor,"userNo",e.target.value)}}}),t._v(" "),a("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkAddUser}},[t._v("检测")]),t._v(" "),a("p",{staticClass:"error-message"},[t._v(t._s(t.tutor.errorMessage))])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"input-label",staticStyle:{"margin-left":"15px"}},[t._v("姓名")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.tutor.userName,expression:"tutor.userName"}],staticClass:"form-control search-input modal-form-style",attrs:{type:"text",disabled:"disabled"},domProps:{value:t.tutor.userName},on:{input:function(e){e.target.composing||t.$set(t.tutor,"userName",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddModal=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.sureAddTutor}},[t._v("确定")])])])],1):a("v-import",t._b({on:{backParentPage:function(e){t.curRouter="tutorInfoList"}}},"v-import",t.importParams,!1))},staticRenderFns:[]};var i=a("C7Lr")(u,r,!1,function(t){a("I/xv")},null,null);e.default=i.exports}});