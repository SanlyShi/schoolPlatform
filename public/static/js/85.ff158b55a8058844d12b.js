webpackJsonp([85],{"3BGH":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("hRKE"),i=s.n(a),n=s("3cXf"),r=s.n(n),o=s("C331"),d=(s("0Nqt"),s("41YJ")),l=(d.a,{props:{data:{default:null},dateFormat:{default:"yyyy-MM-dd hh:ii:ss"}},data:function(){var e=this;return{tableOutUrl:"",signId:"",signInType:"ALL",OutSedMessagePeopleTypeList:[{label:"所有人",value:"ALL"},{label:"未签到",value:"NOT_SIGN"}],deleteArray:[],deleteNameArray:[],outSedMessageRows:[],fromOutSedMessage:!1,readInfo:"",sendLoading:{sendTiming:!1,send:!1},showTable:!0,sourceDateProp:(new Date).getTime(),newMembersArr:[],collDictType:[],stuDictType:[],userInfo:"",importPage:!1,importParams:{},showAddModal:!1,member:{message:"",userId:"",userNo:"",userName:"",detail:""},timingSendParams:{placeholder:"请选择发送时间",sendTimeValue:"",timingSendMan:!1,timestamp:""},isReceive:{list:[{id:1,val:"是"},{id:0,val:"否"}],status:1},isReceiveW:{list:[{id:1,val:"是"},{id:0,val:"否"}],status:1},contentValue:"",messageTitle:"",sendPerStr:[],sendPerIdList:{school:"",collegeId:[],student:"",classId:[],toUserId:[],grades:[],educationLevels:[]},selfSettingModel:!1,editorConfig:{initialFrameHeight:420},nowPage:!0,allMessageUrl:"/table-data/message/querySendMessage?queryType=1",searchParams:{title:"",content:"",name:"",otherMessage:"",createTime:""},url:"",checkUrl:"",showSendMan:!1,downItemArray:[],rows:[],columns:[{id:"title",title:"消息标题",width:120,hidden:!1},{id:"content",title:"消息内容",width:150,hidden:!1,formatter:function(e){return'<div style="height:34px;overflow: hidden;">'+e.content.substr(0,10)+"...</div>"}},{id:"name",title:"发送人",width:120,hidden:!1},{id:"otherMessage",title:"接收人员",width:130,hidden:!1},{id:"isWechatPush",title:"微信推送",width:130,hidden:!1,formatter:function(e){return e.isWechatPush?"是":"否"}},{id:"createTime",title:"发送时间",width:200,hidden:!1},{id:"opts",title:"操作",width:80,hidden:!1,options:[{tag:"a",text:"查看",callback:function(t,s){e.curMessage=t,e.checkUrl="/table-data/message/formMessagefo/"+t.id,e.nowPage=!1,Object(o.e)({url:"/api/message/count/read/notRead/"+t.id,type:"get",async:!1,success:function(t){t.state&&(e.readInfo=t.data)}}).always(function(){})}}]}],columnsSetting:[{id:"name",title:"姓名",width:120,hidden:!1,search:{}},{id:"userNo",title:"学号",width:150,hidden:!1,search:{}},{id:"collegeName",title:"学院",width:120,hidden:!1,search:{}},{id:"studentTypeD",title:"学生类型",width:130,hidden:!1,search:{}},{id:"opts",title:"操作",width:80,hidden:!1,options:[{tag:"a",text:"删除",callback:function(t,s){-1===e.deleteArray.findIndex(function(e){return e==t.userId})?(e.deleteNameArray.push(t.name),e.deleteArray.push(t.userId)):e.$toast("您已去除该人员")}}]}],checkColumns:[{id:"name",title:"姓名",width:80,hidden:!1},{id:"studentId",title:"学工号",width:80,hidden:!1},{id:"collegeName",title:"学院",width:80,hidden:!1},{id:"phone",title:"联系方式",width:80,hidden:!1},{id:"alreadyRead",title:"平台消息",width:80,hidden:!1,formatter:function(e){return"1"==e.alreadyRead?'<span class="stutus-color">已接收</span>':'<span class="stutus-color">未接收</span>'}},{id:"wechatPushResult",title:"微信推送",width:80,hidden:!1,formatter:function(e){return e.wechatPushResult?'<span class="stutus-color">推送成功</span>':'<span class="stutus-color">推送失败</span>'}}],curMessage:null,newMessage:!1}},components:{dateLinkage:d.a},created:function(){var e=this;"true"==sessionStorage.getItem("fromOutSedMessage")?(this.fromOutSedMessage=!0,this.rows=[],this.newMessage=!0,this.nowPage=!1,this.signId=sessionStorage.getItem("signIdSend"),this.getData()):this.fromOutSedMessage=!1,sessionStorage.setItem("fromOutSedMessage",!1);var t=this;Object(o.e)({url:"/login/check",type:"get",success:function(t){t.state&&(e.userInfo=t.data)}}).always(function(){}),this.getStuDictType(),this.getCollDictType(),Object(o.e)({url:"/api/message/authority",type:"get",success:function(s){if(s.state){var a=s.data;a.schoolStudent&&a.schoolStudent.length>0&&t.downItemArrayAddItem("1","全校在校生",!0,a.schoolStudent),a.isCollege&&a.isCollege.length>0&&a.collegeName&&a.collegeName.length>0&&a.collegeId&&a.collegeId.length>0&&t.downItemArrayAddItem("2","学院",!1,a.isCollege,a.collegeId,a.collegeName),a.isClass&&a.isClass.length>0&&a.className&&a.className.length>0&&a.classId&&a.classId.length>0&&t.downItemArrayAddItem("3","所带班级",!1,a.isClass,a.classId,a.className),a.isStudent&&a.isStudent.length>0&&t.downItemArrayAddItem("4","所带学生",!1,a.isStudent),t.downItemArrayAddItem("5","自定义名单",!1,""),t.downItemArrayAddItem("6","年级",!1,!0,["2019","2018","2017","2016","2015"],["2019级","2018级","2017级","2016级","2015级"]),t.downItemArrayAddItem("7","培养层次",!1,!0,["100","200","300","400","500","600"],["博士","硕士","本科","专科","其他","预科"])}else e.$toast(s.message)}}).always(function(){})},computed:{computedCheckColumns:function(){var e=JSON.parse(r()(this.checkColumns));return this.curMessage&&this.curMessage.isNeedSure&&e.push({id:"status",title:"状态",width:80,hidden:!1,hover:!1,formatter:function(e){return'<span style="color: '+(e.status?"blue":"red")+';">'+(e.status?"已接收":"未接收")+"</span>"}}),e}},methods:{afterSelectedType:function(e){this.signInType=e.val,this.getData()},getData:function(){this.tableOutUrl="/table-data/message/signInPeople?signInId="+this.signId+"&signInType="+this.signInType+"&timeStamp="+(new Date).getTime()},backToList:function(){this.newMessage=!1,this.nowPage=!0,this.allMessageUrl="/table-data/message/querySendMessage?queryType=1&timeStamp="+(new Date).getTime()},_dateSelected:function(e,t){this.timingSendParams.timestamp=e,this.timingSendParams.sendTimeValue=t},judgeLast:function(e,t){return e.substr(e.length-1,1)==t&&(e=e.slice(0,e.length-1)),e},disposeSendPerStr:function(e,t){this.sendPerStr=t,this.sendPerStr>50?this.sendPerStr=this.sendPerStr.slice(0,50)+"...("+e+"人)":this.sendPerStr.indexOf(",")>-1?this.sendPerStr=this.sendPerStr.slice(0,this.sendPerStr.length-1)+"("+e+"人)":this.sendPerStr=this.sendPerStr.slice(0,this.sendPerStr.length)+"("+e+"人)",this.sendPerStr=this.judgeLast(this.sendPerStr,",")},getIntegrals:function(e,t,s){var a=this,i="";switch(e){case"school":i="api/message/integralSchool";break;case"collegeId":i="api/message/integralCollege?collegeId="+t;break;case"classId":i="api/message/integralClass?classId="+t;break;case"student":i="api/message/integralStudent";break;case"grades":i="api/message/integralGrades?grades="+t;break;case"educationLevels":i="api/message/integralEducationLevels?educationLevels="+t}Object(o.e)({url:i,type:"post",success:function(e){e.state?a.disposeSendPerStr(e.data,s):(a.sendPerStr=a.judgeLast(a.sendPerStr,","),a.$toast(e.message))}}).always(function(){a.showSendMan=!1})},editConsultantAfterSelected:function(e){var t=this,s=!0;this.newMembersArr.forEach(function(a,i){if(e.userId===a.userId)return t.$toast("该成员已在列表上"),void(s=!1)}),s&&this.newMembersArr.push({name:e.name,userId:e.userId,userNo:e.userNo,organizationName:e.organizationName})},deleteConsultant:function(e){var t=this;this.newMembersArr.forEach(function(s,a){s.userId===e.userId&&t.newMembersArr.splice(a,1)})},getCollDictType:function(){var e=this;Object(o.e)({url:"/api/colleges",type:"get",success:function(t){t.state?e.collDictType=t.data:e.$toast(t.message)}}).always(function(){})},getStuDictType:function(){var e=this;Object(o.e)({url:"/api/system/dicts?dictType=学生类别",type:"get",success:function(t){t.state?e.stuDictType=t.data:e.$toast(t.message)}}).always(function(){})},downItemArrayAddItem:function(e,t,s,a,i,n){var r=[];i&&n&&n.forEach&&n.forEach(function(t,a){var n={};n.pid=e,n.checked=s,n.disabled=!1,n.meta=!0,n.id=i[a],n.title=t,r.push(n)}),this.downItemArray.push({id:e,title:t,edit:!1,checked:s,number:a,children:r})},_sendSelect:function(e){var t=this,s=e.value;new Date(s).getTime()-(new Date).getTime()<0&&this.$nextTick(function(){t.timingSendParams.sendTimeValue="",t.$toast("请选择大于当前时间的日期")})},initSendData:function(){this.initSendPerIdList(),this.sendPerStr="",this.messageTitle="",this.contentValue="",this.isReceive.status=this.isReceive.list[0].id,this.isReceiveW.status=this.isReceiveW.list[0].id,this.timingSendParams.sendTimeValue="",this.timingSendParams.timingSendMan=!1},showTimingSendMan:function(){this.sendCheck()&&(this.timingSendParams.timingSendMan=!0,this.sourceDateProp=(new Date).getTime())},timingSendSure:function(){this.timingSendParams.timestamp<(new Date).getTime()?this.$toast("您设置的定时时间已经过期"):this.timingSendParams.sendTimeValue?this.immediatelySend("timing"):this.$toast("请选择时间")},urlEncode:function(e,t,s){if(null==e)return"";var a="",n=void 0===e?"undefined":i()(e);if("string"==n||"number"==n||"boolean"==n)a+="&"+t+"="+(null==s||s?encodeURIComponent(e):e);else for(var r in e){var o=null==t?r:t+(e instanceof Array?"["+r+"]":"."+r);a+=this.urlEncode(e[r],o,s)}return a},regularlySend:function(){},immediatelySendFrom:function(e){var t=this,s={content:this.contentValue,signInId:this.signId,title:this.messageTitle,excludeUserIds:this.deleteArray,notifyId:1==this.isReceive.status?1:0,signInType:this.signInType,wechatPush:1==this.isReceiveW.status};if(this.sendCheck()){var a=this,i="/api/message/iSignIn",n="post";if("timing"==e){var r=this.timingSendParams.sendTimeValue.split(" "),d=r[0].split("-"),l=r[1].split(":");data.cronExpression="00 "+l[1]+" "+l[0]+" "+d[2]+" "+d[1]+" ? "+d[0],i="/api/message/sendTiming?",n="post",this.sendLoading.sendTiming=!0}else this.sendLoading.send=!0;Object(o.e)({url:i,dataType:"json",type:n,data:s,success:function(e){e.state?(a.initSendData(),a.$toast("发送成功"),a.newMessage=!1,a.nowPage=!0,a.rows=[],a.allMessageUrl="/table-data/message/querySendMessage?queryType=1&timeStamp="+(new Date).getTime()):a.$toast(e.message)}}).always(function(){t.sendLoading.sendTiming=!1,t.sendLoading.send=!1})}},immediatelySendNow:function(e){var t=this;if(this.sendCheck()){var s=this,a="/api/message/insertByType?",i="get",n={ifSchool:this.sendPerIdList.school,collegeId:encodeURI(this.sendPerIdList.collegeId),ifStudent:this.sendPerIdList.student,classId:encodeURI(this.sendPerIdList.classId),grades:encodeURI(this.sendPerIdList.grades),educationLevels:encodeURI(this.sendPerIdList.educationLevels),toUserId:encodeURI(this.sendPerIdList.toUserId),title:s.messageTitle,content:s.contentValue,otherMessage:"",type:"3",cronExpression:"",senderId:this.userInfo.id,school:this.userInfo.schoolId,userName:this.userInfo.name,notifyId:s.isReceive.status,isWechatPush:s.isReceiveW.status};if("timing"==e){var r=this.timingSendParams.sendTimeValue.split(" "),d=r[0].split("-"),l=r[1].split(":");n.cronExpression="00 "+l[1]+" "+l[0]+" "+d[2]+" "+d[1]+" ? "+d[0],a="/api/message/sendTiming?",i="post",this.sendLoading.sendTiming=!0}else this.sendLoading.send=!0;var c=this.urlEncode(n).slice(1);Object(o.e)({url:a+c,dataType:"json",type:i,success:function(e){e.state?(s.initSendData(),s.$toast("发送成功"),s.newMessage=!1,s.nowPage=!0,s.rows=[],s.allMessageUrl="/table-data/message/querySendMessage?queryType=1&timeStamp="+(new Date).getTime()):s.$toast(e.message)}}).always(function(){t.sendLoading.sendTiming=!1,t.sendLoading.send=!1})}},immediatelySend:function(e){this.fromOutSedMessage?this.immediatelySendFrom(e):this.immediatelySendNow(e)},sendCheck:function(){if(this.sendPerStr.length)if(this.messageTitle){if(this.contentValue)return!0;this.$toast("请输入内容")}else this.$toast("请输入消息标题");else this.$toast("请选择接收人")},clickChild:function(e){var t=this,s=e.item.id,a=e.item.pid,i=-1;this.$nextTick(function(){t.downItemArray.map(function(e){a==e.id?(e.checked=!0,i=e.id):e.checked=!1,e.children.map(function(e){e.id==s?e.checked=!0:i!=e.pid&&(e.checked=!1)})})})},_itemClick:function(e,t){this.downItemArray.map(function(e,s){return e.id==t?e.checked?(e.checked=!1,e.children.map(function(e){e.checked=!1})):(e.checked=!0,e.children.map(function(e){e.checked=!0})):e.checked=!1,e}),this.selfSettingModel="5"==t},initSendPerIdList:function(){this.sendPerIdList={school:"",collegeId:[],student:"",classId:[],toUserId:[],grades:[],educationLevels:[]}},setSendPerIdList:function(e,t){var s={title:"",arr:""},a=[];return e[0].children&&e[0].children.length>0&&(e[0].children.forEach(function(e){e.checked&&(s.title+=e.title+",",a.push(e.id))}),s.arr=a),s},insure:function(){if(this.fromOutSedMessage){var e=this.$refs.tableOut.tableState.totalRecords-this.deleteArray.length;"ALL"==this.signInType?this.sendPerStr="所有需要签到的人("+e+"人)":this.sendPerStr="未签到的人("+e+"人)",this.showSendMan=!1}else{var t=this.$refs.treeMe.getChecked();this.sendPerStr="";var s=[];if(this.initSendPerIdList(),0==t.length)return void this.$toast("请选择发送人员");switch(t[0].id){case"1":this.sendPerIdList.school="true",this.getIntegrals("school","",t[0].title);break;case"2":s=this.setSendPerIdList(t),this.sendPerIdList.collegeId=s.arr,this.getIntegrals("collegeId",encodeURI(s.arr),s.title);break;case"6":s=this.setSendPerIdList(t),this.sendPerIdList.grades=s.arr,this.getIntegrals("grades",encodeURI(s.arr),s.title);break;case"7":(s=this.setSendPerIdList(t)).arr=s.arr.map(function(e){return e.substring(0,1)}),this.sendPerIdList.educationLevels=s.arr,this.getIntegrals("educationLevels",encodeURI(s.arr),s.title);break;case"3":s=this.setSendPerIdList(t),this.sendPerIdList.classId=s.arr,this.getIntegrals("classId",encodeURI(s.arr),s.title);break;case"4":this.sendPerIdList.student="true",this.getIntegrals("student","",t[0].title);break;case"5":var a=[],i="";this.rows.forEach(function(e){i+=e.name+",",a.push(e.userId)}),this.sendPerIdList.toUserId=a,this.disposeSendPerStr(this.rows.length,i),this.showSendMan=!1}}},_addMessage:function(){this.rows=[],this.newMessage=!0,this.nowPage=!1},_clearMember:function(){0!=this.rows.length&&window.confirm("删除后数据无法恢复，确定删除吗？")&&(this.rows=[],this.$toast("删除成功"))},_addMember:function(){this.showAddModal=!0,this.member={message:"",userId:"",userNo:"",userName:"",detail:""}},sureAddMember:function(){var e=this.member.detail;""!=e?(this.stuDictType.forEach(function(t){t.value==e.studentType&&(e.studentTypeD=t.label)}),this.collDictType.forEach(function(t){t.code==e.college&&(e.collegeName=t.name)}),-1==r()(this.rows).indexOf(r()(e))?(this.rows.push(e),this.showAddModal=!1):this.$toast("不能添加重复的成员!")):this.$toast("用户不存在!")},checkAddUser:function(){var e=this;Object(o.e)({url:"/api/users/"+this.member.userNo,type:"GET",success:function(t){t.state?(e.member.userId=t.data.userId,e.member.userName=t.data.name,e.member.errorMessage="",e.member.detail=t.data):(e.member.errorMessage="用户不存在",e.member.userId="",e.member.userName="",e.member.detail="",e.$toast(t.message))}})},importPageBack:function(){this.newMessage=!0,this.showSendMan=!0,this.importPage=!1},_importData:function(){this.$toast("导入功能正在升级中...")}}}),c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-manage-page",class:e.nowPage?"":"overflow-auto",attrs:{id:"messageManage"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.nowPage,expression:"nowPage"}]},[s("v-table",{attrs:{url:e.allMessageUrl,columns:e.columns,pagesize:"15",idField:"id",multiple:!1,order:!0}},[s("div",{staticClass:"pull-right",attrs:{slot:"btn-group"},slot:"btn-group"},[s("a",{staticClass:"btn clearBtnBorder",on:{click:e._addMessage}},[e._v("新建消息")])])])],1),e._v(" "),e.curMessage?s("div",{staticClass:"check-page"},[s("div",{staticClass:"check-page-header"},[s("i",{staticClass:"maticon pull-left",staticStyle:{color:"#777777",top:"5px !important","font-size":"18px !important"},domProps:{innerHTML:e._s(e.icons("arrow_back"))},on:{click:function(t){e.curMessage=null,e.nowPage=!0}}}),e._v(" "),s("span",{staticStyle:{"margin-top":"2px",display:"inline-block","font-size":"14px"}},[e._v("查看消息")])]),e._v(" "),s("div",{staticClass:"check-page-content container-fluid"},[s("div",{staticClass:"row rooo"},[s("span",{staticClass:"left-span"},[e._v("标题:")]),e._v(" "),s("span",{staticClass:"right-span"},[e._v(e._s(e.curMessage.title))])]),e._v(" "),s("div",{staticClass:"row rooo"},[s("span",{staticClass:"left-span"},[e._v("消息内容:")]),e._v(" "),s("div",{staticClass:"right-span",domProps:{innerHTML:e._s(e.curMessage.content)}})]),e._v(" "),s("div",{staticClass:"row rooo",staticStyle:{"margin-bottom":"20px"}},[s("span",{staticClass:"left-span"},[e._v("接收人:")]),e._v(" "),s("span",{staticClass:"right-span"},[e._v(e._s(e.curMessage.otherMessage))])]),e._v(" "),s("div",{staticClass:"row rooo1 pull-left"},[s("i",{staticClass:"maticon pull-left",domProps:{innerHTML:e._s(e.icons("person"))}}),e._v(" "),s("span",[e._v("  已读 "+e._s(e.readInfo.countRead)+" | 未读 "+e._s(e.readInfo.countNotRead))])]),e._v(" "),s("div",{staticClass:"row rooo2 pull-right"},[e.showTable?s("i",{staticClass:"maticon pull-left",domProps:{innerHTML:e._s(e.icons("arrow_drop_down"))},on:{click:function(t){e.showTable=!1}}}):s("i",{staticClass:"maticon pull-left",domProps:{innerHTML:e._s(e.icons("arrow_drop_up"))},on:{click:function(t){e.showTable=!0}}})]),e._v(" "),e.showTable?s("v-table",{staticClass:"table",attrs:{url:e.checkUrl,columns:e.checkColumns,pagesize:"10",idField:"id",order:!0}}):e._e()],1)]):e._e(),e._v(" "),!e.newMessage&&!e.fromOutSedMessage||e.nowPage?e._e():s("div",{staticClass:"check-page"},[s("div",{staticClass:"check-page-header"},[e.fromOutSedMessage?e._e():s("i",{staticClass:"maticon pull-left",staticStyle:{color:"#777777",cursor:"pointer"},domProps:{innerHTML:e._s(e.icons("arrow_back"))},on:{click:e.backToList}}),e._v(" "),s("span",{staticStyle:{"margin-top":"2px",display:"inline-block","font-size":"14px"}},[e._v("新建消息")])]),e._v(" "),s("div",{staticClass:"check-page-content container-fluid"},[s("div",{staticClass:"row rooo"},[s("span",{staticClass:"left-span"},[e._v("接收人:")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.sendPerStr,expression:"sendPerStr"}],attrs:{type:"text",placeholder:"选择接收人",disabled:e.showSendMan},domProps:{value:e.sendPerStr},on:{click:function(t){e.showSendMan=!0,e.deleteArray=[],e.deleteNameArray=[]},input:function(t){t.target.composing||(e.sendPerStr=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"row rooo"},[s("span",{staticClass:"left-span"},[e._v("标题:")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.messageTitle,expression:"messageTitle"}],attrs:{type:"text",placeholder:"请输入消息标题"},domProps:{value:e.messageTitle},on:{input:function(t){t.target.composing||(e.messageTitle=t.target.value)}}})]),e._v(" "),s("div",{staticClass:"row rooo",staticStyle:{height:"510px"}},[s("span",{staticClass:"left-span"},[e._v("正文:")]),e._v(" "),s("u-editor",{ref:"description",staticStyle:{display:"inline-block","vertical-align":"top",width:"80%"},attrs:{config:e.editorConfig},model:{value:e.contentValue,callback:function(t){e.contentValue=t},expression:"contentValue"}})],1),e._v(" "),s("div",{staticClass:"row rooo",staticStyle:{"flex-direction":"column"}},[s("div",{staticStyle:{"margin-left":"133px"}},[s("span",{staticClass:"left-span"},[e._v("是否需要接收者确认:")]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.isReceive.status,expression:"isReceive.status"}],staticStyle:{height:"23px","border-radius":"5px",outline:"none"},attrs:{name:"",id:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.isReceive,"status",t.target.multiple?s:s[0])}}},e._l(e.isReceive.list,function(t,a){return s("option",{key:a,domProps:{value:t.id}},[e._v(e._s(t.val))])}),0)]),e._v(" "),s("div",{staticStyle:{"margin-left":"133px"}},[s("span",{staticClass:"left-span"},[e._v("是否微信推送:")]),e._v(" "),s("select",{directives:[{name:"model",rawName:"v-model",value:e.isReceiveW.status,expression:"isReceiveW.status"}],staticStyle:{height:"23px","border-radius":"5px",outline:"none"},attrs:{name:"",id:""},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.$set(e.isReceiveW,"status",t.target.multiple?s:s[0])}}},e._l(e.isReceiveW.list,function(t,a){return s("option",{key:a,domProps:{value:t.id}},[e._v(e._s(t.val))])}),0)])]),e._v(" "),s("div",{staticClass:"row rooo"},[s("div",{staticStyle:{width:"25%","margin-left":"42%","margin-bottom":"20px"}},[s("button",{staticClass:"btn sendbtn",attrs:{type:"button",disabled:e.sendLoading.send},on:{click:function(t){return e.immediatelySend("immed")}}},[e._v("立即发送")]),e._v(" "),s("button",{staticClass:"btn sendbtn",attrs:{type:"button",disabled:e.sendLoading.sendTiming},on:{click:e.showTimingSendMan}},[e._v("定时发送")])])])])]),e._v(" "),s("v-modal",{attrs:{show:e.showSendMan,effect:"fade",width:"800"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[e._v("请选择信息接收人")])]),e._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[e.downItemArray.length&&!e.fromOutSedMessage?s("v-tree",{ref:"treeMe",attrs:{id:"resourceTree",cascade:"true",items:e.downItemArray,checkable:!0,search:!1,multiple:!1,collapsed:!1},on:{itemClick:e._itemClick,clickChild:e.clickChild}}):e.downItemArray.length||e.fromOutSedMessage?e._e():s("div",{staticClass:"empty-prompt"},[e._v("尚无权限...")]),e._v(" "),e.selfSettingModel&&!e.fromOutSedMessage?s("v-table",{attrs:{url:e.url,rows:e.rows,columns:e.columnsSetting,pagesize:"10",idField:"id",order:!0}},[s("div",{staticClass:"pull-right",attrs:{slot:"btn-group"},slot:"btn-group"},[s("a",{staticClass:"btn clearBtnBorder",on:{click:e._clearMember}},[e._v("清空")]),e._v(" "),s("a",{staticClass:"btn clearBtnBorder new message-manage-add",on:{click:e._addMember}},[s("i",{staticClass:"maticon pull-left",domProps:{innerHTML:e._s(e.icons("add"))}}),e._v("新增成员\n          ")])])]):e._e(),e._v(" "),e.fromOutSedMessage?s("div",{staticStyle:{padding:"10px 0"}},[s("span",[e._v("发送对象:  ")]),e._v(" "),s("v-select",{attrs:{options:e.OutSedMessagePeopleTypeList,value:e.signInType},on:{afterSelected:e.afterSelectedType}})],1):e._e(),e._v(" "),e.deleteNameArray.length>0?s("p",[e._v(e._s("去除人员："+e.deleteNameArray.toString(",")))]):e._e(),e._v(" "),e.fromOutSedMessage?s("v-table",{ref:"tableOut",attrs:{url:e.tableOutUrl,columns:e.columnsSetting,pagesize:"10",idField:"id",order:!0}}):e._e()],1),e._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){e.showSendMan=!1}}},[e._v("取消")]),e._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){return e.insure()}}},[e._v("确定")])])]),e._v(" "),s("v-modal",{attrs:{show:e.timingSendParams.timingSendMan,effect:"fade",width:"500"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[e._v("定时发送")])]),e._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("p",{staticClass:"send-p"},[e._v("选择定时发送时间:")]),e._v(" "),e.timingSendParams.timingSendMan?s("dateLinkage",{attrs:{sourceDateProp:e.sourceDateProp},on:{dateSelected:e._dateSelected}}):e._e(),e._v(" "),e.timingSendParams.sendTimeValue?s("p",{staticClass:"send-p"},[e._v("\n        本消息将在\n        "),s("span",{staticClass:"sign"},[e._v(e._s(e.timingSendParams.sendTimeValue))]),e._v(" 投递到对方消息盒子。\n      ")]):e._e()],1),e._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){e.timingSendParams.timingSendMan=!1}}},[e._v("取消")]),e._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:e.timingSendSure}},[e._v("确定")])])]),e._v(" "),s("v-modal",{attrs:{show:e.showAddModal,effect:"fade",width:"500"}},[s("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[s("h5",{staticClass:"modal-title"},[e._v("新增人员")])]),e._v(" "),s("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"input-label"},[e._v("学号")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.member.userNo,expression:"member.userNo"}],staticClass:"form-control search-input modal-form-style",attrs:{id:"user-no",type:"text"},domProps:{value:e.member.userNo},on:{change:e.checkAddUser,input:function(t){t.target.composing||e.$set(e.member,"userNo",t.target.value)}}}),e._v(" "),s("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:e.checkAddUser}},[e._v("检测")]),e._v(" "),s("p",{staticClass:"error-message"},[e._v(e._s(e.member.errorMessage))])]),e._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"input-label"},[e._v("姓名")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.member.userName,expression:"member.userName"}],staticClass:"form-control search-input modal-form-style",attrs:{type:"text",disabled:"disabled"},domProps:{value:e.member.userName},on:{input:function(t){t.target.composing||e.$set(e.member,"userName",t.target.value)}}})])]),e._v(" "),s("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[s("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(t){e.showAddModal=!1}}},[e._v("取消")]),e._v(" "),s("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:e.sureAddMember}},[e._v("确定")])])]),e._v(" "),e.importPage?s("v-import",e._b({on:{backParentPage:e.importPageBack}},"v-import",e.importParams,!1)):e._e()],1)},staticRenderFns:[]};var u=s("C7Lr")(l,c,!1,function(e){s("KxiM")},null,null);t.default=u.exports},"41YJ":function(e,t,s){"use strict";String,Number,Number,(new Date).getFullYear(),Number,(new Date).getFullYear();var a={props:{sourceDateProp:{type:[String,Number]},minYear:{type:Number,default:(new Date).getFullYear()},maxYear:{type:Number,default:(new Date).getFullYear()+2}},name:"date-pickers",data:function(){return{sourceDate:this.sourceDateProp,currentDate:{year:"",month:"",day:"",hour:"",minute:""},years:[],months:[],normalMaxDays:31,days:[],hours:[],minutes:[],hasError:!1}},watch:{sourceDate:{immediate:!0,handler:function(e,t){this.currentDate=this.timestampToTime(e)},deep:!0},normalMaxDays:function(){this.getFullDays(),this.currentDate.year&&this.currentDate.day>this.normalMaxDays&&(this.currentDate.day="")},currentDate:{immediate:!0,handler:function(e,t){this.judgeDay(),e.year&&e.month&&e.day&&e.hour&&e.minute?this.hasError=!1:this.hasError=!0,this.emitDate()},deep:!0}},created:function(){this.getFullYears(),this.getFullMonths(),this.getFullDays(),this.getFullHours(),this.getFullMinute()},methods:{emitDate:function(){var e=void 0,t=void 0;if(this.currentDate.year&&this.currentDate.month&&this.currentDate.day&&this.currentDate.hour&&this.currentDate.minute){var s=this.currentDate.month<10?"0"+this.currentDate.month:this.currentDate.month,a=this.currentDate.day<10?"0"+this.currentDate.day:this.currentDate.day,i=this.currentDate.hour<10?"0"+this.currentDate.hour:this.currentDate.hour,n=this.currentDate.minute<10?"0"+this.currentDate.minute:this.currentDate.minute;t=this.currentDate.year+"-"+s+"-"+a+" "+i+":"+n,e=new Date(t).getTime()}else e="",t="";this.$emit("dateSelected",e,t)},timestampToTime:function(e){var t={};if("number"==typeof e)return t.year=new Date(e).getFullYear(),t.month=new Date(e).getMonth()+1,t.day=new Date(e).getDate(),t.hour=new Date(e).getHours(),t.minute=new Date(e).getMinutes(),t},setArray:function(e,t){for(var s=void 0,a=[],i=e;i<=t;i++)(s={}).name=i.toString(),s.id=i.toString(),a.push(s);return a},getFullYears:function(){this.years=this.setArray(this.minYear,this.maxYear)},getFullMonths:function(){this.months=this.setArray(1,12)},getFullDays:function(){this.days=this.setArray(1,this.normalMaxDays)},getFullHours:function(){this.hours=this.setArray(1,24)},getFullMinute:function(){this.minutes=this.setArray(0,59)},judgeDay:function(){-1!==[4,6,9,11].indexOf(this.currentDate.month)?(this.normalMaxDays=30,this.currentDate.day&&31==this.currentDate.day&&(this.currentDate.day="")):2==this.currentDate.month?this.currentDate.year&&(this.currentDate.year%4==0&&this.currentDate.year%100!=0||this.currentDate.year%400==0)?this.normalMaxDays=29:this.normalMaxDays=28:this.normalMaxDays=31}}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"date-pickers"},[s("v-select",{staticClass:"select select-years",attrs:{options:e.years,optionsLabel:"id",optionsValue:"name",placeholder:"年"},model:{value:e.currentDate.year,callback:function(t){e.$set(e.currentDate,"year",t)},expression:"currentDate.year"}}),e._v("年\n  "),s("v-select",{staticClass:"select",attrs:{options:e.months,optionsLabel:"id",optionsValue:"name",placeholder:"月"},model:{value:e.currentDate.month,callback:function(t){e.$set(e.currentDate,"month",t)},expression:"currentDate.month"}}),e._v("月\n  "),s("v-select",{staticClass:"select",attrs:{options:e.days,optionsLabel:"id",optionsValue:"name",placeholder:"日"},model:{value:e.currentDate.day,callback:function(t){e.$set(e.currentDate,"day",t)},expression:"currentDate.day"}}),e._v("日\n  "),s("v-select",{staticClass:"select",attrs:{options:e.hours,optionsLabel:"id",optionsValue:"name",placeholder:"时"},model:{value:e.currentDate.hour,callback:function(t){e.$set(e.currentDate,"hour",t)},expression:"currentDate.hour"}}),e._v("时\n  "),s("v-select",{staticClass:"select",attrs:{options:e.minutes,optionsLabel:"id",optionsValue:"name",placeholder:"分"},model:{value:e.currentDate.minute,callback:function(t){e.$set(e.currentDate,"minute",t)},expression:"currentDate.minute"}}),e._v("分\n")],1)},staticRenderFns:[]};var n=s("C7Lr")(a,i,!1,function(e){s("nU2m")},null,null);t.a=n.exports},KxiM:function(e,t){},nU2m:function(e,t){}});