webpackJsonp([193],{"66RW":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("C331"),i={props:{role:""},data:function(){var e=this;return{orgnizationRelationArray:null,userId:"",isParentPage:!0,checkTemplateUrl:"/partyMember/excel/check",orgnazationCode:0,orgnazationArr:[{id:24699295,label:"组织关系在校",value:"11",sort:1},{id:24699297,label:"组织关系已转出",value:"12",sort:1},{id:24699299,label:"组织关系未转入",value:"13",sort:1}],partytab:this.orgnizationRelationArray?this.orgnizationRelationArray[0].value:"",definedSearch:{userNo:"",name:"",college:"",educationLevel:"",className:"",grade:"",schoolStatus:"",politicalStatus:"",organizationName:void 0,nation:"",sex:"",originPlace:""},fieldArr:[{name:"姓名",value:""},{name:"学号",value:""},{name:"性别",value:""},{name:"民族",value:""},{name:"年级",value:""},{name:"班级",value:""},{name:"学院",value:""},{name:"专业",value:""},{name:"培养层次",value:""},{name:"生源地",value:""},{name:"出生日期",value:""},{name:"政治面貌",value:""},{name:"发展入党的党组织",value:""},{name:"所属党组织",value:""},{name:"组织关系",value:""},{name:"申请入党日期",value:""},{name:"入党日期",value:""},{name:"转正日期",value:""}],check:!0,columns:"",url:"/table-data/partyMember/page/"+this.role+"/"+this.partytab,importParams:{parentPageTitle:"党员管理",downloadTemplateUrl:"/partyMember/excel/template",downloadErrorTemplateUrl:"/partyMember/excel/errorExcels",templateName:"党员管理批量编辑模板.xlsx",importBtnType:[{name:"党员管理批量编辑.xlsx",url:"/partyMember/import",method:"post",isShowBtn:!0,success:function(t){t.state&&(e.url=e.url+"?timestamp="+(new Date).getTime())}}]}}},created:function(){var e=this;Object(l.e)({url:"/api/system/dicts?dictType=组织关系",type:"get",async:!1,success:function(t){e.orgnizationRelationArray=t.data}}),this.setTab(this.orgnizationRelationArray[0].value);for(var t=(new Date).getFullYear(),a=[],i=0;i<10;i++){var r=t-i;a.push({label:r+"",value:r+""})}this.columns=[{id:"userNo",title:"学号",className:"text-left",width:130,hidden:!1,search:{type:"input",data:{placeholder:"学号"}}},{id:"name",title:"姓名",className:"text-left",width:150,hidden:!1,search:{type:"input",data:{placeholder:"姓名"}}},{id:"college",title:"学院名称",width:150,className:"text-left",hidden:!1,search:{type:"select",data:{url:"/api/partyBuild/organizations/manage/college/options",optionsLabel:"text",optionsValue:"id",placeholder:""}}},{id:"educationLevel",title:"培养层次",width:150,className:"text-left",hidden:!1,search:{type:"select",data:{url:"/api/system/dicts?dictType=培养层次",optionsLabel:"label",optionsValue:"value",placeholder:""}}},{id:"grade",title:"年级",width:150,className:"text-left",hidden:!1,search:{type:"select",data:{options:a,optionsLabel:"label",optionsValue:"value",placeholder:""}}},{id:"className",title:"班级",className:"text-left",hidden:!1,width:130,search:{type:"input",data:{placeholder:"班级"}}},{id:"schoolStatus",title:"当前状态",className:"text-left",hidden:!1,width:130,search:{type:"select",data:{url:"/api/system/dicts?dictType=在校状态",optionsLabel:"label",optionsValue:"value",placeholder:""}}},{id:"politicalStatus",title:"政治面貌",width:150,className:"text-left",hidden:!1,search:{type:"select",data:{url:"/api/system/dicts?dictType=政治面貌",optionsLabel:"label",optionsValue:"value",placeholder:""}}},{id:"organizationName",title:"所属党组织",width:150,className:"text-left",hidden:!1,formatter:function(e,t){return e.partyBuildOrganization?e.partyBuildOrganization.name:""},search:{type:"input",data:{placeholder:"所属党组织"}}},{id:"nation",title:"民族",width:150,className:"text-left",hidden:!0,search:{type:"select",data:{url:"/api/system/dicts?dictType=民族",optionsLabel:"label",optionsValue:"value",placeholder:""}}},{id:"sex",title:"性别",width:150,className:"text-left",hidden:!0,search:{type:"select",data:{url:"/api/system/dicts?dictType=性别",optionsLabel:"label",optionsValue:"value",placeholder:""}}},{id:"originPlace",title:"生源地",width:150,className:"text-left",hidden:!0,search:{type:"input",data:{placeholder:"生源地"}}},{id:"opt",className:"text-left",title:"操作",width:50,hidden:!1,formatter:function(){return[{tag:"a",text:"编辑",className:"opt-btn",callback:function(t,a){var i=e;e.userId=t.userId,Object(l.e)({url:"/api/document/students/baseStatusOrganizationInfo/"+t.userId,type:"get",async:!1,success:function(e){i.fieldArr[0].value=e.data.name,i.fieldArr[1].value=t.userNo,i.fieldArr[2].value=t.sex,i.fieldArr[3].value=e.data.nation,i.fieldArr[4].value=e.data.grade,i.fieldArr[5].value=e.data.className,i.fieldArr[6].value=e.data.college,i.fieldArr[7].value=e.data.major,i.fieldArr[8].value=e.data.educationLevel,i.fieldArr[9].value=e.data.originPlace,i.fieldArr[10].value=t.birthday,i.fieldArr[11].value=e.data.politicalStatus,i.fieldArr[12].value=e.data.studentPartyBuildInfo?e.data.studentPartyBuildInfo.recommendPartyOrganizations:"",i.fieldArr[13].value=e.data.partyBuildOrganization?e.data.partyBuildOrganization.name:"",e.data.organizationRelationship?i.fieldArr[14].value=e.data.organizationRelationship:i.fieldArr[14].value="",i.fieldArr[15].value=e.data.studentPartyBuildInfo?e.data.studentPartyBuildInfo.applyTime:"",i.fieldArr[16].value=e.data.studentPartyBuildInfo?e.data.studentPartyBuildInfo.joinTime:"",i.fieldArr[17].value=e.data.studentPartyBuildInfo?e.data.studentPartyBuildInfo.correctionTime:""}}),e.check=!1}}]}}]},methods:{orgnazationSelected:function(e){var t=this;e.value?(e.value!=this.fieldArr[14].value&&Object(l.e)({url:"/api/document/students/organizationRelationship/"+this.userId+"?organizationRelationship="+e.value,type:"post",async:!1,success:function(e){t.$toast("修改组织关系成功！")}}),this.fieldArr[14].value=e.value):this.$toast("只能切换，不能取消哦！")},batchSet:function(){this.isParentPage=!1},backParentPage:function(){this.isParentPage=!0},setTab:function(e){this.partytab=e,this.orgnazationCode=e,this.url="/table-data/partyMember/page/"+this.role+"/"+this.orgnazationCode},_backList:function(){this.check=!0},exportStat:function(){var e="/downloads/partyMember/excels/"+this.role+"/"+this.orgnazationCode,t=this.$refs.partyTrainTable.tableSearchFields,a=!1,l="";for(var i in t)t[i]&&(a=!0,l+=i+"="+t[i]+"&");a&&(e=e+"?"+l),window.location.href=e}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isParentPage?a("div",{staticClass:"container-fluid",attrs:{id:"party-train-manage"}},[e.check?a("div",{staticClass:"tab-div"},e._l(e.orgnizationRelationArray,function(t){return a("div",{staticClass:"tab",class:e.partytab==t.value?"active":"",attrs:{title:t.label},on:{click:function(a){return e.setTab(t.value)}}},[e._v(e._s(t.label))])}),0):e._e(),e._v(" "),e.check?a("v-table",{ref:"partyTrainTable",attrs:{columns:e.columns,searchParams:e.definedSearch,url:e.url,idField:"id",search:!1,pagesize:"10",order:"true",columnsControl:!0}},[a("div",{attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("div",{staticClass:"btn-group pull-right"},[a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:e.batchSet}},[e._v("批量编辑")]),e._v(" "),a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",attrs:{type:"button"},on:{click:e.exportStat}},[e._v("导出")])])])]):e._e(),e._v(" "),e.check?e._e():a("div",{staticClass:"box-wrap"},[a("div",{staticClass:"title-div"},[a("button",{staticClass:"btn back-btn clearBtnBorder btnclass",attrs:{type:"button"},on:{click:e._backList}},[a("i",{staticClass:"maticon back-icon-btn",domProps:{innerHTML:e._s(e.icons("arrow_back"))}},[e._v("arrow_back")]),e._v(" "),a("span",{staticClass:"nav-title"},[e._v("返回党员管理")])])]),e._v(" "),a("p",{staticStyle:{"font-weight":"600","padding-left":"10px"}},[e._v("基本信息：")]),e._v(" "),e._l(e.fieldArr,function(t,l){return l<=10?a("div",{staticClass:"item"},[a("p",[e._v(e._s(t.name))]),e._v(" "),a("p",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.fieldArr[l].value,expression:"fieldArr[index].value"}],staticClass:"form-control",attrs:{type:"text",disabled:"true"},domProps:{value:e.fieldArr[l].value},on:{input:function(t){t.target.composing||e.$set(e.fieldArr[l],"value",t.target.value)}}})])]):e._e()}),e._v(" "),a("p",{staticStyle:{"font-weight":"600","padding-left":"10px"}},[e._v("入党信息：")]),e._v(" "),e._l(e.fieldArr,function(t,l){return l>10?a("div",{staticClass:"item"},[a("p",[e._v(e._s(t.name))]),e._v(" "),a("p",[14!==l?a("input",{directives:[{name:"model",rawName:"v-model",value:e.fieldArr[l].value,expression:"fieldArr[index].value"}],staticClass:"form-control",attrs:{type:"text",disabled:"true"},domProps:{value:e.fieldArr[l].value},on:{input:function(t){t.target.composing||e.$set(e.fieldArr[l],"value",t.target.value)}}}):a("v-select",{staticClass:"btn-block search-select",attrs:{id:"sele",options:e.orgnizationRelationArray,value:e.fieldArr[14].value,"options-value":"value","options-label":"label"},on:{afterSelected:e.orgnazationSelected}})],1)]):e._e()})],2)],1):a("v-import",e._b({attrs:{checkTemplateUrl:e.checkTemplateUrl},on:{backParentPage:e.backParentPage}},"v-import",e.importParams,!1))},staticRenderFns:[]};var n=a("C7Lr")(i,r,!1,function(e){a("kUN6")},null,null);t.default=n.exports},kUN6:function(e,t){}});