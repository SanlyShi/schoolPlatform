webpackJsonp([12],{"2DtH":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("4DA3"),a=r("b1Wg"),o=r("C331"),i=r("Gme2"),n=r("8c0Y"),l=(r("0Nqt"),s.a,a.a,i.a,n.a,{name:"employmentRegister",components:{linkage:s.a,UEditor:a.a,EmHeader:i.a,EmUser:n.a},data:function(){var e=this;return{title:{name:"就业管理系统",url:"employmentPlatform"},pageType:1,curStep:0,formEmail:{email:""},ruleEmail:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:["blur","change"]}]},formPsd:{password:"",checkPsd:""},rulePsd:{password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:25,message:"只能输入6-25位密码"},{validator:function(e,t,r){if(!/^(?![0-9]+$)(?![a-zA-Z]+$)[0-9A-Za-z]{6,25}$/.test(t))return r("密码必须包含数字和字母");r()},trigger:"blur"}],checkPsd:[{required:!0,message:"请再次输入密码"},{validator:function(t,r,s){if(r!==e.formPsd.password)return s("两次输入的密码不一致");s()},trigger:"blur"}]},formInfo:{companyName:"",creditCode:"",province:"",city:"",area:"",address:"",business:"",scale:"",property:"",labels:[],contactPerson:"",contactPhone:"",telephone:"",email:"",fax:"",postalCode:"",website:"",introduction:"",invoice:"",taxpayerId:"",legalPerson:"",registerFund:"",establishment:"",licenseImg:"",licenseDue:"",isLongTerm:!1},dataKey:"",ruleInfo:{companyName:[{required:!0,message:"请输入单位名称",trigger:"blur"},{max:50,message:"单位名称过长",trigger:"blur"}],creditCode:[{required:!0,message:"请输入统一社会信用代码",trigger:"blur"},{max:18,message:"统一社会信用代码过长",trigger:"blur"}],location:[{validator:function(t,r,s){if(!e.formInfo.province||!e.formInfo.city)return s("请选择单位所在地");s()},trigger:"change"}],address:[{required:!0,message:"请输入单位地址",trigger:"blur"},{max:50,message:"单位地址过长",trigger:"blur"}],business:[{required:!0,message:"请选择所属行业",trigger:"change"}],scale:[{required:!0,message:"请选择单位规模",trigger:"change"}],property:[{required:!0,message:"请选择单位性质",trigger:"change"}],labels:[],contactPerson:[{required:!0,message:"请输入联系人",trigger:"blur"},{max:18,message:"联系人过长",trigger:"blur"}],contactPhone:[{required:!0,message:"请输入手机号",trigger:"blur"},{max:18,message:"手机号过长",trigger:"blur"},{validator:function(e,t,r){if(!/^1[34578]\d{9}$/.test(t))return r("请输入正确格式的手机号码");r()},trigger:"blur"}],telephone:[{required:!0,message:"请输入单位电话",trigger:"blur"},{max:18,message:"单位电话过长",trigger:"blur"}],email:[{required:!0,message:"请输入单位电子邮箱",trigger:"blur"},{type:"email",message:"请输入正确格式的邮箱",trigger:"blur"}],fax:[{max:18,message:"单位传真过长",trigger:"blur"}],postalCode:[{max:18,message:"单位邮编过长",trigger:"blur"},{validator:function(e,t,r){if(void 0!==t&&""!==t&&!/^[0-9]*$/.test(t))return r("单位邮编必须为数字值");r()},trigger:"blur"}],website:[{max:50,message:"单位网址过长",trigger:"blur"}],introduction:[{required:!0,message:"请输入单位介绍",trigger:"blur"},{max:6e4,message:"单位介绍过长",trigger:"blur"}],invoice:[{required:!0,message:"请输入发票抬头",trigger:"blur"},{max:32,message:"发票抬头过长",trigger:"blur"}],taxpayerId:[{required:!0,message:"请输入纳税人识别号",trigger:"blur"},{max:32,message:"纳税人识别号过长",trigger:"blur"}],legalPerson:[{required:!0,message:"请输入公司法人代表",trigger:"blur"},{max:18,message:"公司法人代表过长",trigger:"blur"}],registerFund:[{validator:function(e,t,r){if(void 0!==t&&""!==t&&!/^[0-9]+\.?[0-9]*$/.test(t))return r("注册资金必须是数字值");r()},trigger:"blur"}],establishment:[{required:!0,message:"请选择单位成立日期",trigger:"change"}],licenseImg:[{required:!0,message:"请上传营业执照",trigger:"change"},{max:200,message:"营业执照资源链接过长",trigger:"blur"}],licenseDue:[{validator:function(t,r,s){if(!(e.formInfo.isLongTerm||""!==r&&void 0!==r))return s();s()},trigger:"change"}]},businessList:[],scaleList:[],propertyList:[],labelList:[],licenseImgSrc:"",userId:""}},methods:{starEncrypt:function(e){var t=e.replace(/([@][^@]+)$/,""),r=e.match(/([^@]+)$/)[1],s="******"+r;switch(t.length){case 1:case 2:case 3:case 4:break;case 5:case 6:case 7:s=t.substr(0,1)+"******"+t.substr(t.length-1,t.length)+r;break;case 8:case 9:case 10:s=t.substr(0,2)+"******"+t.substr(t.length-2,t.length)+r;break;default:s=t.substr(0,3)+"******"+t.substr(t.length-3,t.length)+r}return s},waitEdit:function(){this.$router.push("/default/login/employment")},handleCheckedLabelChange:function(e){this.formInfo.labels=e},getCurrentStep:function(){},nextStep:function(){this.curStep++},submitEmail:function(){var e=this,t=this;t.$refs.formEmail.validate(function(r){if(!r)return t.$message.error("邮箱格式不正确"),!1;Object(o.e)({url:"/api/employment/certifications/register",type:"post",data:{userMail:t.formEmail.email,confirmUrl:"employment/register"},success:function(r){if(r.state){var s="注册邮件已发送至"+t.formEmail.email.replace(t.formEmail.email.substring(3,7),"****")+",请注意查收";e.$message.success(s),t.curStep=1}else e.$message.error(r.message)}})})},licenseChange:function(e){e&&(this.formInfo.licenseDue="")},dateChange:function(e){e&&(this.formInfo.isLongTerm=!1)},daySelected:function(e){e.value&&(this.formInfo.isLongTerm=!1)},licenseUpload:function(){document.getElementById("upload-file").click()},_fileHeadUpload:function(e){var t=this,r=new FormData;r.append("file",e.target.files[0]),r.append("fieldName",e.target.files[0].name);e.target.files[0].name;var s=this;Object(o.e)({url:"/upload/storage/images",type:"post",data:r,contentType:!1,processData:!1,success:function(e){"88888"===e.code?(t.licenseImgSrc=e.data.hash,t.formInfo.licenseImg=e.data.hash):s.$toast(e.message)}}).always(function(){})},resendEmail:function(){var e=this,t=this;Object(o.e)({url:"/api/employment/certifications/register",type:"post",data:{userMail:t.formEmail.email,confirmUrl:"employment/register"},success:function(r){r.state?(e.$message.success("发送成功,请注意查收"),t.curStep=1):e.$message.error(r.message)}})},submitPsd:function(){var e=this,t=this;this.$refs.formPsd.validate(function(r){if(!r)return t.$message.error("请根据提示正确填写"),!1;Object(o.e)({url:"/api/employment/certifications/activeAccount",type:"post",data:{dataKey:t.dataKey,userPassword:t.formPsd.password},success:function(r){r.state?(e.$message.success("密码设置成功"),e.userId=r.data.userId,t.curStep=3):e.$message.error(r.message)}})})},submitInfo:function(){var e=this,t=this,r=this.formInfo,s={userId:this.userId,companyName:r.companyName,companyCode:r.creditCode,contactPeople:r.contactPerson,contactPhone:r.contactPhone,fax:r.fax,companyUrl:r.website,postcode:r.postalCode,address:r.area,addressDetail:r.address,license:r.licenseImg,industry:r.business,property:r.property,summary:r.introduction.replace(/<[^>]+>|&[^>]+;/g,"").trim(),companyRepresentative:r.legalPerson,licenseTime:1==r.isLongTerm?null:r.licenseDue+" 00:00:00",isLong:r.isLongTerm?1:0,registeredCapital:Number(r.registerFund),officePhone:r.telephone,scale:r.scale,invoiceTitle:r.invoice,taxpayerNumber:r.taxpayerId,companyCreateTime:r.establishment?r.establishment+" 00:00:00":null,label:r.labels.join(","),companyMailAddress:r.email};t.$refs.formInfo.validate(function(a){return a?s.licenseTime||1==r.isLongTerm?void Object(o.e)({url:"/api/employment/company/addCompany",type:"post",data:s,success:function(r){r.state?(e.$toast("已完善信息,请登录"),t.$router.push("/default/login/employment")):t.$message.error("提交信息出错")}}):(t.$message.error("营业执照或者组织机构代码证到期时间"),!1):(t.$message.error("请根据提示正确填写信息"),!1)})},editLater:function(){},beforeUpload:function(e){if(!(e.size/1024/1024<10))return this.$message.error("上传图片大小不能超过 10MB!"),!1},uploadSuccess:function(e,t){this.licenseImgSrc="/upload/storage/images/"+e.data.hash,this.formInfo.licenseImg=e.data.hash},getLocation:function(e){e.area&&(this.formInfo.area=e.area.id),this.formInfo.province=e.province.id,this.formInfo.city=e.city.id},getIntroduction:function(e){this.formInfo.introduction=e},activeAccount:function(){this.dataKey=this.$route.query.dataKey,this.dataKey&&(this.curStep=2)},getDictListByType:function(e,t){var r=this;Object(o.e)({url:"/api/employment/system/findDictByTypeName",type:"get",data:{typeName:e},success:function(e){r[t]=e.data}})}},beforeCreate:function(){document.querySelector("body").setAttribute("style","background-color:#fff")},beforeDestroy:function(){document.querySelector("body").removeAttribute("style")},created:function(){this.activeAccount(),this.getDictListByType("单位行业","businessList"),this.getDictListByType("单位规模","scaleList"),this.getDictListByType("单位性质","propertyList"),this.getDictListByType("单位标签","labelList")}}),c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"employmentRegister"}},[r("div",{staticClass:"header"},[r("em-header",{attrs:{title:e.title}},[r("em-user",{attrs:{slot:"top-nav",pageType:e.pageType},slot:"top-nav"})],1)],1),e._v(" "),r("div",{staticClass:"content"},[r("div",{staticClass:"employment-register"},[r("div",{staticClass:"register-step"},[r("el-steps",{attrs:{active:e.curStep+1,"align-center":""}},[r("el-step",{attrs:{title:"填写邮箱"}},[r("div",{attrs:{slot:"icon"},slot:"icon"},[e._v("1")])]),e._v(" "),r("el-step",{attrs:{title:"验证邮箱"}},[r("div",{attrs:{slot:"icon"},slot:"icon"},[e._v("2")])]),e._v(" "),r("el-step",{attrs:{title:"设置密码"}},[r("div",{attrs:{slot:"icon"},slot:"icon"},[e._v("3")])]),e._v(" "),r("el-step",{attrs:{title:"完善信息"}},[r("div",{attrs:{slot:"icon"},slot:"icon"},[e._v("4")])])],1)],1),e._v(" "),r("div",{staticClass:"register-content"},[r("div",{directives:[{name:"show",rawName:"v-show",value:0===e.curStep,expression:"curStep===0"}],staticClass:"register-formEmail"},[r("el-form",{ref:"formEmail",attrs:{model:e.formEmail,rules:e.ruleEmail}},[r("el-form-item",{attrs:{prop:"email"}},[r("el-input",{attrs:{type:"email",placeholder:"请输入邮箱"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitEmail(t)}},model:{value:e.formEmail.email,callback:function(t){e.$set(e.formEmail,"email",t)},expression:"formEmail.email"}})],1),e._v(" "),r("el-form-item",{staticStyle:{display:"none"}},[r("el-input",{attrs:{type:"password"}})],1),e._v(" "),r("div",{staticClass:"message"},[r("span",{staticClass:"text-red"},[e._v("*")]),e._v(" "),r("span",{staticClass:"text"},[e._v("您可以使用此邮箱登录或找回密码，请勿随意泄漏邮箱地址，以免被不法分子利用")])]),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.submitEmail}},[e._v("下一步")])],1)],1)],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:1===e.curStep,expression:"curStep===1"}],staticClass:"register-verify"},[r("div",[r("span",{staticClass:"text"},[e._v("激活邮箱已发送至您的邮箱")]),e._v(" "),r("span",{staticClass:"font-weight"},[e._v(e._s(e.formEmail.email.replace(e.formEmail.email.substring(3,7),"****")))]),e._v(" "),r("span",{staticClass:"text"},[e._v("，请前往验证，完成继续注册")])]),e._v(" "),r("div",{staticClass:"no-receive"},[e._v("\n            没有收到？\n          ")]),e._v(" "),r("div",[r("el-button",{attrs:{type:"primary"},on:{click:e.resendEmail}},[e._v("重新发送")])],1)]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:2===e.curStep,expression:"curStep===2"}],staticClass:"register-password"},[r("el-form",{ref:"formPsd",attrs:{model:e.formPsd,rules:e.rulePsd,"label-width":"80px","label-position":"right"}},[r("el-form-item",{attrs:{prop:"password",label:"密码"}},[r("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitPsd(t)}},model:{value:e.formPsd.password,callback:function(t){e.$set(e.formPsd,"password",t)},expression:"formPsd.password"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"checkPsd",label:"确认密码"}},[r("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitPsd(t)}},model:{value:e.formPsd.checkPsd,callback:function(t){e.$set(e.formPsd,"checkPsd",t)},expression:"formPsd.checkPsd"}})],1)],1),e._v(" "),r("div",[r("el-button",{attrs:{type:"primary"},on:{click:e.submitPsd}},[e._v("确定")])],1)],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:3===e.curStep,expression:"curStep===3"}],staticClass:"register-info"},[r("el-form",{ref:"formInfo",attrs:{model:e.formInfo,rules:e.ruleInfo,"label-width":"280px","label-position":"right"}},[r("el-form-item",{attrs:{label:"单位名称",prop:"companyName"}},[r("el-input",{model:{value:e.formInfo.companyName,callback:function(t){e.$set(e.formInfo,"companyName",t)},expression:"formInfo.companyName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"统一社会信用代码",prop:"creditCode"}},[r("el-input",{model:{value:e.formInfo.creditCode,callback:function(t){e.$set(e.formInfo,"creditCode",t)},expression:"formInfo.creditCode"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"location"}},[r("div",{attrs:{slot:"label"},slot:"label"},[r("span",{staticClass:"text-red"},[e._v("*")]),e._v("单位所在地")]),e._v(" "),r("div",{staticClass:"location"},[r("linkage",{attrs:{showArea:!0},on:{getData:e.getLocation}})],1)]),e._v(" "),r("el-form-item",{attrs:{label:"单位地址",prop:"address"}},[r("el-input",{model:{value:e.formInfo.address,callback:function(t){e.$set(e.formInfo,"address",t)},expression:"formInfo.address"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"所属行业",prop:"business"}},[r("el-select",{model:{value:e.formInfo.business,callback:function(t){e.$set(e.formInfo,"business",t)},expression:"formInfo.business"}},e._l(e.businessList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"单位规模",prop:"scale"}},[r("el-select",{model:{value:e.formInfo.scale,callback:function(t){e.$set(e.formInfo,"scale",t)},expression:"formInfo.scale"}},e._l(e.scaleList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"单位性质",prop:"property"}},[r("el-select",{model:{value:e.formInfo.property,callback:function(t){e.$set(e.formInfo,"property",t)},expression:"formInfo.property"}},e._l(e.propertyList,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"单位标签",prop:"labels"}},[r("el-checkbox-group",{on:{change:e.handleCheckedLabelChange},model:{value:e.formInfo.labels,callback:function(t){e.$set(e.formInfo,"labels",t)},expression:"formInfo.labels"}},e._l(e.labelList,function(t){return r("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.label))])}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"联系人",prop:"contactPerson"}},[r("el-input",{model:{value:e.formInfo.contactPerson,callback:function(t){e.$set(e.formInfo,"contactPerson",t)},expression:"formInfo.contactPerson"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"手机号",prop:"contactPhone"}},[r("el-input",{model:{value:e.formInfo.contactPhone,callback:function(t){e.$set(e.formInfo,"contactPhone",t)},expression:"formInfo.contactPhone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"单位电子邮箱：",prop:"email"}},[r("el-input",{model:{value:e.formInfo.email,callback:function(t){e.$set(e.formInfo,"email",t)},expression:"formInfo.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"单位电话",prop:"telephone"}},[r("el-input",{model:{value:e.formInfo.telephone,callback:function(t){e.$set(e.formInfo,"telephone",t)},expression:"formInfo.telephone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"单位传真"}},[r("el-input",{model:{value:e.formInfo.fax,callback:function(t){e.$set(e.formInfo,"fax",t)},expression:"formInfo.fax"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"单位邮编"}},[r("el-input",{model:{value:e.formInfo.postalCode,callback:function(t){e.$set(e.formInfo,"postalCode",t)},expression:"formInfo.postalCode"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"单位网址"}},[r("el-input",{model:{value:e.formInfo.website,callback:function(t){e.$set(e.formInfo,"website",t)},expression:"formInfo.website"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"发票抬头",prop:"invoice"}},[r("el-input",{model:{value:e.formInfo.invoice,callback:function(t){e.$set(e.formInfo,"invoice",t)},expression:"formInfo.invoice"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"纳税人识别号",prop:"taxpayerId"}},[r("el-input",{model:{value:e.formInfo.taxpayerId,callback:function(t){e.$set(e.formInfo,"taxpayerId",t)},expression:"formInfo.taxpayerId"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"公司法人代表",prop:"legalPerson"}},[r("el-input",{model:{value:e.formInfo.legalPerson,callback:function(t){e.$set(e.formInfo,"legalPerson",t)},expression:"formInfo.legalPerson"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"注册资金",prop:"registerFund"}},[r("el-input",{model:{value:e.formInfo.registerFund,callback:function(t){e.$set(e.formInfo,"registerFund",t)},expression:"formInfo.registerFund"}},[r("template",{slot:"append"},[e._v("万")])],2)],1),e._v(" "),r("el-form-item",{attrs:{label:"单位成立日期",prop:"establishment"}},[r("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"请选择日期"},model:{value:e.formInfo.establishment,callback:function(t){e.$set(e.formInfo,"establishment",t)},expression:"formInfo.establishment"}})],1),e._v(" "),r("el-form-item",{class:{hasLicense:""!=e.formInfo.licenseImg&&null!=e.formInfo.licenseImg},attrs:{label:"营业执照或者组织机构代码证",prop:"licenseImg"}},[r("div",{staticClass:"avatar-uploader"},[""==e.formInfo.licenseImg||null==e.formInfo.licenseImg?r("i",[r("p",{staticClass:"tips"},[r("span",[e._v("+ 上传营业执照")]),e._v(" "),r("em",[e._v('只能上传bmp、"jpg"、"jpeg"、"png"、"gif"文件，且不超过20M')])])]):e._e(),e._v(" "),r("input",{ref:"licenseUpload",staticClass:"upload-template",attrs:{type:"file",id:"upload-file"},on:{change:e._fileHeadUpload}}),e._v(" "),e.licenseImgSrc?r("img",{staticClass:"licenseImg",attrs:{src:"/upload/storage/images/"+e.licenseImgSrc+".jpg"},on:{click:e.licenseUpload}}):e._e()])]),e._v(" "),r("el-form-item",{attrs:{label:"单位介绍",prop:"introduction"}},[r("u-editor",{on:{change:e.getIntroduction},model:{value:e.formInfo.introduction,callback:function(t){e.$set(e.formInfo,"introduction",t)},expression:"formInfo.introduction"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"licenseDue"}},[r("div",{attrs:{slot:"label"},slot:"label"},[r("span",{staticClass:"text-red"},[e._v("*")]),e._v("营业执照或者组织机构代码证到期时间")]),e._v(" "),r("div",{staticClass:"license"},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},on:{change:e.dateChange},model:{value:e.formInfo.licenseDue,callback:function(t){e.$set(e.formInfo,"licenseDue",t)},expression:"formInfo.licenseDue"}}),e._v(" "),r("el-checkbox",{on:{change:e.licenseChange},model:{value:e.formInfo.isLongTerm,callback:function(t){e.$set(e.formInfo,"isLongTerm",t)},expression:"formInfo.isLongTerm"}},[e._v("长期")])],1)]),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.waitEdit}},[e._v("稍后完善信息")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.submitInfo}},[e._v("完成注册")])],1)],1)],1)])])])])},staticRenderFns:[]};var m=r("C7Lr")(l,c,!1,function(e){r("R/XO"),r("KJAE"),r("jeiD")},"data-v-16f526cb",null);t.default=m.exports},KJAE:function(e,t){},"R/XO":function(e,t){},jeiD:function(e,t){}});