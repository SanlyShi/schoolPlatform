webpackJsonp([281],{"7b3j":function(t,e){},"CHp+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("68u/"),n("YXeK");var a=n("EA6R"),o=n.n(a),s=n("aA9S"),i=n.n(s),r=n("3cXf"),c=n.n(r),l=n("lC5x"),d=n.n(l),u=n("J0Oq"),p=n.n(u),f=n("IwLe"),w=n("VDkK"),g=n("hn+R"),v=n("Se9A"),m=n("N9Ox"),h=n("T6UY"),x=n("WD6V"),S=n("fSJ2"),b=n("t7Ya"),_=(f.a,w.a,g.a,v.a,m.a,h.a,x.a,{props:["id"],components:{BaseInfo:f.a,StandInfo:w.a,StandPicker:g.a,ModuleContainer:v.a,ModuleLoader:m.a,StandUnit:h.a,Oplog:x.a},data:function(){var t=this;return{dcw:null,page:"DETAIL",loading:!0,showOpLogs:!1,standUnitId:null,exportStandDialog:{show:!1,selectAll:!1,fields:[{value:"1",text:"单位名称"},{value:"2",text:"单位性质"},{value:"3",text:"联系人信息"},{value:"4",text:"单位邮箱"},{value:"5",text:"单位规模"},{value:"6",text:"展位信息"},{value:"7",text:"招聘信息"}],selected:[]},arrangeStandDialog:{show:!1,importParams:{downloadTemplateUrl:"/employment/manage/doubleChoose/getBoothTemplate?id="+this.id,downloadErrorTemplateUrl:"/iSignIn/projects/excludeList/excels/error",checkTemplateUrl:"/employment/manage/doubleChoose/checkExcel?id="+this.id,importBtnType:[{name:"增量导入",url:"/employment/manage/doubleChoose/addByExcel",method:"post",isShowBtn:!0,success:function(){t.arrangeStandDialog.show=!1,t.refreshStandUnits()}}],templateName:"排展管理模板下载",showBackBtn:!1}},isEditingDcw:!1,dcwTemp:null,rules:{chooseType:{disabled:!0}}}},computed:{opLogDataUrl:function(){return"api/employment/manage/doubleChoose/getOperationDetailList?id="+this.id},standUnits:function(){return[{standName:"1",unitName:"tenxun"}]},allExportStandFieldsSelected:function(){return this.exportStandDialog.fields.length===this.exportStandDialog.selected.length}},created:function(){var t=this;return p()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.initDcw();case 2:t.loading=!1;case 3:case"end":return e.stop()}},e,t)}))()},methods:{initDcw:function(){var t=this;return p()(d.a.mark(function e(){var n;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.dcw.get(t.id);case 2:(n=e.sent).state?t.dcw=b.a.fromApi(n.data):t.$toast(n.message);case 4:case"end":return e.stop()}},e,t)}))()},toEditDcw:function(){var t=this;return p()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.dcwTemp=JSON.parse(c()(t.dcw)),t.isEditingDcw=!0;case 2:case"end":return e.stop()}},e,t)}))()},updateDcw:function(){var t=this;return p()(d.a.mark(function e(){var n,a,o;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.dcw.update(t.dcw);case 2:n=e.sent,a=n.state,o=n.message,a?(t.$toast("保存成功"),t.dcwTemp=null,t.isEditingDcw=!1):t.$toast(o);case 6:case"end":return e.stop()}},e,t)}))()},cancelEditDcw:function(){var t=this;return p()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i()(t.dcw.baseInfo,t.dcwTemp.baseInfo),t.dcw.standInfo.siteMap=t.dcwTemp.standInfo.siteMap,t.dcw.standInfo.canSelectMultiStands=t.dcwTemp.standInfo.canSelectMultiStands,t.dcw.standInfo.limitStandsSelected=t.dcwTemp.standInfo.limitStandsSelected,t.dcw.standInfo.limitStandsSelected=t.dcwTemp.standInfo.limitStandsSelected,t.dcw.standInfo.chooseType=t.dcwTemp.standInfo.chooseType,t.isEditingDcw=!1;case 7:case"end":return e.stop()}},e,t)}))()},toExportStand:function(){this.exportStandDialog.show=!0,this.selectAllExportStandFields()},toArrangeStand:function(){this.arrangeStandDialog.show=!0},selectAllExportStandFields:function(t){this.exportStandDialog.selected=t?this.exportStandDialog.fields.map(function(t){return t.value}):[]},exportStand:function(){var t=this;return p()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.open("/downloads/employment/manage/doubleChoose/getBoothExcel?id="+t.dcw.id+"&conditions="+t.exportStandDialog.selected.sort(function(t,e){return parseInt(t)-parseInt(e)}).join(",")),t.exportStandDialog.show=!1;case 2:case"end":return e.stop()}},e,t)}))()},showStandUnit:function(t){this.standUnitId=t.id,this.page="STAND_UNIT"},refreshStandUnits:function(){var t=this;return p()(d.a.mark(function e(){var n,a,o,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.dcw.get(t.id);case 2:n=e.sent,a=n.state,o=n.message,s=n.data,a?t.dcw=b.a.fromApi(s):t.$toast(o);case 7:case"end":return e.stop()}},e,t)}))()},deleteStandUnit:function(t,e){var n=this;return p()(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o.a.confirm("确认要取消"+t.name+"的双选会吗？下架后该企业将无法展示在该双选会的列表上").then(p()(d.a.mark(function e(){var a,o,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.stand.deleteStandUnit(t.stand&&t.stand.id,t.id);case 2:if(a=e.sent,o=a.state,s=a.message,!o){e.next=13;break}return n.$toast("取消展位成功"),n.loading=!0,e.next=10,n.initDcw();case 10:n.loading=!1,e.next=14;break;case 13:n.$toast(s);case 14:case"end":return e.stop()}},e,n)})));case 1:case"end":return e.stop()}},e,n)}))()},sign:function(t,e){var n=this;return p()(d.a.mark(function a(){var s;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:s=e?"取消签到":"签到",o.a.confirm("是否"+s).then(p()(d.a.mark(function a(){var o,s,i;return d.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,S.a.stand.setSign(t,!e);case 2:if(o=a.sent,s=o.state,i=o.message,!s){a.next=12;break}return n.loading=!0,a.next=9,n.initDcw();case 9:n.loading=!1,a.next=13;break;case 12:n.$toast(i);case 13:case"end":return a.stop()}},a,n)}))).catch(function(){n.$message({type:"info",message:"已取消"+s})});case 3:case"end":return a.stop()}},a,n)}))()},toReserveDcw:function(){this.standUnitId=null,this.page="STAND_UNIT"},backToDetail:function(t){var e=this,n=t.refresh;return p()(d.a.mark(function t(){return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.page="DETAIL",!n){t.next=6;break}return e.loading=!0,t.next=5,e.initDcw();case 5:e.loading=!1;case 6:case"end":return t.stop()}},t,e)}))()},backToList:function(){this.$emit("back-to-list")}}}),D={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["DETAIL"===t.page?n("div",[n("div",{staticClass:"back",on:{click:t.backToList}},[n("i",{staticClass:"el-icon-back"}),t._v("返回\n    ")]),t._v(" "),t.loading?n("module-loader",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]}):n("div",{staticClass:"module-container"},[n("base-info",{attrs:{edit:t.isEditingDcw,rules:t.rules},model:{value:t.dcw.baseInfo,callback:function(e){t.$set(t.dcw,"baseInfo",e)},expression:"dcw.baseInfo"}}),t._v(" "),n("stand-info",{attrs:{rules:t.rules,inline:"",edit:t.isEditingDcw},model:{value:t.dcw.standInfo,callback:function(e){t.$set(t.dcw,"standInfo",e)},expression:"dcw.standInfo"}}),t._v(" "),t.isEditingDcw?n("module-container",{attrs:{actions:""}},[n("el-button",{attrs:{size:"large"},on:{click:t.cancelEditDcw}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"large"},on:{click:t.updateDcw}},[t._v("保存")])],1):t._e(),t._v(" "),n("module-container",{attrs:{title:"展位"}},["UNIT"===t.dcw.standInfo.chooseType?n("div",{staticClass:"stand-manage"},[n("stand-picker",{attrs:{dcw:t.dcw,"can-manage":"",published:""},on:{"to-reserve-dcw":t.toReserveDcw},model:{value:t.dcw.standInfo.stands,callback:function(e){t.$set(t.dcw.standInfo,"stands",e)},expression:"dcw.standInfo.stands"}})],1):t._e(),t._v(" "),n("div",{staticClass:"stand-units"},[n("div",{staticClass:"actions"},["MANAGER"===t.dcw.standInfo.chooseType?n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.toReserveDcw}},[t._v("预留展位")]):t._e(),t._v(" "),"MANAGER"===t.dcw.standInfo.chooseType?n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.toArrangeStand}},[t._v("排展管理")]):t._e(),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.toExportStand}},[t._v("导出名单")])],1),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.dcw.standUnits}},[n("el-table-column",{attrs:{prop:"stand.name",label:"展位号",width:"80"}}),t._v(" "),n("el-table-column",{attrs:{prop:"name",label:"用人单位",width:"260"}}),t._v(" "),n("el-table-column",{attrs:{prop:"typeName",label:"单位性质",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"positionsCount",label:"职位总数",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"signInStatus",label:"签到状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row.signInStatus?"已签到":"未签到"))])]}}],null,!1,3012385307)}),t._v(" "),n("el-table-column",{attrs:{prop:"opt",label:"操作",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.showStandUnit(e.row)}}},[t._v("查看")]),t._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.deleteStandUnit(e.row,e.$index)}}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.sign(e.row.id,e.row.signInStatus)}}},[t._v(t._s(e.row.signInStatus?"取消签到":"签到"))])]}}],null,!1,1920577258)})],1)],1)]),t._v(" "),n("div",{staticClass:"operations-container-action"},[n("el-button",{attrs:{type:"text"},on:{click:function(e){t.showOpLogs=!t.showOpLogs}}},[t._v("操作日志")]),t._v(" "),t.isEditingDcw?n("el-button",{attrs:{type:"text"},on:{click:t.cancelEditDcw}},[t._v("取消编辑")]):n("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:t.toEditDcw}},[t._v("编辑")])],1),t._v(" "),n("div",{staticClass:"operations-container",class:{show:t.showOpLogs}},[t.showOpLogs?n("oplog",{attrs:{dataUrl:t.opLogDataUrl}}):t._e()],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"选择导出的字段",visible:t.exportStandDialog.show,width:"25%","show-close":!1,center:""},on:{"update:visible":function(e){return t.$set(t.exportStandDialog,"show",e)}}},[n("el-checkbox",{attrs:{indeterminate:t.exportStandDialog.selected.length&&t.exportStandDialog.selected.length<t.exportStandDialog.fields.length},on:{change:t.selectAllExportStandFields},model:{value:t.allExportStandFieldsSelected,callback:function(e){t.allExportStandFieldsSelected=e},expression:"allExportStandFieldsSelected"}},[t._v("\n        全选\n      ")]),t._v(" "),n("el-checkbox-group",{model:{value:t.exportStandDialog.selected,callback:function(e){t.$set(t.exportStandDialog,"selected",e)},expression:"exportStandDialog.selected"}},t._l(t.exportStandDialog.fields,function(e){return n("div",{key:e.value},[n("el-checkbox",{attrs:{label:e.value}},[t._v(t._s(e.text))])],1)}),0),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.exportStand}},[t._v("导 出")])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"排展管理",visible:t.arrangeStandDialog.show,width:"80%"},on:{"update:visible":function(e){return t.$set(t.arrangeStandDialog,"show",e)}}},[t.arrangeStandDialog.show?n("v-import",t._b({on:{backParentPage:function(e){t.arrangeStandDialog.show=!1}}},"v-import",t.arrangeStandDialog.importParams,!1)):t._e(),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.arrangeStandDialog.show=!1}}},[t._v("关闭")])],1)],1)],1):t._e(),t._v(" "),"STAND_UNIT"===t.page?n("div",[n("stand-unit",{attrs:{dcw:t.dcw,standUnitId:t.standUnitId,"is-manager":""},on:{"back-to-detail":t.backToDetail}})],1):t._e()])},staticRenderFns:[]};var k=n("C7Lr")(_,D,!1,function(t){n("7b3j")},"data-v-00a17bfa",null);e.default=k.exports}});