webpackJsonp([229],{bEwk:function(t,e){},jMn9:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("a3Yh"),s=a.n(i),n=a("kV13"),o=a("qqHy"),c=a.n(o),d=a("C331"),p=(s()({inject:{windowObj:{default:null}},props:{},created:function(){var t=localStorage.getItem("lang"),e=this;Object(d.g)(t)&&(this.lang=t),Object(d.e)({url:"/api/sc/activityContentType/selectOptions",dataType:"json",type:"get",success:function(t){t.state?t.data.length>0&&(e.typeData=t.data,e.typeId=t.data[0].id):e.$toast(t.message)}}),this._getContentTypeData()},data:function(){return{typeData:[],typeId:0,showAddModal:!1,errorMessage:{type:"",childType:""},contentTypeData:[],childTypeData:[],typeName:"",childTypeName:"",newChildTypeName:"",scrollHeight:null,lang:"zh-cn"}},computed:{translate:function(){return Object(d.g)(this.lang).activityContentTypeManage}},watch:{},mounted:function(){},methods:{_showAddModal:function(){this.showAddModal=!0,this.typeName="",this.childTypeName="",this.errorMessage={type:"",childType:""},this.childTypeData=[]},_getContentTypeData:function(){var t=this;Object(d.e)({url:"/api/sc/activityContentType/manage/getContentTypes",dataType:"json",type:"get",data:{typeId:this.typeId},success:function(e){if(e.state){t.contentTypeData=e.data,t.contentTypeData.forEach(function(t){n.default.set(t,"isEdit",!1),n.default.set(t,"creatChildTypeIsEdit",!1),n.default.set(t,"isVerticalLayout",!1),t.childType.forEach(function(t){n.default.set(t,"isEdit",!1)})});var a=c()("#activity-content-type-manage").height().toFixed(1);t.scrollHeight=a-c()(".content-type-header").height().toFixed(1)}else t.$toast(e.message)}})},_selectType:function(t){this.typeId=t.value,this._getContentTypeData()},_editName:function(t,e,a){"type"===e?this.contentTypeData.forEach(function(e){e.id===t&&(e.isEdit=!0)}):"childType"===e?this.contentTypeData.forEach(function(e){e.id===t&&e.childType.forEach(function(t){t.id===a&&(t.isEdit=!0)})}):this.contentTypeData.forEach(function(e){e.id===t&&(e.creatChildTypeIsEdit=!0)})},_inputBlur:function(t,e,a){var i=this;setTimeout(function(){"type"===e?i.contentTypeData.forEach(function(e){e.id===t&&(e.isEdit=!1)}):"childType"===e?i.contentTypeData.forEach(function(e){e.id===t&&e.childType.forEach(function(t){t.id===a&&(t.isEdit=!1)})}):i.contentTypeData.forEach(function(e){e.id===t&&(e.creatChildTypeIsEdit=!1)})},300)},_setCreatChildTypeName:function(t,e){var a=this;Object(d.e)({url:"/api/sc/activityContentType/addChildContentType",dataType:"json",type:"post",data:{typeName:t,parentId:e},success:function(t){t.state?(a.contentTypeData.forEach(function(t){t.id===e&&(t.creatChildTypeIsEdit=!1)}),a._getContentTypeData()):a.$toast(t.message)}})},_setTypeName:function(t,e){this._saveEditName(t,e),this.contentTypeData.forEach(function(t){t.id===e&&(t.isEdit=!1)})},_setChildTypeName:function(t,e){this._saveEditName(e.typeName,e.id),this.contentTypeData.forEach(function(a){a.id===t&&a.childType.forEach(function(t){t.id===e.id&&(t.isEdit=!1)})})},_saveEditName:function(t,e){var a=this;Object(d.e)({url:"/api/sc/activityContentType/editContentType/"+e,dataType:"json",type:"post",data:{typeName:t},success:function(t){t.state?a._getContentTypeData():a.$toast(t.message)}})},_changeStatus:function(t){var e=this,a=t.status?0:1;Object(d.e)({url:"/api/sc/activityContentType/forbiddenContentType/"+t.id+"/"+a,dataType:"json",type:"post",success:function(a){a.state?t.status=!t.status:e.$toast(a.message)}})},_addChildTypeName:function(){if(!this.childTypeName)return this.errorMessage.childType="子类别不能为空",!1;this.errorMessage.childType="",this.childTypeData.push(this.childTypeName),this.childTypeName=""},_removeChildTypeName:function(t){var e=this.childTypeData.indexOf(t);e>=0&&this.childTypeData.splice(e,1)},_changeTypeName:function(){this.errorMessage.type=""},_addType:function(){var t=this;this.typeName?0!==this.childTypeData.length?Object(d.e)({url:"/api/sc/activityContentType/addParentContentType",dataType:"json",type:"post",data:{typeName:this.typeName,childTypeNames:this.childTypeData},success:function(e){e.state?(t._getContentTypeData(),t.showAddModal=!1):t.$toast(e.message)}}):this.errorMessage.childType="请至少添加一个子类型":this.errorMessage.type="类别名称不能为空"},_switchView:function(t,e){this.contentTypeData.forEach(function(a){a.id===t&&(a.isVerticalLayout=!e)})}}},"watch",{windowObj:{deep:!0,handler:function(t){var e=c()("#activity-content-type-manage").height().toFixed(1);this.scrollHeight=e-c()(".content-type-header").height().toFixed(1)}}}),s()({inject:{windowObj:{default:null}},props:{},created:function(){var t=localStorage.getItem("lang"),e=this;Object(d.g)(t)&&(this.lang=t),Object(d.e)({url:"/api/sc/activityContentType/selectOptions",dataType:"json",type:"get",success:function(t){t.state?t.data.length>0&&(e.typeData=t.data,e.typeId=t.data[0].id):e.$toast(t.message)}}),this._getContentTypeData()},data:function(){return{typeData:[],typeId:0,showAddModal:!1,errorMessage:{type:"",childType:""},contentTypeData:[],childTypeData:[],typeName:"",childTypeName:"",newChildTypeName:"",scrollHeight:null,lang:"zh-cn"}},computed:{translate:function(){return Object(d.g)(this.lang).activityContentTypeManage}},watch:{},mounted:function(){},methods:{_showAddModal:function(){this.showAddModal=!0,this.typeName="",this.childTypeName="",this.errorMessage={type:"",childType:""},this.childTypeData=[]},_getContentTypeData:function(){var t=this;Object(d.e)({url:"/api/sc/activityContentType/manage/getContentTypes",dataType:"json",type:"get",data:{typeId:this.typeId},success:function(e){if(e.state){t.contentTypeData=e.data,t.contentTypeData.forEach(function(t){n.default.set(t,"isEdit",!1),n.default.set(t,"creatChildTypeIsEdit",!1),n.default.set(t,"isVerticalLayout",!1),t.childType.forEach(function(t){n.default.set(t,"isEdit",!1)})});var a=c()("#activity-content-type-manage").height().toFixed(1);t.scrollHeight=a-c()(".content-type-header").height().toFixed(1)}else t.$toast(e.message)}})},_selectType:function(t){this.typeId=t.value,this._getContentTypeData()},_editName:function(t,e,a){"type"===e?this.contentTypeData.forEach(function(e){e.id===t&&(e.isEdit=!0)}):"childType"===e?this.contentTypeData.forEach(function(e){e.id===t&&e.childType.forEach(function(t){t.id===a&&(t.isEdit=!0)})}):this.contentTypeData.forEach(function(e){e.id===t&&(e.creatChildTypeIsEdit=!0)})},_inputBlur:function(t,e,a){var i=this;setTimeout(function(){"type"===e?i.contentTypeData.forEach(function(e){e.id===t&&(e.isEdit=!1)}):"childType"===e?i.contentTypeData.forEach(function(e){e.id===t&&e.childType.forEach(function(t){t.id===a&&(t.isEdit=!1)})}):i.contentTypeData.forEach(function(e){e.id===t&&(e.creatChildTypeIsEdit=!1)})},300)},_setCreatChildTypeName:function(t,e){var a=this;Object(d.e)({url:"/api/sc/activityContentType/addChildContentType",dataType:"json",type:"post",data:{typeName:t,parentId:e},success:function(t){t.state?(a.contentTypeData.forEach(function(t){t.id===e&&(t.creatChildTypeIsEdit=!1)}),a._getContentTypeData()):a.$toast(t.message)}})},_setTypeName:function(t,e){this._saveEditName(t,e),this.contentTypeData.forEach(function(t){t.id===e&&(t.isEdit=!1)})},_setChildTypeName:function(t,e){this._saveEditName(e.typeName,e.id),this.contentTypeData.forEach(function(a){a.id===t&&a.childType.forEach(function(t){t.id===e.id&&(t.isEdit=!1)})})},_saveEditName:function(t,e){var a=this;Object(d.e)({url:"/api/sc/activityContentType/editContentType/"+e,dataType:"json",type:"post",data:{typeName:t},success:function(t){t.state?a._getContentTypeData():a.$toast(t.message)}})},_changeStatus:function(t){var e=this,a=t.status?0:1;Object(d.e)({url:"/api/sc/activityContentType/forbiddenContentType/"+t.id+"/"+a,dataType:"json",type:"post",success:function(a){a.state?t.status=!t.status:e.$toast(a.message)}})},_addChildTypeName:function(){if(!this.childTypeName)return this.errorMessage.childType="子类别不能为空",!1;this.errorMessage.childType="",this.childTypeData.push(this.childTypeName),this.childTypeName=""},_removeChildTypeName:function(t){var e=this.childTypeData.indexOf(t);e>=0&&this.childTypeData.splice(e,1)},_changeTypeName:function(){this.errorMessage.type=""},_addType:function(){var t=this;this.typeName?0!==this.childTypeData.length?Object(d.e)({url:"/api/sc/activityContentType/addParentContentType",dataType:"json",type:"post",data:{typeName:this.typeName,childTypeNames:this.childTypeData},success:function(e){e.state?(t._getContentTypeData(),t.showAddModal=!1):t.$toast(e.message)}}):this.errorMessage.childType="请至少添加一个子类型":this.errorMessage.type="类别名称不能为空"},_switchView:function(t,e){this.contentTypeData.forEach(function(a){a.id===t&&(a.isVerticalLayout=!e)})}}},"watch",{windowObj:{deep:!0,handler:function(t){var e=c()("#activity-content-type-manage").height().toFixed(1);this.scrollHeight=e-c()(".content-type-header").height().toFixed(1)}}})),l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"activity-content-type-manage"}},[a("div",{},[a("div",{staticClass:"container-fluid activity-content-type-fluid"},[a("div",{staticClass:"row"},[a("div",{staticClass:"content-type-header"},[a("div",{staticClass:"col-md-4"},[a("div",{staticClass:"select-title"},[t._v(t._s(t.translate.type)+t._s(t.translate.select))]),t._v(" "),a("div",{staticClass:"content-type-select"},[a("v-select",{attrs:{value:t.typeId,options:t.typeData,optionsLabel:"typeName",optionsValue:"id",search:!1},on:{afterSelected:t._selectType}})],1)]),t._v(" "),a("div",{staticClass:"col-md-2 col-md-offset-6"},[a("button",{staticClass:"btn add-content-type btn-bgColor-style",attrs:{type:"button"},on:{click:t._showAddModal}},[a("i",{staticClass:"maticon pull-left",domProps:{innerHTML:t._s(t.icons("add"))}},[t._v("add")]),t._v(t._s(t.translate.add)+t._s(t.translate.type))])])])]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"content-type-content",style:"max-height:"+t.scrollHeight+"px"},t._l(t.contentTypeData,function(e,i){return a("div",{key:i,staticClass:"content-type-card"},[a("div",{staticClass:"col-md-3"},[a("div",{staticClass:"type-title"},[e.isEdit?a("div",{staticClass:"edit-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.typeName,expression:"item.typeName"},{name:"focus",rawName:"v-focus"}],staticClass:"form-control search-input edit-name-input",attrs:{maxlength:"15",type:"text"},domProps:{value:e.typeName},on:{blur:function(a){return t._inputBlur(e.id,"type")},input:function(a){a.target.composing||t.$set(e,"typeName",a.target.value)}}}),t._v(" "),a("i",{staticClass:"maticon project-confirm",domProps:{innerHTML:t._s(t.icons("done"))},on:{click:function(a){return t._setTypeName(e.typeName,e.id)}}},[t._v("done")])]):a("div",{staticClass:"info-container"},[a("span",[t._v(t._s(e.typeName))]),t._v(" "),0===e.status?a("span",{staticClass:"type-disable"},[t._v("不可用")]):t._e(),t._v(" "),a("span",{staticClass:"typeName-opt"},[a("i",{staticClass:"maticon type-opt-icon",attrs:{title:"编辑"},domProps:{innerHTML:t._s(t.icons("edit"))},on:{click:function(a){return t._editName(e.id,"type")}}},[t._v("edit")]),t._v(" "),!1===e.status?a("i",{staticClass:"maticon type-opt-icon",attrs:{title:"启用"},domProps:{innerHTML:t._s(t.icons("panorama_fish_eye"))},on:{click:function(a){return t._changeStatus(e)}}},[t._v("panorama_fish_eye")]):a("i",{staticClass:"maticon type-opt-icon",attrs:{title:"禁用"},domProps:{innerHTML:t._s(t.icons("not_interested"))},on:{click:function(a){return t._changeStatus(e)}}},[t._v("not_interested")])])])])]),t._v(" "),a("div",{staticClass:"col-md-7"},[t._l(e.childType,function(i,s){return a("div",{key:s,class:e.isVerticalLayout?"":"display-block"},[a("div",{staticClass:"type-badge"},[i.isEdit?a("div",{staticClass:"edit-container name-edit-container",attrs:{title:i.isEdit}},[a("input",{directives:[{name:"model",rawName:"v-model",value:i.typeName,expression:"col.typeName"},{name:"focus",rawName:"v-focus"}],staticClass:"form-control search-input edit-name-input",attrs:{maxlength:"15",type:"text"},domProps:{value:i.typeName},on:{blur:function(a){return t._inputBlur(e.id,"childType",i.id)},input:function(e){e.target.composing||t.$set(i,"typeName",e.target.value)}}}),t._v(" "),a("i",{staticClass:"maticon project-confirm",domProps:{innerHTML:t._s(t.icons("done"))},on:{click:function(a){return t._setChildTypeName(e.id,i)}}},[t._v("done")])]):a("div",{staticClass:"info-container",attrs:{title:i.isEdit}},[a("span",{staticClass:"project-title",class:0===i.status?"disable":""},[t._v(t._s(i.typeName))]),t._v(" "),a("span",{staticClass:"project-opt"},[a("i",{staticClass:"maticon project-opt-icon",attrs:{title:"编辑"},domProps:{innerHTML:t._s(t.icons("edit"))},on:{click:function(a){return t._editName(e.id,"childType",i.id)}}},[t._v("edit")]),t._v(" "),!1===i.status?a("i",{staticClass:"maticon project-opt-icon",attrs:{title:"启用"},domProps:{innerHTML:t._s(t.icons("panorama_fish_eye"))},on:{click:function(e){return t._changeStatus(i)}}},[t._v("panorama_fish_eye")]):a("i",{staticClass:"maticon project-opt-icon",attrs:{title:"禁用"},domProps:{innerHTML:t._s(t.icons("not_interested"))},on:{click:function(e){return t._changeStatus(i)}}},[t._v("not_interested")])])])])])}),t._v(" "),a("div",{class:e.isVerticalLayout?"":"display-block"},[a("div",{staticClass:"type-badge add-type-badge"},[e.creatChildTypeIsEdit?a("div",{staticClass:"edit-container"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newChildTypeName,expression:"newChildTypeName"},{name:"focus",rawName:"v-focus"}],staticClass:"form-control search-input edit-name-input",attrs:{maxlength:"15",type:"text"},domProps:{value:t.newChildTypeName},on:{blur:function(a){return t._inputBlur(e.id,"creat")},input:function(e){e.target.composing||(t.newChildTypeName=e.target.value)}}}),t._v(" "),a("i",{staticClass:"maticon project-confirm",domProps:{innerHTML:t._s(t.icons("done"))},on:{click:function(a){return a.stopPropagation(),t._setCreatChildTypeName(t.newChildTypeName,e.id)}}},[t._v("done")])]):a("i",{staticClass:"maticon add-child-type-icon",domProps:{innerHTML:t._s(t.icons("add"))},on:{click:function(a){return t._editName(e.id,"creat")}}},[t._v("add")])])])],2),t._v(" "),a("div",{staticClass:"col-md-2"},[a("i",{staticClass:"maticon pull-right",attrs:{title:"切换视图"},domProps:{innerHTML:t._s(t.icons("swap_horiz"))},on:{click:function(a){return t._switchView(e.id,e.isVerticalLayout)}}},[t._v("swap_horiz")])])])}),0)])])]),t._v(" "),a("v-modal",{staticClass:"content-type-modal",attrs:{show:t.showAddModal,effect:"fade",width:"560"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        "+t._s(t.translate.add)+t._s(t.translate.type)+"\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"input-label"},[t._v(t._s(t.translate.type)+t._s(t.translate.name))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.typeName,expression:"typeName"}],staticClass:"form-control search-input childType-name-input",attrs:{type:"text",placeholder:t.translate.typeNamePlaceholder,maxlength:"15"},domProps:{value:t.typeName},on:{change:t._changeTypeName,input:function(e){e.target.composing||(t.typeName=e.target.value)}}}),t._v(" "),a("p",{staticClass:"error-message"},[t._v(t._s(t.errorMessage.type))])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"input-label"},[t._v("    "+t._s(t.translate.child)+t._s(t.translate.type))]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.childTypeName,expression:"childTypeName"}],staticClass:"form-control search-input childType-name-input",attrs:{type:"text",placeholder:t.translate.childTypePlaceholder,maxlength:"15"},domProps:{value:t.childTypeName},on:{input:function(e){e.target.composing||(t.childTypeName=e.target.value)}}}),t._v(" "),a("button",{staticClass:"btn  check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t._addChildTypeName}},[t._v(t._s(t.translate.add))]),t._v(" "),a("p",{staticClass:"error-message"},[t._v(t._s(t.errorMessage.childType))])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.childTypeData.length>0,expression:"childTypeData.length > 0"}],staticClass:"child-Type-list"},t._l(t.childTypeData,function(e,i){return a("p",{key:i},[a("span",{staticClass:"child-type-name"},[t._v(t._s(e))]),t._v(" "),a("i",{staticClass:"maticon pull-right remove-icon",domProps:{innerHTML:t._s(t.icons("cancel"))},on:{click:function(a){return t._removeChildTypeName(e)}}},[t._v("cancel")])])}),0)]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddModal=!1}}},[t._v(t._s(t.translate.cancel))]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t._addType}},[t._v(t._s(t.translate.confirm))])])])],1)},staticRenderFns:[]};var r=a("C7Lr")(p,l,!1,function(t){a("bEwk")},null,null);e.default=r.exports}});