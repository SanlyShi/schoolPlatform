webpackJsonp([167],{"9Xgr":function(t,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=i("C331"),s={props:{data:{default:null}},data:function(){return{showPop:!1,showActivityCnt:!1,searchParam:{province:[],activityType:[],activityNature:[]},areaList:[],activityTypeList:[],activityNatureList:[],activityNatureIdx:-1,journeyList:[],loadingText:!1,isLoadMoreData:!1,isShowNoMoreDataTips:!1,pageIndex:0,pageSize:20,totla:0}},computed:{update:function(){return this.$attrs.update}},watch:{update:function(){this.pageIndex=0,this.journeyList=[],this._initJourneyList({page:this.pageIndex,size:this.pageSize})}},created:function(){this._initJourneyList({page:this.pageIndex,size:this.pageSize}),this.initArea(),this.initDict()},mounted:function(){var t=this;this.$pullUpToLoad({container:"#journeyList .enroll-route-list",down:{height:200,callback:function(){t.pageIndex=0,t.journeyList=[],t._initJourneyList({page:t.pageIndex,size:t.pageSize})}},up:{callback:function(){t.isLoadMoreData&&(t.pageIndex++,t._initJourneyList({page:t.pageIndex,size:t.pageSize}))}}})},methods:{initArea:function(){var t=this;Object(e.e)({url:"/api/archives/permissions/getProvinceList",dataType:"json",type:"GET",success:function(a){a.state?(a.data.forEach(function(t){t.name=t.label}),t.$set(t,"areaList",[a.data])):t.$toast(a.message)}})},initDict:function(){var t=this;Object(e.e)({url:"/api/archives/demo/getSysDict?name=活动类别",dataType:"json",type:"GET",async:!1,success:function(a){if(a.state){var i=[];a.data.length>0&&(i=a.data.map(function(t){return{name:t.name,value:t.value}})),t.activityTypeList[0]=i}else t._toast("活动类别获取失败")}}),Object(e.e)({url:"/api/archives/demo/getSysDict?name=活动性质",dataType:"json",type:"GET",async:!1,success:function(a){if(a.state){var i=[];a.data.length>0&&(i=a.data.map(function(t){return{name:t.name,value:t.value}})),t.activityNatureList=i}else t._toast("活动性质获取失败")}})},_initJourneyList:function(t){var a=this;this.loadingText=!0,this.isLoadMoreData=!1;var i=this.searchParam.province[0]||"",s=this.searchParam.activityType[0]||"",n=this.searchParam.activityNature||"";this.$waiting.show(),Object(e.e)({url:"/api/archives/trip/getOneArrange?province="+i+"&activityType="+s+"&activityNature="+n,type:"get",data:t,success:function(t){a.$waiting.close(),t.state?(a.loadingText=!1,t.data.content.length>0?a.noDataTips="":a.noDataTips="暂无相关数据",a.total=t.data.totalElements,t.data.content.forEach(function(t){a.journeyList.push(t)}),a.journeyList.length>=a.total?(a.isLoadMoreData=!1,a.isShowNoMoreDataTips=!0):(a.isLoadMoreData=!0,a.isShowNoMoreDataTips=!1)):a._toast(t.message)}})},_back:function(){this.data.isUpdateLastPage=!0,this.$emit("removeBread",this.data)},_logout:function(){this.$emit("logout")},_reset:function(){this.searchParam.province=[],this.searchParam.activityType=[],this.searchParam.activityNature="",this.activityNatureIdx=-1},_selectNature:function(t){this.activityNatureIdx=t,this.searchParam.activityNature=this.activityNatureList[t].value},_addRoute:function(){this.$emit("addBread",{route:"/journey/createJourney",title:"",type:"add"})},toDetail:function(t){this.$emit("addBread",{route:"/journey/journeyDetail",title:"",journeyObj:t})},search:function(){this.showPop=!1,this.journeyList=[],this._initJourneyList()},_toast:function(t){this.$vux.toast.show({text:t,position:"bottom",type:"text"})}}},n={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"journeyList",attrs:{id:"journeyList"}},[i("view-box",[i("x-header",{staticClass:"journey-header",attrs:{title:"行程安排"}},[i("i",{attrs:{slot:"overwrite-left"},slot:"overwrite-left"})]),t._v(" "),i("div",{staticClass:"enroll-route-list"},[t._l(t.journeyList,function(a,e){return i("flexbox",{key:e,staticClass:"enroll-route-item",attrs:{orient:"vertical"},nativeOn:{click:function(i){return t.toDetail(a)}}},[i("flexbox-item",[i("flexbox",[i("flexbox-item",{staticClass:"title",attrs:{span:9}},[t._v(t._s(a.activityNature))]),t._v(" "),i("flexbox-item",{staticClass:"date"},[t._v(t._s(a.updateTime))])],1)],1),t._v(" "),i("flexbox-item",{staticClass:"row"},[i("label",[t._v("省份：")]),i("span",[t._v(t._s(a.province))])]),t._v(" "),i("flexbox-item",{staticClass:"row"},[i("label",[t._v("活动类别：")]),i("span",[t._v(t._s(a.activityType))])]),t._v(" "),i("flexbox",{staticStyle:{"margin-top":"8px"}},[i("flexbox-item",{staticClass:"row",attrs:{span:9}},[i("label",[t._v("时间：")]),i("span",[t._v(t._s(a.submitTime))])]),t._v(" "),i("flexbox-item",{staticClass:"date"},["WAIT"==a.status?i("span",{staticClass:"going"},[t._v("审批中")]):"NO"==a.status?i("span",{staticClass:"fail"},[t._v("审批未通过")]):i("span",{staticClass:"success"},[t._v("审批通过")])])],1),t._v(" "),i("flexbox-item")],1)}),t._v(" "),t.loadingText?i("div",{staticClass:"no-more"},[i("span",{staticClass:"line"}),t._v(" "),i("span",[t._v("加载中")]),t._v(" "),i("span",{staticClass:"line"})]):t._e(),t._v(" "),!t.isLoadMoreData&&t.isShowNoMoreDataTips?i("div",{staticClass:"no-more"},[i("span",{staticClass:"line"}),t._v(" "),i("span",[t._v("暂无更多日程")]),t._v(" "),i("span",{staticClass:"line"})]):t._e()],2),t._v(" "),i("div",{staticClass:"footer"},[i("x-button",{staticClass:"btn btn-line",nativeOn:{click:function(a){return t._logout(a)}}},[t._v("退出登录")]),t._v(" "),i("x-button",{staticClass:"btn btn-line",nativeOn:{click:function(a){t.showPop=!0}}},[t._v("筛选")]),t._v(" "),i("x-button",{staticClass:"btn btn-bg",nativeOn:{click:function(a){return t._addRoute(a)}}},[t._v("新建行程")])],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.showPop,expression:"showPop"}],staticClass:"popup",on:{"on-hide":function(a){t.showPop=!1}}},[i("div",{staticClass:"pop-mask",on:{click:function(a){t.showPop=!1}}}),t._v(" "),i("div",{staticClass:"popup-filter-wrap"},[i("div",{staticClass:"popup-filter-header"},[i("span",[t._v("筛选条件")]),t._v(" "),i("button",{on:{click:t.search}},[t._v("完成")])]),t._v(" "),i("div",{staticClass:"popup-filter-body"},[i("group",{attrs:{gutter:"0"}},[i("popup-picker",{attrs:{title:"省份","show-name":"",data:t.areaList},model:{value:t.searchParam.province,callback:function(a){t.$set(t.searchParam,"province",a)},expression:"searchParam.province"}}),t._v(" "),i("popup-picker",{attrs:{title:"活动类别","show-name":"",data:t.activityTypeList},model:{value:t.searchParam.activityType,callback:function(a){t.$set(t.searchParam,"activityType",a)},expression:"searchParam.activityType"}}),t._v(" "),i("cell",{attrs:{title:"活动性质","is-link":"","border-intent":!1,"arrow-direction":t.showActivityCnt?"up":"down"},nativeOn:{click:function(a){t.showActivityCnt=!t.showActivityCnt}}}),t._v(" "),i("div",{staticClass:"slide activity-cnt",class:t.showActivityCnt?"animate":""},t._l(t.activityNatureList,function(a,e){return i("div",{key:e,staticClass:"activity-item",class:t.activityNatureIdx==e?"on":"",on:{click:function(a){return t._selectNature(e)}}},[t._v(t._s(a.name))])}),0),t._v(" "),i("div",{staticClass:"pop-ft-btn"},[i("x-button",{staticClass:"btn btn-bg",nativeOn:{click:function(a){return t._reset(a)}}},[t._v("重置")]),t._v(" "),i("x-button",{staticClass:"btn btn-line",nativeOn:{click:function(a){t.showPop=!1}}},[t._v("取消")])],1)],1)],1)])])],1)],1)},staticRenderFns:[]};var o=i("C7Lr")(s,n,!1,function(t){i("jGUN")},null,null);a.default=o.exports},jGUN:function(t,a){}});