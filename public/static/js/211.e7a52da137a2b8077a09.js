webpackJsonp([211],{OMlg:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("C331"),i={data:function(){var t=this;return{configList:[],checkModel:{title:"",total:10,details:""},rules:{title:[{required:!0,message:"请输入检查项",trigger:"blur"}],total:[{required:!0,message:"请输入或选择分数",trigger:"blur"}],details:[{required:!0,message:"请输入详情",trigger:"blur"}]},showAddModal:!1,rows:[],columns:[{id:"name",title:"项目",className:"text-left",hidden:!1},{id:"maxScore",title:"分数",className:"text-left",hidden:!1},{id:"remark",title:"详情",className:"text-left",hidden:!1},{id:"opt",title:"操作",className:"text-centet",hidden:!1,formatter:function(e){return[{tag:"a",text:"查看",callback:function(e,a){t.showAddModal=!0,t.checkModel={title:e.name,total:e.maxScore,details:e.remark,id:e.id}}},{tag:"a",text:"删除",callback:function(e,a){var i="/api/apartment/sanitaryInspectionConfigItem/"+e.id;Object(s.e)({url:i,type:"post",success:function(e){e.state?(t.$toast("删除成功"),t.getList()):t.$toast(e.message)},error:function(){t.$toast("操作失败,请重试")}})}}]}}]}},methods:{addNewCheck:function(){this.showAddModal=!0,this.checkModel={title:"",total:10,details:""}},cancleAdd:function(){this.showAddModal=!1,this.checkModel={title:"",total:10,details:""},this.$refs.form.clearValidate()},addModel:function(){var t=this;this.$refs.form.validate(function(e){if(e){var a={name:t.checkModel.title,maxScore:t.checkModel.total,isDelete:0,remark:t.checkModel.details,id:t.checkModel.id};Object(s.e)({url:"/api/apartment/sanitaryInspectionConfigItem/update",type:"post",data:a,success:function(e){if(e.state){var a=t.checkModel.id?"修改成功":"新增成功";t.$toast(a),t.getList(),t.cancleAdd()}else t.$toast(e.message),t.cancleAdd()},error:function(e){t.$toast("操作失败,请重试")}})}})},save:function(){var t=this;if(this.configList.length){for(var e=this.configList,a=0;a<e.length;a++)if(""==e[a].score||!e[a].score)return this.$toast("请填写"+e[a].name+"分数");var i=this.configList;Object(s.e)({url:"/api/apartment/sanitaryInspectionConfig/update",type:"post",data:{sanitaryInspectionConfigPOS:i},success:function(e){e.state?t.$toast("保存成功"):t.$toast(e.message)}})}},getList:function(){var t=this;Object(s.e)({url:"/api/apartment/sanitaryInspectionConfigItem/list",type:"get",success:function(e){e.state?t.rows=e.data:t.$toast("列表获取失败")}})},getConfig:function(){var t=this;Object(s.e)({url:"/api/apartment/sanitaryInspectionConfig/list",type:"get",success:function(e){e.state?t.configList=e.data:t.configList=[]}})}},created:function(){this.getList(),this.getConfig()}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"hygienismSetting"}},[t._m(0),t._v(" "),a("div",[a("v-table",{attrs:{title:"卫生检查项",idField:"id",columns:t.columns,rows:t.rows,order:!0,columnsControl:!1,paginationShow:!1}},[a("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("button",{staticClass:"btn clearBtnBorder add-btn",attrs:{type:"button"},on:{click:t.addNewCheck}},[t._v("新增")])])])],1),t._v(" "),t.configList.length?a("div",{staticClass:"appraising"},[a("div",{staticStyle:{"text-align":"center",margin:"20px 0"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.getConfig}},[t._v("取消")])],1)]):t._e(),t._v(" "),a("div",{staticClass:"addCheck"},[a("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"450"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("新增卫生检查项")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("el-form",{ref:"form",staticClass:"demo-ruleForm",attrs:{model:t.checkModel,rules:t.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"检查项：",prop:"title"}},[a("el-input",{model:{value:t.checkModel.title,callback:function(e){t.$set(t.checkModel,"title",e)},expression:"checkModel.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"分数：",prop:"total"}},[a("el-input-number",{attrs:{min:0,max:100,label:"描述文字"},model:{value:t.checkModel.total,callback:function(e){t.$set(t.checkModel,"total",e)},expression:"checkModel.total"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"详情：",prop:"details"}},[a("el-input",{attrs:{type:"textarea",rows:10,resize:"none"},model:{value:t.checkModel.details,callback:function(e){t.$set(t.checkModel,"details",e)},expression:"checkModel.details"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.cancleAdd}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",staticStyle:{"margin-right":"0"},attrs:{type:"button"},on:{click:t.addModel}},[t._v("确认")])])])],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"header"},[e("label",{staticClass:"header-title pull-left"},[this._v("卫生检查设置")])])}]};var o=a("C7Lr")(i,l,!1,function(t){a("sIyB")},null,null);e.default=o.exports},sIyB:function(t,e){}});