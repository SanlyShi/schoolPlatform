webpackJsonp([100],{"9Ko4":function(t,e,a){"use strict";(function(t){var s=a("aA9S"),o=a.n(s),n=a("kV13"),i=a("C331"),r=a("7CEZ"),l=a("JUJb");n.default.component("FormSetManage",r.default),e.a={mixins:[l.a],props:{data:{default:null},role:{default:""}},created:function(){var t=localStorage.getItem("lang");Object(i.g)(t)&&(this.lang=t),this._initColumns(),this.getInstructorTree()},data:function(){return{isMergeTable:!1,fieldsToExport:[],showExport:!1,studentBie:!0,columns:[],onGuardStatus:!0,url:"/table-data/instructors",tableName:"辅导员信息",method:"get",lang:"zh-cn",student:{name:""},layoutManageJson:{infoTypes:[],route:"main",layoutsJson:{},logJson:{},instanceJson:{},preview:!1,curInfoId:""},showAddModal:!1,instructor:{message:"",userId:"",userNo:"",userName:""},timeStamp:"",curRouter:"instructorInfoList",importParams:{parentPageTitle:"辅导员信息列表",downloadTemplateUrl:"/instructors/batch/template",checkTemplateUrl:"/instructors/excel",downloadErrorTemplateUrl:"/instructors/batch/error",templateName:"批量导入辅导员信息",importBtnType:null}}},computed:{translate:function(){return Object(i.g)(this.lang).infoManage},exportStatus:function(){return this.exporting?"导出中":this.translate.export}},methods:{_addInstructor:function(){this.showAddModal=!0,this.instructor={message:"",userId:"",userNo:"",userName:""}},_batchInstructor:function(){var t=this;this.curRouter="importPag",this.importParams.importBtnType=[{url:"/instructors/batch/create",method:"post",isShowBtn:!0,name:"增量导入",success:function(e){e.state&&(t.timeStamp=Object(i.a)())}}]},_showExportModal:function(){this.fieldsToExport.length>0?this.showExport=!0:this.$toast("没有可导出字段")},getInstructorTree:function(){var t=this;Object(i.e)({url:"/api/instructors/fields?timeStamp="+(new Date).getTime(),dataType:"json",type:"get",success:function(e){var a=e.data;if(e.state){var s=[];a.forEach(function(t){var e={id:t.id,title:t.name,edit:!1,children:[]};t.childrens.forEach(function(t){e.children.push({id:t.id,title:t.name,disabled:!1,meta:!0,data:{typeId:t.dataDefinitionType,fieldType:t.fieldType,fieldId:t.id}})}),s.push(e)}),t.fieldsToExport=s}}})},exportTable:function(){var t=this,e=this;if(!this.exporting){var a=[];if(this.$refs.tree.getChecked().forEach(function(t){t.meta&&t.checked&&a.push(t.data)}),!a.length)return e.$toast("请勾选至少一个字段");this.exporting=!0;var s={};s.userNo=this.$refs.instructorTable.tableSearchFields.userNo||"",s.name=this.$refs.instructorTable.tableSearchFields.name||"",s.postNature=this.$refs.instructorTable.tableSearchFields.postNature||"",s.unit=this.$refs.instructorTable.tableSearchFields.unit||"",s.phone=this.$refs.instructorTable.tableSearchFields.phone||"",s.onGuardStatus=this.onGuardStatus,s.mergeTables=this.isMergeTable;var n=o()({exportFieldVO:a},s);this.exportFile("/api/instructors/getExportFileName",n).then(function(a){if(a.state){var s=[];"CREATE_FILE_FINISH"===a.data.status&&(s.push("/downloads/instructors/downloadExportFile?fileName="+a.data.fileName),a.data.hadImage&&s.push("/downloads/instructors/downloadImageZipFile?key="+a.data.key),s.forEach(function(t,a){e._createIFrame(t,100*a,1e3)}),e.showExport=!1,t.getInstructorTree())}else e.$toast(a.message);e.exporting=!1}).always(function(){t.$waiting.close()})}},_createIFrame:function(e,a,s){setTimeout(function(){var a=t('<iframe style="display: none;" class="multi-download"></iframe>');a.attr("src",e),t(document.body).after(a)},a)},checkAddUser:function(){var t=this;Object(i.e)({url:"/api/users/"+this.instructor.userNo,type:"GET",success:function(e){e.state?(t.instructor.userId=e.data.userId,t.instructor.userName=e.data.name,t.instructor.errorMessage=""):(t.instructor.errorMessage="用户不存在",t.instructor.userId="",t.instructor.userName="")}})},sureAddInstructor:function(){var t=this;Object(i.e)({url:"/api/instructors",type:"post",data:{userId:this.instructor.userId},success:function(e){e.state?(t.showAddModal=!1,t.$toast("新增成功"),t.timeStamp=Object(i.a)()):"50003"===e.code?t.$toast("该辅导员已存在"):t.$toast(e.message)}})},_initColumns:function(){var t=this;this.columns=[{id:"userNo",title:this.translate.teacherFields.teacherId,className:"text-left",width:150,hidden:!1,search:{type:"input",data:{placeholder:this.translate.teacherFields.teacherId}}},{id:"name",title:this.translate.infoFields.name,className:"text-left",hidden:!1,search:{type:"input",data:{placeholder:this.translate.infoFields.name}}},{id:"postNature",title:"岗位性质",className:"text-left",hidden:!1},{id:"unit",title:"单位",className:"text-left",hidden:!1},{id:"phoneNumber",title:"电话/手机",className:"text-left",hidden:!1},{id:"idCardNo",title:"身份证号",className:"text-left",hidden:!0},{id:"sex",title:"性别",className:"text-left",hidden:!0},{id:"birthday",title:"出生日期",className:"text-left",hidden:!0},{id:"nation",title:"民族",className:"text-left",hidden:!0},{id:"politicalStatus",title:"政治面貌",className:"text-left",hidden:!0},{id:"unitType",title:"单位类型",className:"text-left",hidden:!0},{id:"administrativeFunction",title:"行政职能",className:"text-left",hidden:!0},{id:"professionalPosition",title:"职业职位",className:"text-left",hidden:!0},{id:"joinJobTime",title:"参加工作时间",className:"text-left",hidden:!0},{id:"joinJobTime",title:"参加工作时间",className:"text-left",hidden:!0},{id:"professionalType",title:"职业类型",className:"text-left",hidden:!0},{id:"instructorTime",title:"指导时间",className:"text-left",hidden:!0},{id:"manageStuCount",title:"管理层",className:"text-left",hidden:!0},{id:"formationType",title:"格式类型",className:"text-left",hidden:!0},{id:"highestEducation",title:"最高学历",className:"text-left",hidden:!0},{id:"graduteSchool",title:"毕业院校",className:"text-left",hidden:!0},{id:"major",title:"专业",className:"text-left",hidden:!0},{id:"jobLevel",title:"工作水平",className:"text-left",hidden:!0},{id:"finalDegree",title:"最高学位",className:"text-left",hidden:!0},{id:"degreeType",title:"学位类型",className:"text-left",hidden:!0},{id:"archivalRepository",title:"档案库",className:"text-left",hidden:!0},{id:"monthlyIncomeRange",title:"月收入范围",className:"text-left",hidden:!0},{id:"marriageStatus",title:"婚姻状态",className:"text-left",hidden:!0},{id:"officialPhone",title:"电话",className:"text-left",hidden:!0},{id:"mail",title:"邮箱",className:"text-left",hidden:!0},{id:"wechat",title:"微信号",className:"text-left",hidden:!0},{id:"qq",title:"QQ",className:"text-left",hidden:!0},{id:"postalCode",title:"邮政编码",className:"text-left",hidden:!0},{id:"address",title:"地址",className:"text-left",hidden:!0},{id:"majorType",title:"专业类型",className:"text-left",hidden:!0},{id:"opt",title:this.translate.opt,className:"text-center",width:120,hidden:!1,formatter:function(){return[{tag:"a",text:t.translate.show,className:"opt-btn",callback:function(e,a){t._resetLayoutManageJson(),t.student=e,t.layoutManageJson.infoTypes.length>0?t._initInfoType(t.layoutManageJson.infoTypes[0]):(t.$waiting.show(),t._getInfoTypes(function(){t.$waiting.close(),t._initInfoType(t.layoutManageJson.infoTypes[0])}))}},{tag:"a",text:"删除",className:"opt-btn",callback:function(e,a){window.confirm("确定删除吗？")&&Object(i.e)({url:"/api/instructors/"+e.userId,type:"post",success:function(e){e.state?(t.$toast("删除成功"),t.timeStamp=Object(i.a)()):"50003"===e.code?t.$toast("当前辅导员仍有带生关系，请到带生关系设置中解除"):t.$toast(e.message)}})}}]}}]},_resetLayoutManageJson:function(){this.layoutManageJson.layoutsJson={},this.layoutManageJson.logsJson={},this.layoutManageJson.instanceJson={},this.layoutManageJson.curInfoId=""},_setLayout:function(){var t=this;0===this.layoutManageJson.infoTypes.length?(this.$waiting.show(),this._getInfoTypes(function(){t.$waiting.close(),t.layoutManageJson.route="formSetManage",t.$emit("fullScreen",!0)})):(this.layoutManageJson.route="formSetManage",this.$emit("fullScreen",!0))},_getInfoTypes:function(t,e){var a=this;Object(i.e)({url:"/api/information/columnTypes/INSTRUCTOR",type:"get",data:{searchContent:e},success:function(e){e.state?e.data&&e.data.length>0?(a.layoutManageJson.infoTypes=e.data||[],a.layoutManageJson.infoTypes.forEach(function(t){a.$set(t,"title",t.text)}),t&&t()):a.$toast(a.translate.nullColumnTypesTip):a.$toast(e.message)}}).always(function(){})},_closeFormSetting:function(){this.layoutManageJson.route="main",this.$emit("fullScreen",!1)},_saveFormInfo:function(t){var e=this;t.length>0?(this.$waiting.show(),Object(i.e)({url:"/api/information/infoSettings/INSTRUCTOR",type:"post",data:{infoTypes:t},success:function(t){t.state?(e.layoutManageJson.route="main",e.$toast(e.translate.successTip)):e.$toast(t.message)}}).always(function(){e.$waiting.close()})):(this.layoutManageJson.route="main",this.$toast(this.translate.successTip))},_initInfoType:function(t){var e=this;this.layoutManageJson.layoutsJson[t.id]&&this.layoutManageJson.logsJson[t.id]?this.layoutManageJson.curInfoId=t.id:(this.$waiting.show({container:".preview-container"}),Object(i.e)({url:"/api/information/infoSetting/INSTRUCTOR/"+t.id,type:"get",data:{userId:this.student.userId,distributary:"bySchool"},success:function(a){a.state?(a.data||(a.data=[]),a.data.components.forEach(function(t){n.default.set(t,"x",t.location.left),n.default.set(t,"y",t.location.top),n.default.set(t,"w",t.size.width),n.default.set(t,"h",t.size.height)}),e.$set(e.layoutManageJson.layoutsJson,t.id,a.data),Object(i.e)({url:"/api/information/infoInstance/changeLogs/INSTRUCTOR/"+t.id,type:"get",data:{userId:e.student.userId},success:function(a){a.state?(e.$set(e.layoutManageJson.logsJson,t.id,a.data||[]),e.layoutManageJson.curInfoId=t.id,e.layoutManageJson.preview=!0):e.$toast(a.message)}})):e.$toast(a.message)}}).always(function(){e.$waiting.close()}))},_getInfoValue:function(t){this.$set(this.layoutManageJson.instanceJson,this.layoutManageJson.curInfoId,t)},_submitAll:function(){var t=this;setTimeout(function(){var e=[];for(var a in t.layoutManageJson.instanceJson)e.push({infoId:a,formData:t.layoutManageJson.instanceJson[a].formData});0!==e.length?(t.$waiting.show(),Object(i.e)({url:"/api/information/infoInstance/INSTRUCTOR/bySchool/"+t.student.userId,type:"post",data:{typesValue:e,source:"INSTRUCTOR"},success:function(e){e.state?(t.$toast(t.translate.successTip),t.layoutManageJson.instanceJson={},t.layoutManageJson.preview=!1,t.timeStamp=new Date):t.$toast(e.message)}}).always(function(){t.$waiting.close()})):t.$toast("暂无需保存记录")},100)},_saveRoles:function(t){var e=this;Object(i.e)({url:"/api/information/player/"+t.type,type:"post",data:{players:t.players,educationLevel:t.educationLevel},success:function(t){t.state?(e.$toast(e.translate.successTip),e.layoutManageJson.route="formSetManage"):e.$toast(t.message)}})}}}}).call(e,a("qqHy"))},k4om:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("wBnr");var s=a("9Ko4"),o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return"instructorInfoList"===t.curRouter?a("div",{staticClass:"info-set-container"},[a("div",{staticClass:"text-center"},[a("ul",{staticClass:"nav nav-tabs relationClassManage-tab"},[a("li",{class:{active:t.onGuardStatus},on:{click:function(e){t.onGuardStatus=!0}}},[a("a",[t._v("在岗")])]),t._v(" "),a("li",{class:{active:!t.onGuardStatus},on:{click:function(e){t.onGuardStatus=!1}}},[a("a",[t._v("非在岗")])])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"main"===t.layoutManageJson.route,expression:"layoutManageJson.route === 'main'"}],staticClass:"instructor-info-page"},[a("div",{staticClass:"content text-center"},[a("v-table",{ref:"instructorTable",attrs:{title:t.tableName,url:t.url+"?timeStamp="+t.timeStamp+"&onGuardStatus="+t.onGuardStatus,method:t.method,pagesize:"10",idField:"id",columns:t.columns,search:!1,order:!0,multiple:!0,columnsControl:!0}},[a("div",{staticClass:"btn-group pull-right",attrs:{slot:"btn-group",role:"group"},slot:"btn-group"},[a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:t._showExportModal}},[t._v("导出")]),t._v(" "),a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:t._setLayout}},[t._v(t._s(t.translate.layoutManage))]),t._v(" "),a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:t._addInstructor}},[t._v("新增人员")]),t._v(" "),a("button",{staticClass:"btn btn-bgColor-style clearBtnBorder",on:{click:t._batchInstructor}},[t._v("批量新增人员")])])])],1)]),t._v(" "),a("v-modal",{attrs:{show:t.showExport,effect:"fade"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v(t._s(t.translate.export))])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("v-tree",{ref:"tree",attrs:{id:"resourceTree",cascade:"true",items:t.fieldsToExport,checkable:!0,search:!0}})],1),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("div",{staticClass:"input-group merge-table pull-left flex-align-center"},[a("span",{on:{click:function(e){t.isMergeTable=!t.isMergeTable}}},[t.isMergeTable?a("i",{staticClass:"maticon role-icon active",domProps:{innerHTML:t._s(t.icons("check_box"))}},[t._v("check_box")]):a("i",{staticClass:"maticon role-icon",domProps:{innerHTML:t._s(t.icons("check_box_outline_blank"))}},[t._v("check_box_outline_blank")])]),t._v(" "),a("span",{staticClass:"role-name"},[t._v("是否将勾选的字段合并在同个表格")])]),t._v(" "),a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showExport=!1}}},[t._v(t._s(t.translate.cancel))]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.exportTable}},[t._v(t._s(t.exportStatus))])])]),t._v(" "),"main"!==t.layoutManageJson.route?a("FormSetManage",{directives:[{name:"show",rawName:"v-show",value:"formSetManage"===t.layoutManageJson.route,expression:"layoutManageJson.route === 'formSetManage'"}],attrs:{infoSetting:{type:"INSTRUCTOR",tabs:t.layoutManageJson.infoTypes},student:t.studentBie},on:{back:t._closeFormSetting,submit:t._saveFormInfo,gotoRoleSet:function(e){t.layoutManageJson.route="joinRoleSet"}}}):t._e(),t._v(" "),"joinRoleSet"===t.layoutManageJson.route?a("JoinRoleSetManage",{attrs:{roleSetting:{type:"INSTRUCTOR",educationLevel:t.layoutManageJson.educationLevel}},on:{back:function(e){t.layoutManageJson.route="formSetManage"},submit:t._saveRoles}}):t._e(),t._v(" "),t.layoutManageJson.preview?a("div",{staticClass:"preview-container"},[a("preview",{attrs:{data:t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId]&&t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId].components,defaultData:t.layoutManageJson.instanceJson[t.layoutManageJson.curInfoId],log:t.layoutManageJson.logsJson[t.layoutManageJson.curInfoId],script:t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId]&&t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId].property&&t.layoutManageJson.layoutsJson[t.layoutManageJson.curInfoId].property.script,previewType:"form",infoSetting:{tabs:t.layoutManageJson.infoTypes,curInfoId:t.layoutManageJson.curInfoId}},on:{tabExchange:t._initInfoType,submit:t._getInfoValue,submitAll:t._submitAll,search:function(e){return t._getInfoTypes(null,e)},back:function(e){t.layoutManageJson.preview=!1}}})],1):t._e(),t._v(" "),a("v-modal",{attrs:{show:t.showAddModal,effect:"fade",width:"500"}},[a("div",{staticClass:"modal-header",attrs:{slot:"modal-header"},slot:"modal-header"},[a("h5",{staticClass:"modal-title"},[t._v("\n        新增人员\n      ")])]),t._v(" "),a("div",{staticClass:"modal-body",attrs:{slot:"modal-body"},slot:"modal-body"},[a("div",{staticClass:"form-group"},[a("label",{staticClass:"input-label"},[t._v("教工号")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.instructor.userNo,expression:"instructor.userNo"}],staticClass:"form-control search-input modal-form-style",attrs:{id:"user-no",type:"text"},domProps:{value:t.instructor.userNo},on:{change:t.checkAddUser,input:function(e){e.target.composing||t.$set(t.instructor,"userNo",e.target.value)}}}),t._v(" "),a("button",{staticClass:"btn check-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.checkAddUser}},[t._v("检测")]),t._v(" "),a("p",{staticClass:"error-message"},[t._v(t._s(t.instructor.errorMessage))])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"input-label",staticStyle:{"margin-left":"15px"}},[t._v("姓名")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.instructor.userName,expression:"instructor.userName"}],staticClass:"form-control search-input modal-form-style",attrs:{type:"text",disabled:"disabled"},domProps:{value:t.instructor.userName},on:{input:function(e){e.target.composing||t.$set(t.instructor,"userName",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"modal-footer",attrs:{slot:"modal-footer"},slot:"modal-footer"},[a("button",{staticClass:"btn cancel-btn clearBtnBorder",attrs:{type:"button"},on:{click:function(e){t.showAddModal=!1}}},[t._v("取消")]),t._v(" "),a("button",{staticClass:"btn submit-btn clearBtnBorder",attrs:{type:"button"},on:{click:t.sureAddInstructor}},[t._v("确定")])])])],1):a("v-import",t._b({on:{backParentPage:function(e){t.curRouter="instructorInfoList"}}},"v-import",t.importParams,!1))},staticRenderFns:[]};var n=function(t){a("r8Rc")},i=a("C7Lr")(s.a,o,!1,n,null,null);e.default=i.exports},r8Rc:function(t,e){},wBnr:function(t,e,a){"use strict";(function(t){var e=a("aA9S"),s=(a.n(e),a("kV13")),o=(a("C331"),a("7CEZ")),n=a("JUJb");s.default.component("FormSetManage",o.default);n.a}).call(e,a("qqHy"))}});